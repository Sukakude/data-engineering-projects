[0m07:54:48.474696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12ac2196a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12aac272c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12ac6ed970>]}


============================== 07:54:48.498366 | 8ca90332-924c-4d76-a359-9ebb5ad3d9e6 ==============================
[0m07:54:48.498366 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:54:48.499153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:54:48.504071 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m07:54:48.511957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.33196872, "process_in_blocks": "80344", "process_kernel_time": 1.143121, "process_mem_max_rss": "85444", "process_out_blocks": "1472", "process_user_time": 4.326088}
[0m07:54:48.514251 [debug] [MainThread]: Command `dbt run` failed at 07:54:48.513858 after 0.34 seconds
[0m07:54:48.515426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12ab3638f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12aaf72d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12aaf71f40>]}
[0m07:54:48.516926 [debug] [MainThread]: Flushing usage events
[0m07:54:53.584035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:58:46.677340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b52157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b518fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b565fec0>]}


============================== 07:58:46.689269 | 888cb44d-a210-49aa-b200-ed50f93feca3 ==============================
[0m07:58:46.689269 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:58:46.690576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:58:46.695485 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m07:58:46.698280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.090803795, "process_in_blocks": "0", "process_kernel_time": 0.289173, "process_mem_max_rss": "86844", "process_out_blocks": "1472", "process_user_time": 1.972}
[0m07:58:46.699838 [debug] [MainThread]: Command `dbt run` failed at 07:58:46.699568 after 0.09 seconds
[0m07:58:46.700654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b54bfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b4c7b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618b4cec1d0>]}
[0m07:58:46.701500 [debug] [MainThread]: Flushing usage events
[0m07:58:53.244916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:59:45.193886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3275bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3245ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde32758260>]}


============================== 07:59:45.202511 | b69c92bc-46d3-4fec-8280-6266189c2cb0 ==============================
[0m07:59:45.202511 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:59:45.203402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:59:45.206484 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m07:59:45.207906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11828188, "process_in_blocks": "0", "process_kernel_time": 0.336396, "process_mem_max_rss": "87024", "process_out_blocks": "1472", "process_user_time": 1.974325}
[0m07:59:45.208706 [debug] [MainThread]: Command `dbt run` failed at 07:59:45.208509 after 0.12 seconds
[0m07:59:45.209267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde32bbfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3278d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde322010a0>]}
[0m07:59:45.209742 [debug] [MainThread]: Flushing usage events
[0m07:59:51.716847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:04:06.549108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577e5249b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577fa8bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577fd328d0>]}


============================== 08:04:06.557578 | cc765a78-8b78-4ee9-a8f3-bb745048f689 ==============================
[0m08:04:06.557578 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:04:06.558459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:04:06.561600 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:04:06.563721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07548085, "process_in_blocks": "0", "process_kernel_time": 0.408448, "process_mem_max_rss": "86776", "process_out_blocks": "1480", "process_user_time": 2.162374}
[0m08:04:06.564928 [debug] [MainThread]: Command `dbt run` failed at 08:04:06.564786 after 0.08 seconds
[0m08:04:06.565329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577e267ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577fd328d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79577e0c0620>]}
[0m08:04:06.565994 [debug] [MainThread]: Flushing usage events
[0m08:04:09.116076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:08:39.994782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7e1faab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7f8baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7e1fa9f0>]}


============================== 08:08:40.003087 | 41bb6ca1-d7df-4f08-8334-e73c676b1a45 ==============================
[0m08:08:40.003087 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:08:40.003963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:08:40.007487 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:08:40.009130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07446283, "process_in_blocks": "0", "process_kernel_time": 0.435845, "process_mem_max_rss": "86708", "process_out_blocks": "1472", "process_user_time": 2.20059}
[0m08:08:40.010478 [debug] [MainThread]: Command `dbt run` failed at 08:08:40.010309 after 0.08 seconds
[0m08:08:40.010914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7e4ae390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7e394800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7f7e1faab0>]}
[0m08:08:40.011518 [debug] [MainThread]: Flushing usage events
[0m08:08:44.064760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:21.481623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7d8ed8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7ed45d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7ee88440>]}


============================== 08:16:21.491237 | 8860bfdd-780c-480f-88c5-436387c05758 ==============================
[0m08:16:21.491237 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:16:21.492918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:21.495846 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:16:21.497266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08142667, "process_in_blocks": "0", "process_kernel_time": 0.331696, "process_mem_max_rss": "87108", "process_out_blocks": "1480", "process_user_time": 1.978189}
[0m08:16:21.498087 [debug] [MainThread]: Command `dbt run` failed at 08:16:21.497880 after 0.08 seconds
[0m08:16:21.498761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7d1c0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7d7258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab7cee9640>]}
[0m08:16:21.499496 [debug] [MainThread]: Flushing usage events
[0m08:16:24.718361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:08.781876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0dba8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0f0697c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0d8f4500>]}


============================== 08:17:08.791385 | 27ffcbcc-08eb-4826-b6e9-33033598e1be ==============================
[0m08:17:08.791385 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:17:08.792299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:17:08.795256 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:17:08.796749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07826678, "process_in_blocks": "0", "process_kernel_time": 0.376215, "process_mem_max_rss": "86856", "process_out_blocks": "1472", "process_user_time": 2.081189}
[0m08:17:08.797481 [debug] [MainThread]: Command `dbt run` failed at 08:17:08.797338 after 0.08 seconds
[0m08:17:08.798006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0d8c0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0d6e7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0d52a360>]}
[0m08:17:08.798631 [debug] [MainThread]: Flushing usage events
[0m08:17:11.159889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:33.834678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da34353320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da32e238f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da328e99a0>]}


============================== 08:21:33.844544 | 0c98610b-f56f-4d49-9a20-146779d79a37 ==============================
[0m08:21:33.844544 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:21:33.845459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:21:33.848510 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:21:33.849972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09590116, "process_in_blocks": "0", "process_kernel_time": 0.511116, "process_mem_max_rss": "86620", "process_out_blocks": "1472", "process_user_time": 3.195481}
[0m08:21:33.850787 [debug] [MainThread]: Command `dbt run` failed at 08:21:33.850618 after 0.10 seconds
[0m08:21:33.851310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da32a7b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da3231bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da32651370>]}
[0m08:21:33.851867 [debug] [MainThread]: Flushing usage events
[0m08:21:37.907732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:25:04.497275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76981fa8b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769820266120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76982110dbb0>]}


============================== 08:25:04.510059 | c7f90d1d-183a-4505-a16a-b5b2dacf317e ==============================
[0m08:25:04.510059 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:25:04.511454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:25:04.516043 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:25:04.518964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0910456, "process_in_blocks": "0", "process_kernel_time": 0.414352, "process_mem_max_rss": "86664", "process_out_blocks": "1472", "process_user_time": 1.984112}
[0m08:25:04.520408 [debug] [MainThread]: Command `dbt run` failed at 08:25:04.520156 after 0.09 seconds
[0m08:25:04.521129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76981f7798e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76981f848cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76981fe69820>]}
[0m08:25:04.521767 [debug] [MainThread]: Flushing usage events
[0m08:25:09.838632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:44.988087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43d2bb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43e96bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43d9a4ef0>]}


============================== 08:28:44.996333 | 39d4b91e-841b-4a0c-96ef-a6b26beee258 ==============================
[0m08:28:44.996333 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:28:44.997249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:28:45.000497 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_pipeline'
[0m08:28:45.001895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07303666, "process_in_blocks": "0", "process_kernel_time": 0.357498, "process_mem_max_rss": "87080", "process_out_blocks": "1472", "process_user_time": 2.112855}
[0m08:28:45.002700 [debug] [MainThread]: Command `dbt run` failed at 08:28:45.002515 after 0.07 seconds
[0m08:28:45.003278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43edd8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43d01bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b43e96bfb0>]}
[0m08:28:45.003764 [debug] [MainThread]: Flushing usage events
[0m08:28:49.070445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:35.461395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5e04a5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5debae1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5debae150>]}


============================== 08:29:35.470181 | 7d632509-72b0-4149-ae48-dedbe86b693d ==============================
[0m08:29:35.470181 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:29:35.471067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:29:35.940504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dcd5f7d0>]}
[0m08:29:36.034152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5df16fce0>]}
[0m08:29:36.075753 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:29:36.219271 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:29:36.221596 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:29:36.222717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dcddffe0>]}
[0m08:29:37.981379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5deb77a40>]}
[0m08:29:38.076798 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:29:38.080380 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:29:38.141936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dc9cb290>]}
[0m08:29:38.142944 [info ] [MainThread]: Found 4 models, 4 sources, 429 macros
[0m08:29:38.144050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d632509-72b0-4149-ae48-dedbe86b693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dc955340>]}
[0m08:29:38.148654 [info ] [MainThread]: 
[0m08:29:38.149664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:38.150732 [info ] [MainThread]: 
[0m08:29:38.152388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:29:38.157440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m08:29:38.223639 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m08:29:38.224200 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m08:29:38.224579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:38.350028 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m08:29:38.453436 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m08:29:38.454653 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m08:29:38.455949 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m08:29:38.456914 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m08:29:38.458023 [debug] [ThreadPool]: On list_ecommerce_db: No close available on handle
[0m08:29:38.460737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:38.461680 [debug] [MainThread]: Connection 'list_ecommerce_db' was properly closed.
[0m08:29:38.462362 [info ] [MainThread]: 
[0m08:29:38.462908 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m08:29:38.463838 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  
[0m08:29:38.466675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1238208, "process_in_blocks": "18184", "process_kernel_time": 0.541961, "process_mem_max_rss": "109920", "process_out_blocks": "3336", "process_user_time": 4.740144}
[0m08:29:38.470172 [debug] [MainThread]: Command `dbt run` failed at 08:29:38.469542 after 3.13 seconds
[0m08:29:38.471688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dec86030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dcb79f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5dc0da480>]}
[0m08:29:38.472179 [debug] [MainThread]: Flushing usage events
[0m08:29:42.522911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:17.701812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b2f3e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b1336ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b2a431d0>]}


============================== 08:30:17.710070 | 49b0fecd-c98e-4f05-93b3-d3f668c6556b ==============================
[0m08:30:17.710070 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:30:17.711136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:30:17.995992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b1066720>]}
[0m08:30:18.077664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b10b0cb0>]}
[0m08:30:18.078649 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:30:18.176627 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:30:18.297085 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:30:18.297963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af661b50>]}
[0m08:30:19.745667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af41adb0>]}
[0m08:30:19.843506 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:30:19.847712 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:30:19.877092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af409400>]}
[0m08:30:19.877697 [info ] [MainThread]: Found 4 models, 4 sources, 429 macros
[0m08:30:19.878198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af5a5cd0>]}
[0m08:30:19.880525 [info ] [MainThread]: 
[0m08:30:19.881089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:19.881589 [info ] [MainThread]: 
[0m08:30:19.882505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:30:19.884773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m08:30:20.006107 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m08:30:20.007218 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m08:30:20.007964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:20.030846 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m08:30:20.033496 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m08:30:20.041216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m08:30:20.050490 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:30:20.051006 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m08:30:20.051487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:20.060902 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:30:20.061816 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:30:20.062586 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:30:20.068261 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:30:20.070176 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m08:30:20.071074 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m08:30:20.078427 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.078976 [debug] [MainThread]: On master: BEGIN
[0m08:30:20.079354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:20.089671 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:30:20.090261 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.091015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:30:20.095801 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m08:30:20.097838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07adbe1b20>]}
[0m08:30:20.098486 [debug] [MainThread]: On master: ROLLBACK
[0m08:30:20.099608 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.100229 [debug] [MainThread]: On master: BEGIN
[0m08:30:20.102075 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:30:20.103031 [debug] [MainThread]: On master: COMMIT
[0m08:30:20.103503 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.103888 [debug] [MainThread]: On master: COMMIT
[0m08:30:20.104551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:20.105130 [debug] [MainThread]: On master: Close
[0m08:30:20.113819 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_tables
[0m08:30:20.114949 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.stg_tables .................................... [RUN]
[0m08:30:20.115794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.stg_tables)
[0m08:30:20.116504 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_tables
[0m08:30:20.131321 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.133268 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_tables
[0m08:30:20.194461 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.196156 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.196661 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: BEGIN
[0m08:30:20.197173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:30:20.204939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:30:20.205344 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.205681 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_tables"} */

  
    

  create  table "ecommerce_db"."dev"."stg_tables__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "ecommerce_db"."dev"."raw_customers"
  );
  
[0m08:30:20.207970 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m08:30:20.213814 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.214314 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_tables"} */
alter table "ecommerce_db"."dev"."stg_tables__dbt_tmp" rename to "stg_tables"
[0m08:30:20.215492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:30:20.234230 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: COMMIT
[0m08:30:20.235359 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.236499 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: COMMIT
[0m08:30:20.241763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m08:30:20.247696 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."stg_tables__dbt_backup"
[0m08:30:20.253820 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.stg_tables"
[0m08:30:20.254271 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_tables"} */
drop table if exists "ecommerce_db"."dev"."stg_tables__dbt_backup" cascade
[0m08:30:20.255826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:30:20.257980 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_tables: Close
[0m08:30:20.262057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b0fecd-c98e-4f05-93b3-d3f668c6556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af57c320>]}
[0m08:30:20.263485 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.stg_tables ............................... [[32mSELECT 0[0m in 0.14s]
[0m08:30:20.264473 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_tables
[0m08:30:20.267267 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.267707 [debug] [MainThread]: On master: BEGIN
[0m08:30:20.268108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:30:20.275454 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:30:20.275881 [debug] [MainThread]: On master: COMMIT
[0m08:30:20.276135 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:20.276415 [debug] [MainThread]: On master: COMMIT
[0m08:30:20.277100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:20.277460 [debug] [MainThread]: On master: Close
[0m08:30:20.277977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:20.278274 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.stg_tables' was properly closed.
[0m08:30:20.278551 [info ] [MainThread]: 
[0m08:30:20.278872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:30:20.279790 [debug] [MainThread]: Command end result
[0m08:30:20.300683 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:30:20.302745 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:30:20.310297 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:30:20.310682 [info ] [MainThread]: 
[0m08:30:20.311230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:20.312533 [info ] [MainThread]: 
[0m08:30:20.313246 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:30:20.314786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6804624, "process_in_blocks": "8", "process_kernel_time": 0.444892, "process_mem_max_rss": "111720", "process_out_blocks": "4208", "process_user_time": 4.244515}
[0m08:30:20.315581 [debug] [MainThread]: Command `dbt run` succeeded at 08:30:20.315412 after 2.68 seconds
[0m08:30:20.316094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b1d30e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af5a5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07af5a7b60>]}
[0m08:30:20.316690 [debug] [MainThread]: Flushing usage events
[0m08:30:24.321654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:00.814855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e31b4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e53eb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e3788620>]}


============================== 10:49:00.818756 | 3faaaee7-d68f-49f7-9953-4371f86ce6ce ==============================
[0m10:49:00.818756 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:49:00.819665 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/home/tshep/.dbt', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m10:49:00.865072 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `ecommerce_pipeline` found at `ecommerce_pipeline` in file
`/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/dbt_proje
ct.yml`. Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m10:49:00.866027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3faaaee7-d68f-49f7-9953-4371f86ce6ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e2987a70>]}
[0m10:49:01.031877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3faaaee7-d68f-49f7-9953-4371f86ce6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e30737a0>]}
[0m10:49:01.080685 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:49:01.082052 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:49:01.082810 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:49:01.084079 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34090883, "process_in_blocks": "1096", "process_kernel_time": 0.192274, "process_mem_max_rss": "102192", "process_out_blocks": "16", "process_user_time": 1.82661}
[0m10:49:01.084691 [debug] [MainThread]: Command `dbt deps` succeeded at 10:49:01.084560 after 0.34 seconds
[0m10:49:01.085150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e38ffda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e2719310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7703e267dfd0>]}
[0m10:49:01.085668 [debug] [MainThread]: Flushing usage events
[0m10:49:05.853287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:30.393479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484727edf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748471f25940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748471e115b0>]}


============================== 10:49:30.397596 | cc9f1c8a-308e-47d9-995f-a5fde4063602 ==============================
[0m10:49:30.397596 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:49:30.398477 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select raw_customers', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'profiles_dir': '/home/tshep/.dbt', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default'}
[0m10:49:30.670897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748470f50a40>]}
[0m10:49:30.747533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748471903a40>]}
[0m10:49:30.790343 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:49:30.924138 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:49:31.022338 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:49:31.022963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484720c0c80>]}
[0m10:49:32.444804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484709e2060>]}
[0m10:49:32.522044 [debug] [MainThread]: Wrote artifact WritableManifest to /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/target/manifest.json
[0m10:49:32.524736 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/target/semantic_manifest.json
[0m10:49:32.549102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484700da930>]}
[0m10:49:32.549963 [info ] [MainThread]: Found 4 models, 4 sources, 464 macros
[0m10:49:32.550899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc9f1c8a-308e-47d9-995f-a5fde4063602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484700c0080>]}
[0m10:49:32.552527 [warn ] [MainThread]: The selection criterion 'raw_customers' does not match any enabled nodes
[0m10:49:32.554322 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:49:32.555073 [debug] [MainThread]: Command end result
[0m10:49:32.582969 [debug] [MainThread]: Wrote artifact WritableManifest to /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/target/manifest.json
[0m10:49:32.585032 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/target/semantic_manifest.json
[0m10:49:32.589639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/target/run_results.json
[0m10:49:32.590892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2726326, "process_in_blocks": "4232", "process_kernel_time": 0.273381, "process_mem_max_rss": "116724", "process_out_blocks": "2792", "process_user_time": 3.509738}
[0m10:49:32.591534 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:32.591386 after 2.27 seconds
[0m10:49:32.592062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748471903770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484727bf350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748470e118e0>]}
[0m10:49:32.592614 [debug] [MainThread]: Flushing usage events
[0m10:49:47.606470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:46.081881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074fd2625a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074fbfd83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074fbc08a40>]}


============================== 10:52:46.087004 | cb598468-41ba-4680-a3e0-35f9c0c7a0e4 ==============================
[0m10:52:46.087004 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:52:46.088052 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/tshep/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt debug', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs'}
[0m10:52:46.157119 [info ] [MainThread]: dbt version: 1.11.2
[0m10:52:46.158935 [info ] [MainThread]: python version: 3.12.3
[0m10:52:46.160027 [info ] [MainThread]: python path: /home/tshep/repos/ecommerce-analytics-pipeline/venv/bin/python
[0m10:52:46.160984 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m10:52:46.250186 [info ] [MainThread]: Using profiles dir at /home/tshep/.dbt
[0m10:52:46.251951 [info ] [MainThread]: Using profiles.yml file at /home/tshep/.dbt/profiles.yml
[0m10:52:46.253681 [info ] [MainThread]: Using dbt_project.yml file at /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/dbt_project.yml
[0m10:52:46.255901 [info ] [MainThread]: adapter type: postgres
[0m10:52:46.257638 [info ] [MainThread]: adapter version: 1.10.0
[0m10:52:46.475917 [info ] [MainThread]: Configuration:
[0m10:52:46.476508 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:52:46.476946 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:52:46.477327 [info ] [MainThread]: Required dependencies:
[0m10:52:46.477999 [debug] [MainThread]: Executing "git --help"
[0m10:52:46.484146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:52:46.484922 [debug] [MainThread]: STDERR: "b''"
[0m10:52:46.485438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:52:46.485913 [info ] [MainThread]: Connection:
[0m10:52:46.486339 [info ] [MainThread]:   host: host.docker.internal
[0m10:52:46.486801 [info ] [MainThread]:   port: 5432
[0m10:52:46.487252 [info ] [MainThread]:   user: postgres
[0m10:52:46.487747 [info ] [MainThread]:   database: ecommerce_db
[0m10:52:46.488259 [info ] [MainThread]:   schema: dev
[0m10:52:46.488914 [info ] [MainThread]:   connect_timeout: 10
[0m10:52:46.489474 [info ] [MainThread]:   role: None
[0m10:52:46.489890 [info ] [MainThread]:   search_path: None
[0m10:52:46.490245 [info ] [MainThread]:   keepalives_idle: 0
[0m10:52:46.490671 [info ] [MainThread]:   sslmode: None
[0m10:52:46.491116 [info ] [MainThread]:   sslcert: None
[0m10:52:46.491459 [info ] [MainThread]:   sslkey: None
[0m10:52:46.492010 [info ] [MainThread]:   sslrootcert: None
[0m10:52:46.492514 [info ] [MainThread]:   application_name: dbt
[0m10:52:46.493400 [info ] [MainThread]:   retries: 1
[0m10:52:46.494584 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:52:46.571363 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:52:46.616766 [debug] [MainThread]: Using postgres connection "debug"
[0m10:52:46.617320 [debug] [MainThread]: On debug: select 1 as id
[0m10:52:46.617700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:46.679234 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.0.4), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m10:52:46.692520 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:52:46.693383 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:52:46.694291 [debug] [MainThread]: On debug: No close available on handle
[0m10:52:46.694981 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:52:46.696118 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:52:46.696887 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "host.docker.internal" (192.168.0.4), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:52:46.698600 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6947026, "process_in_blocks": "1832", "process_kernel_time": 0.295624, "process_mem_max_rss": "111716", "process_out_blocks": "24", "process_user_time": 2.273109}
[0m10:52:46.699460 [debug] [MainThread]: Command `dbt debug` failed at 10:52:46.699275 after 0.70 seconds
[0m10:52:46.700261 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:52:46.700856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074fb597b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074faabbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7074fab7ef90>]}
[0m10:52:46.701708 [debug] [MainThread]: Flushing usage events
[0m10:52:55.317496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:49.078057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8fe8cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90705970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8fe8f410>]}


============================== 10:53:49.081866 | 83468970-49ae-491e-bfe1-4bf7fa7d052f ==============================
[0m10:53:49.081866 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:53:49.082803 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/home/tshep/.dbt', 'invocation_command': 'dbt debug', 'warn_error': 'None'}
[0m10:53:49.097729 [info ] [MainThread]: dbt version: 1.11.2
[0m10:53:49.098544 [info ] [MainThread]: python version: 3.12.3
[0m10:53:49.099275 [info ] [MainThread]: python path: /home/tshep/repos/ecommerce-analytics-pipeline/venv/bin/python
[0m10:53:49.099769 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m10:53:49.164666 [info ] [MainThread]: Using profiles dir at /home/tshep/.dbt
[0m10:53:49.165544 [info ] [MainThread]: Using profiles.yml file at /home/tshep/.dbt/profiles.yml
[0m10:53:49.166206 [info ] [MainThread]: Using dbt_project.yml file at /home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/dbt_project.yml
[0m10:53:49.166914 [info ] [MainThread]: adapter type: postgres
[0m10:53:49.167327 [info ] [MainThread]: adapter version: 1.10.0
[0m10:53:49.311363 [info ] [MainThread]: Configuration:
[0m10:53:49.311955 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:53:49.312430 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:53:49.312830 [info ] [MainThread]: Required dependencies:
[0m10:53:49.313236 [debug] [MainThread]: Executing "git --help"
[0m10:53:49.315677 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:53:49.316181 [debug] [MainThread]: STDERR: "b''"
[0m10:53:49.316681 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:53:49.317139 [info ] [MainThread]: Connection:
[0m10:53:49.317635 [info ] [MainThread]:   host: postgres
[0m10:53:49.318115 [info ] [MainThread]:   port: 5432
[0m10:53:49.318545 [info ] [MainThread]:   user: postgres
[0m10:53:49.318954 [info ] [MainThread]:   database: ecommerce_db
[0m10:53:49.319483 [info ] [MainThread]:   schema: dev
[0m10:53:49.320101 [info ] [MainThread]:   connect_timeout: 10
[0m10:53:49.320664 [info ] [MainThread]:   role: None
[0m10:53:49.321118 [info ] [MainThread]:   search_path: None
[0m10:53:49.321541 [info ] [MainThread]:   keepalives_idle: 0
[0m10:53:49.322093 [info ] [MainThread]:   sslmode: None
[0m10:53:49.322619 [info ] [MainThread]:   sslcert: None
[0m10:53:49.323050 [info ] [MainThread]:   sslkey: None
[0m10:53:49.323559 [info ] [MainThread]:   sslrootcert: None
[0m10:53:49.324024 [info ] [MainThread]:   application_name: dbt
[0m10:53:49.324523 [info ] [MainThread]:   retries: 1
[0m10:53:49.325386 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:53:49.397819 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:53:49.420795 [debug] [MainThread]: Using postgres connection "debug"
[0m10:53:49.421302 [debug] [MainThread]: On debug: select 1 as id
[0m10:53:49.421671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:59.433570 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: Temporary failure in name resolution

[0m10:54:09.444242 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:54:09.445121 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:54:09.445727 [debug] [MainThread]: On debug: No close available on handle
[0m10:54:09.446331 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:54:09.446901 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:54:09.447290 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: Temporary failure in name resolution
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:54:09.448560 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.441538, "process_in_blocks": "0", "process_kernel_time": 0.187863, "process_mem_max_rss": "111716", "process_out_blocks": "24", "process_user_time": 2.058508}
[0m10:54:09.449195 [debug] [MainThread]: Command `dbt debug` failed at 10:54:09.449049 after 20.44 seconds
[0m10:54:09.449774 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:54:09.450181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9031e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8fe243b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8fd7b320>]}
[0m10:54:09.450693 [debug] [MainThread]: Flushing usage events
[0m10:54:10.953149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:13.074923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49d7fa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49c92d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49c92cfb0>]}


============================== 09:37:13.084605 | 4b8be0ca-a006-49f0-a2b7-48ef3d3874e2 ==============================
[0m09:37:13.084605 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:37:13.086044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:13.384706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49e81f5c0>]}
[0m09:37:13.466606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49c7d7aa0>]}
[0m09:37:13.467768 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:13.660383 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:37:13.823856 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:37:13.825494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49ceb80b0>]}
[0m09:37:15.326767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49abefd40>]}
[0m09:37:15.437502 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:15.440508 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:15.472113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4991e70b0>]}
[0m09:37:15.472695 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:37:15.473185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4991d95b0>]}
[0m09:37:15.475503 [info ] [MainThread]: 
[0m09:37:15.476033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:15.476498 [info ] [MainThread]: 
[0m09:37:15.477690 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:15.484492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:37:15.604780 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:37:15.605727 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:37:15.606388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:15.628082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m09:37:15.631024 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:37:15.634745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:37:15.646121 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:37:15.646784 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:37:15.647327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:15.660192 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:37:15.661071 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:37:15.661849 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:37:15.669170 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:37:15.671684 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:37:15.672545 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:37:15.680601 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.681114 [debug] [MainThread]: On master: BEGIN
[0m09:37:15.681618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:15.690912 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:15.691978 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.692469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:15.699850 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:37:15.702244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4985abd40>]}
[0m09:37:15.703018 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:15.703890 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.704503 [debug] [MainThread]: On master: BEGIN
[0m09:37:15.705607 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:37:15.706281 [debug] [MainThread]: On master: COMMIT
[0m09:37:15.706897 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.707371 [debug] [MainThread]: On master: COMMIT
[0m09:37:15.708149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:15.708697 [debug] [MainThread]: On master: Close
[0m09:37:15.713845 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:37:15.714619 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:37:15.715499 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:37:15.716430 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:37:15.717560 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:37:15.718857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:37:15.719684 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:37:15.720646 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:37:15.721435 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:37:15.722263 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:37:15.723840 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:37:15.734297 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:15.737548 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:37:15.738809 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:37:15.739970 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:37:15.744399 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:37:15.765064 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:37:15.771415 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:37:15.810724 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:15.815126 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:37:15.818686 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:37:15.820471 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:15.821572 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:15.822291 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:37:15.822975 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:37:15.823776 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:15.824579 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:37:15.825267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:37:15.826087 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:37:15.827453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:15.835270 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m09:37:15.836152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m09:37:15.837008 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:15.838196 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:15.838952 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC;
  );
  
[0m09:37:15.839718 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    
  );
  
[0m09:37:15.840276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m09:37:15.841325 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:15.842189 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: ORDER BY total_revenue DESC;
                                    ^

[0m09:37:15.842809 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id;
  );
  
[0m09:37:15.843457 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 13:   );
           ^

[0m09:37:15.844127 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: ROLLBACK
[0m09:37:15.844947 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: ROLLBACK
[0m09:37:15.845845 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: GROUP BY c.id;
                      ^

[0m09:37:15.846940 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:37:15.847750 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:37:15.848680 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: ROLLBACK
[0m09:37:15.854055 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:37:15.927114 [debug] [Thread-1 (]: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:37:15.931991 [debug] [Thread-2 (]: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:37:15.934569 [debug] [Thread-3 (]: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:37:15.936386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49d3f21b0>]}
[0m09:37:15.937322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49abed970>]}
[0m09:37:15.939149 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8be0ca-a006-49f0-a2b7-48ef3d3874e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49cb5ec30>]}
[0m09:37:15.941294 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.customer_segmentation ................ [[31mERROR[0m in 0.21s]
[0m09:37:15.942711 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.daily_revenue ........................ [[31mERROR[0m in 0.22s]
[0m09:37:15.944277 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model dev.top_selling_products ................. [[31mERROR[0m in 0.22s]
[0m09:37:15.946075 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:37:15.947952 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:37:15.949668 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:37:15.951307 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.customer_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql.
[0m09:37:15.953823 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.daily_revenue' to be skipped because of status 'error'.  Reason: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql.
[0m09:37:15.956360 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.top_selling_products' to be skipped because of status 'error'.  Reason: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql.
[0m09:37:15.961366 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.962210 [debug] [MainThread]: On master: BEGIN
[0m09:37:15.962590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:15.971487 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:15.972060 [debug] [MainThread]: On master: COMMIT
[0m09:37:15.972513 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:15.973371 [debug] [MainThread]: On master: COMMIT
[0m09:37:15.975169 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:37:15.975582 [debug] [MainThread]: On master: Close
[0m09:37:15.976148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:15.976511 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:37:15.976838 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:37:15.977125 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:37:15.977545 [info ] [MainThread]: 
[0m09:37:15.977937 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m09:37:15.979087 [debug] [MainThread]: Command end result
[0m09:37:16.003841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:16.006979 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:16.014910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:37:16.015375 [info ] [MainThread]: 
[0m09:37:16.015819 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:37:16.016265 [info ] [MainThread]: 
[0m09:37:16.017468 [error] [MainThread]:   Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:37:16.018149 [info ] [MainThread]: 
[0m09:37:16.019316 [error] [MainThread]:   Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:37:16.020152 [info ] [MainThread]: 
[0m09:37:16.023776 [error] [MainThread]:   Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:37:16.025037 [info ] [MainThread]: 
[0m09:37:16.026832 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m09:37:16.029975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0248332, "process_in_blocks": "368", "process_kernel_time": 0.484491, "process_mem_max_rss": "112328", "process_out_blocks": "4248", "process_user_time": 4.416479}
[0m09:37:16.030893 [debug] [MainThread]: Command `dbt run` failed at 09:37:16.030712 after 3.03 seconds
[0m09:37:16.031687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49acb1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49acb1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da49acb18e0>]}
[0m09:37:16.032406 [debug] [MainThread]: Flushing usage events
[0m09:37:17.926044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:35.527982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032b7bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032110bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032a4cbc0>]}


============================== 09:42:35.536817 | 5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d ==============================
[0m09:42:35.536817 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:42:35.537672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:35.833816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7410325c23c0>]}
[0m09:42:35.924551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103318f5c0>]}
[0m09:42:35.925686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:42:36.045724 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:42:36.198367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:42:36.199213 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models/marts/daily_revenue.sql
[0m09:42:36.199771 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models/marts/top_selling_products.sql
[0m09:42:36.605157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103033a870>]}
[0m09:42:36.703400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:42:36.706347 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:42:36.737838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103052ef00>]}
[0m09:42:36.738924 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:42:36.739744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103022c800>]}
[0m09:42:36.742325 [info ] [MainThread]: 
[0m09:42:36.742845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:36.743420 [info ] [MainThread]: 
[0m09:42:36.744343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:36.750420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:42:36.794067 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:42:36.794640 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:42:36.795035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:36.810049 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m09:42:36.812170 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:42:36.814990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:42:36.823065 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:42:36.823675 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:42:36.824076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:36.834894 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:42:36.835671 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:42:36.836118 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:42:36.844150 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:42:36.846967 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:42:36.848465 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:42:36.856302 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:36.856892 [debug] [MainThread]: On master: BEGIN
[0m09:42:36.857260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:36.867316 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:42:36.867923 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:36.868509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:36.875782 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:42:36.877883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741031daf4a0>]}
[0m09:42:36.878513 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:36.879802 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:36.880283 [debug] [MainThread]: On master: BEGIN
[0m09:42:36.881692 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:42:36.882421 [debug] [MainThread]: On master: COMMIT
[0m09:42:36.882972 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:36.883534 [debug] [MainThread]: On master: COMMIT
[0m09:42:36.884385 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:42:36.884827 [debug] [MainThread]: On master: Close
[0m09:42:36.891877 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:42:36.892923 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:42:36.893698 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:42:36.894499 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:42:36.895282 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:42:36.896366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:42:36.897239 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:42:36.898161 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:42:36.899230 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:42:36.900312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:42:36.901153 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:42:36.919676 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:42:36.935500 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:42:36.941038 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:42:36.945161 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:42:36.947595 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:42:36.949424 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:42:36.950641 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:42:37.033893 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.043923 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.045650 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:42:37.047983 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.049288 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:42:37.050023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:42:37.051101 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:42:37.053132 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.053943 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:42:37.054985 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:42:37.055940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:37.056890 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:42:37.065134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:42:37.065943 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.066614 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:42:37.069746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m09:42:37.071403 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.072743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:42:37.074666 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:42:37.077020 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:42:37.078810 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m09:42:37.080000 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id;
  );
  
[0m09:42:37.087125 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m09:42:37.093945 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.099090 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.099844 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: GROUP BY c.id;
                      ^

[0m09:42:37.100999 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:42:37.101785 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:42:37.103087 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: ROLLBACK
[0m09:42:37.106450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:42:37.108736 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:42:37.111508 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:42:37.205367 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:42:37.206235 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:42:37.206904 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.208334 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.209710 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:42:37.211398 [debug] [Thread-1 (]: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:42:37.211886 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:42:37.215950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74102dc21d60>]}
[0m09:42:37.216807 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.customer_segmentation ................ [[31mERROR[0m in 0.32s]
[0m09:42:37.217700 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:42:37.218414 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.customer_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql.
[0m09:42:37.255777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m09:42:37.263269 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m09:42:37.287369 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:42:37.288585 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:42:37.310306 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:42:37.312505 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:42:37.313644 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:42:37.314701 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:42:37.316563 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:42:37.317712 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:42:37.322868 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:42:37.326053 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:42:37.327990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74102daf3e60>]}
[0m09:42:37.329661 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b71cf74-6bf6-4145-b4a9-94fbd1b6a40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74102daf17f0>]}
[0m09:42:37.331568 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.43s]
[0m09:42:37.333803 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.43s]
[0m09:42:37.336076 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:42:37.338244 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:42:37.346201 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:37.347586 [debug] [MainThread]: On master: BEGIN
[0m09:42:37.348566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:37.365371 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:42:37.367550 [debug] [MainThread]: On master: COMMIT
[0m09:42:37.369080 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:37.370258 [debug] [MainThread]: On master: COMMIT
[0m09:42:37.371369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:42:37.371910 [debug] [MainThread]: On master: Close
[0m09:42:37.372709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:37.373474 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:42:37.374020 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:42:37.374524 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:42:37.375191 [info ] [MainThread]: 
[0m09:42:37.376039 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m09:42:37.381741 [debug] [MainThread]: Command end result
[0m09:42:37.410673 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:42:37.412649 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:42:37.420459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:42:37.420955 [info ] [MainThread]: 
[0m09:42:37.421411 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:42:37.421784 [info ] [MainThread]: 
[0m09:42:37.423175 [error] [MainThread]:   Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  syntax error at or near ";"
  LINE 28: GROUP BY c.id;
                        ^
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:42:37.425210 [info ] [MainThread]: 
[0m09:42:37.426629 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:42:37.429307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9652002, "process_in_blocks": "0", "process_kernel_time": 0.3854, "process_mem_max_rss": "112708", "process_out_blocks": "4256", "process_user_time": 3.581013}
[0m09:42:37.430722 [debug] [MainThread]: Command `dbt run` failed at 09:42:37.430475 after 1.97 seconds
[0m09:42:37.431519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032536300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103037a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032090f20>]}
[0m09:42:37.432340 [debug] [MainThread]: Flushing usage events
[0m09:42:39.613696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:01.760347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3a3759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3bd6c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3a374440>]}


============================== 09:44:01.769125 | e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0 ==============================
[0m09:44:01.769125 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:44:01.770033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:02.078131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b39e4a6c0>]}
[0m09:44:02.210256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3a971340>]}
[0m09:44:02.212269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:44:02.317268 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:44:02.470213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:02.471712 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models/marts/customer_segmentation.sql
[0m09:44:02.933896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b38197200>]}
[0m09:44:03.053207 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:44:03.057663 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:44:03.105319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b38170d70>]}
[0m09:44:03.107371 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:44:03.109347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b38282660>]}
[0m09:44:03.117803 [info ] [MainThread]: 
[0m09:44:03.121040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:03.125212 [info ] [MainThread]: 
[0m09:44:03.128293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:03.143076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:44:03.207513 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:44:03.208082 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:44:03.208443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:03.218763 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:44:03.222289 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:44:03.228017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:44:03.235057 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:44:03.235564 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:44:03.235913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:03.244674 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:44:03.245181 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:44:03.245569 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:44:03.251539 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:44:03.254034 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:44:03.256913 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:44:03.277471 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.279556 [debug] [MainThread]: On master: BEGIN
[0m09:44:03.280688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:03.306094 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:44:03.307962 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.309527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:03.321655 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m09:44:03.326939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b38170e00>]}
[0m09:44:03.328223 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:03.329851 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.330679 [debug] [MainThread]: On master: BEGIN
[0m09:44:03.332274 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:44:03.333014 [debug] [MainThread]: On master: COMMIT
[0m09:44:03.334201 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.335348 [debug] [MainThread]: On master: COMMIT
[0m09:44:03.336499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:03.337299 [debug] [MainThread]: On master: Close
[0m09:44:03.349807 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:44:03.351517 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:44:03.353661 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:44:03.355775 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:44:03.358270 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:44:03.363427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:44:03.361107 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:44:03.366648 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:44:03.369054 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:44:03.371856 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:44:03.375316 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:44:03.395116 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.396469 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:44:03.409208 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.416056 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.417001 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:44:03.418360 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:44:03.424944 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:44:03.611791 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.616668 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.623842 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.628508 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.632244 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.634700 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:44:03.636752 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.638029 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:44:03.639848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:03.642115 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:44:03.644520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:03.647333 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:03.672302 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m09:44:03.674442 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.677747 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:44:03.681300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m09:44:03.684448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.037 seconds
[0m09:44:03.686594 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.691577 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.695481 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:44:03.698306 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:44:03.702101 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:44:03.720722 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m09:44:03.729842 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m09:44:03.736335 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.735619 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.741037 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.741737 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:44:03.742541 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:44:03.743364 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:44:03.747005 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:03.749192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:44:03.751193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:44:03.790203 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:44:03.789335 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:44:03.792377 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:44:03.793048 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.793565 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.794083 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.794695 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:44:03.795420 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:44:03.796055 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:44:03.845423 [debug] [Thread-3 (]: SQL status: COMMIT in 0.049 seconds
[0m09:44:03.853208 [debug] [Thread-2 (]: SQL status: COMMIT in 0.056 seconds
[0m09:44:03.854120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.057 seconds
[0m09:44:03.866154 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:44:03.870142 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:44:03.865249 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:44:03.883072 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:44:03.881993 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:44:03.884401 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:44:03.885186 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:44:03.886114 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:44:03.887182 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:44:03.889094 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:44:03.889990 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:44:03.891021 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:44:03.895176 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:44:03.897509 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:44:03.899963 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:44:03.903528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3bcee660>]}
[0m09:44:03.905135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b35c13fe0>]}
[0m09:44:03.906565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f6a3f1-9d58-4d70-be76-bcfb3c3959f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b35c23b90>]}
[0m09:44:03.907952 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.54s]
[0m09:44:03.909070 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.54s]
[0m09:44:03.911735 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:44:03.910315 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.54s]
[0m09:44:03.913397 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:44:03.914972 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:44:03.919324 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.919984 [debug] [MainThread]: On master: BEGIN
[0m09:44:03.920572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:03.929861 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:44:03.930926 [debug] [MainThread]: On master: COMMIT
[0m09:44:03.931513 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:03.931961 [debug] [MainThread]: On master: COMMIT
[0m09:44:03.932811 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:03.933407 [debug] [MainThread]: On master: Close
[0m09:44:03.934185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:03.934733 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:44:03.935314 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:44:03.935701 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:44:03.936311 [info ] [MainThread]: 
[0m09:44:03.936935 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m09:44:03.938591 [debug] [MainThread]: Command end result
[0m09:44:03.969306 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:44:03.971849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:44:03.979901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:44:03.980558 [info ] [MainThread]: 
[0m09:44:03.981084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:03.981518 [info ] [MainThread]: 
[0m09:44:03.982154 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:44:03.984673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2910485, "process_in_blocks": "0", "process_kernel_time": 0.569866, "process_mem_max_rss": "112608", "process_out_blocks": "4256", "process_user_time": 4.093405}
[0m09:44:03.985590 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:03.985429 after 2.29 seconds
[0m09:44:03.986034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b39f93f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b3bcee660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726b382bdf70>]}
[0m09:44:03.986635 [debug] [MainThread]: Flushing usage events
[0m09:44:05.487163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:47.133983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0fa26a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f8994500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f896a270>]}


============================== 10:30:47.142873 | efc8d7ff-1c80-44a3-9a2a-70fd24905ec6 ==============================
[0m10:30:47.142873 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:30:47.143442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:47.355931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f84a2900>]}
[0m10:30:47.420166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f8367920>]}
[0m10:30:47.421180 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:30:47.496211 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:30:47.604331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:47.604738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:47.640142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f683b920>]}
[0m10:30:47.719321 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:30:47.721920 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:30:47.750552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f6aa6840>]}
[0m10:30:47.751051 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m10:30:47.751421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f9773d40>]}
[0m10:30:47.753253 [info ] [MainThread]: 
[0m10:30:47.753667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:47.754084 [info ] [MainThread]: 
[0m10:30:47.754746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:47.759294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m10:30:47.809569 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m10:30:47.809979 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m10:30:47.810385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:47.826715 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m10:30:47.828190 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m10:30:47.830846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m10:30:47.837075 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:30:47.837848 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m10:30:47.838243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:47.847807 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:30:47.848240 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:30:47.848505 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:30:47.853918 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m10:30:47.855385 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m10:30:47.856153 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m10:30:47.862134 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:47.862590 [debug] [MainThread]: On master: BEGIN
[0m10:30:47.862872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:47.869838 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:30:47.870311 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:47.871346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:47.875729 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:30:47.877108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f6990a40>]}
[0m10:30:47.877606 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:47.878228 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:47.878560 [debug] [MainThread]: On master: BEGIN
[0m10:30:47.879353 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:30:47.879645 [debug] [MainThread]: On master: COMMIT
[0m10:30:47.879889 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:47.880172 [debug] [MainThread]: On master: COMMIT
[0m10:30:47.880667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:47.881081 [debug] [MainThread]: On master: Close
[0m10:30:47.885872 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m10:30:47.886848 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m10:30:47.887723 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m10:30:47.888722 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m10:30:47.889468 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m10:30:47.890766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m10:30:47.891401 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m10:30:47.892185 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m10:30:47.892897 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m10:30:47.893481 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m10:30:47.894108 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m10:30:47.901272 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:47.902075 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m10:30:47.904952 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m10:30:47.908531 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m10:30:47.910478 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m10:30:47.923048 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m10:30:47.934949 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m10:30:47.977864 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m10:30:47.979276 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:47.980645 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m10:30:47.981348 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:30:47.981712 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m10:30:47.982039 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:30:47.982816 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:47.983594 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m10:30:47.983985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:47.985232 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:30:47.985920 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m10:30:47.986237 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:30:47.991526 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m10:30:47.992599 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:30:47.993611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:30:47.994538 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m10:30:47.995203 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:47.995890 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m10:30:47.999805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m10:30:48.001029 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m10:30:48.001681 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:30:48.002328 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m10:30:48.008281 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:30:48.009234 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m10:30:48.012160 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:48.012873 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m10:30:48.013743 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m10:30:48.015171 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:30:48.016200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:30:48.016929 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m10:30:48.042863 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:30:48.043434 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:30:48.046264 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:30:48.046774 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:48.047188 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:30:48.047583 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m10:30:48.047979 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:30:48.048420 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:30:48.049410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:30:48.050684 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:30:48.051054 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:30:48.051350 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:30:48.059607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:30:48.065617 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m10:30:48.066146 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m10:30:48.072042 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m10:30:48.071661 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:30:48.074702 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m10:30:48.076955 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m10:30:48.077731 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m10:30:48.078690 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:30:48.079687 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:30:48.080602 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m10:30:48.081244 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m10:30:48.081748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:30:48.084791 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m10:30:48.085423 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:30:48.086703 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m10:30:48.087261 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:30:48.092555 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m10:30:48.093657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0fa326c30>]}
[0m10:30:48.094594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f413c3e0>]}
[0m10:30:48.095336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc8d7ff-1c80-44a3-9a2a-70fd24905ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f66e51f0>]}
[0m10:30:48.096498 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.20s]
[0m10:30:48.097400 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.20s]
[0m10:30:48.098239 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.20s]
[0m10:30:48.098855 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m10:30:48.099386 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m10:30:48.100178 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m10:30:48.103471 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:48.104262 [debug] [MainThread]: On master: BEGIN
[0m10:30:48.104608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:48.113095 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:30:48.113540 [debug] [MainThread]: On master: COMMIT
[0m10:30:48.113880 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:48.114156 [debug] [MainThread]: On master: COMMIT
[0m10:30:48.114837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:48.115517 [debug] [MainThread]: On master: Close
[0m10:30:48.115997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:48.116417 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m10:30:48.116660 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m10:30:48.116899 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m10:30:48.117382 [info ] [MainThread]: 
[0m10:30:48.117782 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m10:30:48.118877 [debug] [MainThread]: Command end result
[0m10:30:48.137803 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:30:48.139767 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:30:48.146632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:30:48.147018 [info ] [MainThread]: 
[0m10:30:48.147400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:48.148112 [info ] [MainThread]: 
[0m10:30:48.148596 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:30:48.149927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0669435, "process_in_blocks": "0", "process_kernel_time": 0.589479, "process_mem_max_rss": "108948", "process_out_blocks": "3424", "process_user_time": 2.322069}
[0m10:30:48.150491 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:48.150383 after 1.07 seconds
[0m10:30:48.150822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f8928cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f8703ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da0f86adb50>]}
[0m10:30:48.151176 [debug] [MainThread]: Flushing usage events
[0m10:30:49.387860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:13.771358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44fbd7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44fb483e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44f9a53a0>]}


============================== 10:34:13.778156 | 422bed1d-ff33-49cf-bd1a-b764c72d203d ==============================
[0m10:34:13.778156 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:34:13.779973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:13.992300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44dc3e5d0>]}
[0m10:34:14.058156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44f9a53a0>]}
[0m10:34:14.058994 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:14.135562 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:34:14.232316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:14.232750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:14.269111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44c324e60>]}
[0m10:34:14.345527 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:34:14.347906 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:34:14.374673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44c07ba10>]}
[0m10:34:14.375188 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m10:34:14.375559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44db42660>]}
[0m10:34:14.377525 [info ] [MainThread]: 
[0m10:34:14.378038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:34:14.378393 [info ] [MainThread]: 
[0m10:34:14.378889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:34:14.384070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m10:34:14.429244 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m10:34:14.429751 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m10:34:14.430007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:14.441694 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m10:34:14.443359 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m10:34:14.445975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m10:34:14.451643 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:34:14.452292 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m10:34:14.452665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:14.461584 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:34:14.462018 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:34:14.462305 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:34:14.467046 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m10:34:14.468913 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m10:34:14.469816 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m10:34:14.476119 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.476625 [debug] [MainThread]: On master: BEGIN
[0m10:34:14.476916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:14.486152 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:34:14.486812 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.487767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:34:14.493611 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:34:14.495018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44c286a80>]}
[0m10:34:14.495554 [debug] [MainThread]: On master: ROLLBACK
[0m10:34:14.496376 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.496772 [debug] [MainThread]: On master: BEGIN
[0m10:34:14.497703 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:34:14.498031 [debug] [MainThread]: On master: COMMIT
[0m10:34:14.498296 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.498536 [debug] [MainThread]: On master: COMMIT
[0m10:34:14.499140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:14.499502 [debug] [MainThread]: On master: Close
[0m10:34:14.504624 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m10:34:14.505828 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m10:34:14.507320 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m10:34:14.508613 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m10:34:14.511887 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m10:34:14.512899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m10:34:14.514074 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m10:34:14.514827 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m10:34:14.515409 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m10:34:14.516074 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m10:34:14.517042 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m10:34:14.527472 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.530638 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.531542 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m10:34:14.535818 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.537241 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m10:34:14.575083 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.575613 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m10:34:14.576228 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m10:34:14.579493 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.582995 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.584007 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.585633 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m10:34:14.586052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:14.587227 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.588121 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m10:34:14.588876 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.589555 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:34:14.590272 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m10:34:14.591441 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:34:14.594329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:34:14.594799 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.595156 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m10:34:14.598433 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m10:34:14.605763 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.606870 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m10:34:14.607852 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:34:14.608774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:34:14.609427 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m10:34:14.610270 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.627517 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.632383 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:34:14.633235 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m10:34:14.633896 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m10:34:14.634456 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.635673 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:34:14.638037 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m10:34:14.638854 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m10:34:14.642055 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.644813 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.645483 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m10:34:14.645849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:34:14.646503 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m10:34:14.652656 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m10:34:14.653369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:34:14.659351 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:34:14.660227 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:34:14.661864 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:34:14.662586 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m10:34:14.664091 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:34:14.664677 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.665645 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.666099 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:34:14.666693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:34:14.667357 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:34:14.670248 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m10:34:14.671141 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m10:34:14.673271 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m10:34:14.675321 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m10:34:14.675839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44fac2540>]}
[0m10:34:14.676864 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:34:14.679468 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m10:34:14.680516 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.16s]
[0m10:34:14.681010 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m10:34:14.681635 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:34:14.682458 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m10:34:14.683241 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m10:34:14.683583 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:34:14.686430 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m10:34:14.687144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44c179490>]}
[0m10:34:14.687825 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.17s]
[0m10:34:14.688448 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:34:14.690086 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m10:34:14.691811 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m10:34:14.693600 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '422bed1d-ff33-49cf-bd1a-b764c72d203d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44b2666c0>]}
[0m10:34:14.694287 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.18s]
[0m10:34:14.694992 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m10:34:14.699473 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.699927 [debug] [MainThread]: On master: BEGIN
[0m10:34:14.700233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:14.708956 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:34:14.709419 [debug] [MainThread]: On master: COMMIT
[0m10:34:14.709735 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:14.709969 [debug] [MainThread]: On master: COMMIT
[0m10:34:14.710599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:14.710932 [debug] [MainThread]: On master: Close
[0m10:34:14.711377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:14.711673 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m10:34:14.711912 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m10:34:14.712130 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m10:34:14.712538 [info ] [MainThread]: 
[0m10:34:14.712880 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:34:14.714679 [debug] [MainThread]: Command end result
[0m10:34:14.735320 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:34:14.736981 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:34:14.743087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:34:14.743481 [info ] [MainThread]: 
[0m10:34:14.743864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:14.744156 [info ] [MainThread]: 
[0m10:34:14.744764 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:34:14.746280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0299734, "process_in_blocks": "0", "process_kernel_time": 0.407225, "process_mem_max_rss": "107864", "process_out_blocks": "3424", "process_user_time": 2.371489}
[0m10:34:14.746805 [debug] [MainThread]: Command `dbt run` succeeded at 10:34:14.746692 after 1.03 seconds
[0m10:34:14.747158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44de030b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44b2c5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f44daf6750>]}
[0m10:34:14.747509 [debug] [MainThread]: Flushing usage events
[0m10:34:15.957800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:02.781071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1ffee090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1ffeefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1ffef1d0>]}


============================== 10:37:02.789058 | df38e8bb-d853-40b8-85ab-d35c6051a402 ==============================
[0m10:37:02.789058 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:37:02.789618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:37:03.030335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1e1956a0>]}
[0m10:37:03.096500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b21cb78c0>]}
[0m10:37:03.097343 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:37:03.181674 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:37:03.285181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:03.285656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:03.322947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1f9e4560>]}
[0m10:37:03.396591 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:37:03.399594 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:37:03.423840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1e14a8d0>]}
[0m10:37:03.424359 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m10:37:03.424728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b20ddbb60>]}
[0m10:37:03.426446 [info ] [MainThread]: 
[0m10:37:03.426856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:03.427157 [info ] [MainThread]: 
[0m10:37:03.427642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:37:03.433404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m10:37:03.477565 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m10:37:03.477999 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m10:37:03.478313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:03.490544 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m10:37:03.492297 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m10:37:03.494760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m10:37:03.500268 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:37:03.500996 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m10:37:03.501279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:03.509632 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:37:03.510063 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:37:03.510359 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:37:03.514720 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m10:37:03.516484 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m10:37:03.517255 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m10:37:03.523478 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.523891 [debug] [MainThread]: On master: BEGIN
[0m10:37:03.524147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:03.533534 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:37:03.534954 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.535836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:37:03.541850 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:37:03.543324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1e149e50>]}
[0m10:37:03.543854 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:03.544688 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.545415 [debug] [MainThread]: On master: BEGIN
[0m10:37:03.546297 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:37:03.546829 [debug] [MainThread]: On master: COMMIT
[0m10:37:03.547339 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.548082 [debug] [MainThread]: On master: COMMIT
[0m10:37:03.548690 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:03.549241 [debug] [MainThread]: On master: Close
[0m10:37:03.557275 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m10:37:03.558096 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m10:37:03.558935 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m10:37:03.559867 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m10:37:03.560925 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m10:37:03.561836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m10:37:03.562703 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m10:37:03.563475 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m10:37:03.564315 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m10:37:03.565149 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m10:37:03.565791 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m10:37:03.574360 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.575260 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m10:37:03.578469 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.582189 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.583991 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m10:37:03.585274 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m10:37:03.602478 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m10:37:03.657743 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.660896 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.656285 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.662409 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.664014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.664746 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.665407 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m10:37:03.666023 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m10:37:03.666421 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m10:37:03.666835 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:37:03.667383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:03.667728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:37:03.675844 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m10:37:03.676348 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.676671 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m10:37:03.678153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:37:03.679077 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.679488 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m10:37:03.680168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:37:03.681551 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.682324 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m10:37:03.685039 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m10:37:03.693395 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.016 seconds
[0m10:37:03.694627 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m10:37:03.695485 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.698381 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.701679 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.702525 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m10:37:03.703181 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m10:37:03.703682 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m10:37:03.705128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:37:03.705873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:37:03.711966 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:37:03.726261 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:37:03.728479 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:37:03.730301 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:37:03.730986 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.731558 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.732033 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.732721 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:37:03.733505 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:37:03.734635 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:37:03.745238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m10:37:03.751908 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m10:37:03.752675 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m10:37:03.753318 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m10:37:03.758923 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:37:03.761335 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m10:37:03.763460 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m10:37:03.764339 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m10:37:03.765233 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:37:03.766038 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:37:03.766931 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m10:37:03.767310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:37:03.767943 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m10:37:03.770714 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m10:37:03.771211 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:37:03.773896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0df0f980>]}
[0m10:37:03.774891 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:37:03.776530 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m10:37:03.777444 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.21s]
[0m10:37:03.780319 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m10:37:03.781079 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1d083980>]}
[0m10:37:03.781677 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m10:37:03.783051 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df38e8bb-d853-40b8-85ab-d35c6051a402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1d0837d0>]}
[0m10:37:03.784031 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.22s]
[0m10:37:03.785169 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.22s]
[0m10:37:03.786997 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m10:37:03.787724 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m10:37:03.792438 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.792968 [debug] [MainThread]: On master: BEGIN
[0m10:37:03.793333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:03.801804 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:37:03.802307 [debug] [MainThread]: On master: COMMIT
[0m10:37:03.802626 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:03.802885 [debug] [MainThread]: On master: COMMIT
[0m10:37:03.803822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:03.804452 [debug] [MainThread]: On master: Close
[0m10:37:03.805151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:03.805476 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m10:37:03.805722 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m10:37:03.805943 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m10:37:03.806273 [info ] [MainThread]: 
[0m10:37:03.806594 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:37:03.808713 [debug] [MainThread]: Command end result
[0m10:37:03.833423 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:37:03.835193 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:37:03.843295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:37:03.843734 [info ] [MainThread]: 
[0m10:37:03.844135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:03.844721 [info ] [MainThread]: 
[0m10:37:03.845120 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:37:03.846842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1177459, "process_in_blocks": "0", "process_kernel_time": 0.370933, "process_mem_max_rss": "108400", "process_out_blocks": "3416", "process_user_time": 2.301382}
[0m10:37:03.847369 [debug] [MainThread]: Command `dbt run` succeeded at 10:37:03.847256 after 1.12 seconds
[0m10:37:03.847711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1fac0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1def7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1fa7fad0>]}
[0m10:37:03.848061 [debug] [MainThread]: Flushing usage events
[0m10:37:08.315501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:28.906438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab453bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab4d526f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab453bd10>]}


============================== 10:41:28.913073 | 05ccf555-10f6-4d9c-9ed1-ab7791391c2d ==============================
[0m10:41:28.913073 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:41:28.913674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:29.124512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab45f6ed0>]}
[0m10:41:29.198901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab4ad7bc0>]}
[0m10:41:29.199864 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:41:29.288312 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:41:29.401047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:29.401682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:29.439703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab2d10ad0>]}
[0m10:41:29.514243 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:41:29.517122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:41:29.544064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab2a22ff0>]}
[0m10:41:29.544818 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m10:41:29.545430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab2ae6840>]}
[0m10:41:29.548572 [info ] [MainThread]: 
[0m10:41:29.549324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:29.549842 [info ] [MainThread]: 
[0m10:41:29.552201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:41:29.557655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m10:41:29.601948 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m10:41:29.602386 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m10:41:29.602639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:29.614166 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m10:41:29.615748 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m10:41:29.618178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m10:41:29.624036 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:41:29.624431 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m10:41:29.624687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:29.633063 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:41:29.633537 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m10:41:29.633901 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:41:29.638704 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m10:41:29.640445 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m10:41:29.641285 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m10:41:29.648337 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.649096 [debug] [MainThread]: On master: BEGIN
[0m10:41:29.649646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:29.658223 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:41:29.658662 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.659069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:41:29.665333 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m10:41:29.666751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab29bb710>]}
[0m10:41:29.667370 [debug] [MainThread]: On master: ROLLBACK
[0m10:41:29.668022 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.668357 [debug] [MainThread]: On master: BEGIN
[0m10:41:29.669592 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:41:29.669979 [debug] [MainThread]: On master: COMMIT
[0m10:41:29.670256 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.670498 [debug] [MainThread]: On master: COMMIT
[0m10:41:29.671463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:41:29.671862 [debug] [MainThread]: On master: Close
[0m10:41:29.677424 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m10:41:29.678468 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m10:41:29.679932 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m10:41:29.681300 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m10:41:29.683433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m10:41:29.682493 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m10:41:29.684723 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m10:41:29.685541 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m10:41:29.686781 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m10:41:29.687767 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m10:41:29.695753 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.697196 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m10:41:29.698141 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m10:41:29.701982 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.705485 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.706210 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m10:41:29.718642 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m10:41:29.725181 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m10:41:29.779797 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.781031 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.782160 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.782755 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.783618 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m10:41:29.784206 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.784873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:41:29.785342 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m10:41:29.786304 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.786788 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:41:29.787484 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m10:41:29.788562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:29.797723 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m10:41:29.798181 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.798512 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m10:41:29.802649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:41:29.803178 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.803549 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m10:41:29.808212 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m10:41:29.809314 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m10:41:29.810769 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m10:41:29.820655 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.821560 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.824554 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.825239 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m10:41:29.825918 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m10:41:29.826589 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m10:41:29.827915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:41:29.834140 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.007 seconds
[0m10:41:29.840705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:41:29.850000 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:41:29.853430 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.855403 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:41:29.856153 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.856937 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m10:41:29.857578 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.858368 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m10:41:29.859374 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m10:41:29.859961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:41:29.862174 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:41:29.863343 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.864196 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m10:41:29.866477 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m10:41:29.872538 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m10:41:29.877803 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m10:41:29.878251 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m10:41:29.878820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:41:29.879630 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:41:29.881784 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m10:41:29.882484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:41:29.885177 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m10:41:29.886405 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m10:41:29.888889 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m10:41:29.891381 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m10:41:29.892289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab02ac290>]}
[0m10:41:29.893539 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m10:41:29.894824 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.20s]
[0m10:41:29.895450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:41:29.896008 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m10:41:29.897466 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m10:41:29.899521 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m10:41:29.901305 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:41:29.902359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab1c3d8b0>]}
[0m10:41:29.904324 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m10:41:29.905511 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.22s]
[0m10:41:29.906294 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ccf555-10f6-4d9c-9ed1-ab7791391c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab026d670>]}
[0m10:41:29.907238 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m10:41:29.907988 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.22s]
[0m10:41:29.909921 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m10:41:29.914363 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.915403 [debug] [MainThread]: On master: BEGIN
[0m10:41:29.915974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:29.925423 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:41:29.926281 [debug] [MainThread]: On master: COMMIT
[0m10:41:29.926998 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:29.927678 [debug] [MainThread]: On master: COMMIT
[0m10:41:29.928753 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:41:29.929191 [debug] [MainThread]: On master: Close
[0m10:41:29.929730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:29.930032 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m10:41:29.930276 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m10:41:29.930533 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m10:41:29.930880 [info ] [MainThread]: 
[0m10:41:29.931272 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:41:29.932146 [debug] [MainThread]: Command end result
[0m10:41:29.954564 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:41:29.956375 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:41:29.962161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:41:29.962603 [info ] [MainThread]: 
[0m10:41:29.963061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:29.963386 [info ] [MainThread]: 
[0m10:41:29.964164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:41:29.965866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.109354, "process_in_blocks": "0", "process_kernel_time": 0.405521, "process_mem_max_rss": "108952", "process_out_blocks": "3424", "process_user_time": 2.28205}
[0m10:41:29.966455 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:29.966337 after 1.11 seconds
[0m10:41:29.966808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab2c6a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab2d100e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ab02c2f90>]}
[0m10:41:29.967235 [debug] [MainThread]: Flushing usage events
[0m10:41:31.058577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:55.955295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4ae67a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4b3d3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c497ce840>]}


============================== 11:56:55.962460 | e94a7d0a-0f44-4b26-ba22-5678c2c745b5 ==============================
[0m11:56:55.962460 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:56:55.963059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:56:56.165505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c49adc080>]}
[0m11:56:56.224217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4a068d70>]}
[0m11:56:56.225348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:56:56.299076 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:56:56.419613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:56.420014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:56.451424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c47c274a0>]}
[0m11:56:56.518593 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:56:56.520980 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:56:56.555211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c47a280b0>]}
[0m11:56:56.555616 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m11:56:56.555918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c47aa4290>]}
[0m11:56:56.557371 [info ] [MainThread]: 
[0m11:56:56.557689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:56.557928 [info ] [MainThread]: 
[0m11:56:56.558553 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:56.562332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m11:56:56.600400 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m11:56:56.600759 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m11:56:56.601187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:56.618472 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m11:56:56.619646 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m11:56:56.621366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m11:56:56.625819 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m11:56:56.626247 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m11:56:56.626497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:56.632651 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m11:56:56.633231 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m11:56:56.633481 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:56:56.637272 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m11:56:56.638428 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m11:56:56.638994 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m11:56:56.644597 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.645063 [debug] [MainThread]: On master: BEGIN
[0m11:56:56.645399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:56.650729 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:56:56.651165 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.651603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:56.655074 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:56:56.656323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c49493170>]}
[0m11:56:56.656746 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:56.657338 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.657642 [debug] [MainThread]: On master: BEGIN
[0m11:56:56.659456 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:56:56.660359 [debug] [MainThread]: On master: COMMIT
[0m11:56:56.660735 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.661023 [debug] [MainThread]: On master: COMMIT
[0m11:56:56.661611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:56.661860 [debug] [MainThread]: On master: Close
[0m11:56:56.665131 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m11:56:56.665594 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m11:56:56.666253 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m11:56:56.666666 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m11:56:56.667278 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m11:56:56.668080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m11:56:56.668689 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m11:56:56.669320 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m11:56:56.669800 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m11:56:56.670497 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m11:56:56.670980 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m11:56:56.677961 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.678650 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m11:56:56.681547 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.684447 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.685192 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m11:56:56.691296 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m11:56:56.723224 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.723809 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m11:56:56.726576 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.729926 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.730854 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.731349 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m11:56:56.731804 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:56:56.732177 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.732853 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.733353 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m11:56:56.733825 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m11:56:56.734250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:56.734605 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:56:56.738977 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m11:56:56.739512 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.739933 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m11:56:56.742412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:56:56.743164 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.743697 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m11:56:56.744171 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m11:56:56.744667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m11:56:56.752222 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.753021 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.753589 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m11:56:56.754229 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m11:56:56.755010 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m11:56:56.755475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:56:56.757814 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.758455 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m11:56:56.770792 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m11:56:56.775402 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m11:56:56.778451 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.779241 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.779695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:56:56.780424 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m11:56:56.780910 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m11:56:56.782278 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m11:56:56.783045 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.783432 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:56:56.783765 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m11:56:56.785059 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m11:56:56.785627 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.786009 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m11:56:56.789283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m11:56:56.794695 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m11:56:56.795178 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m11:56:56.799535 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m11:56:56.800083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m11:56:56.801947 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m11:56:56.802509 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m11:56:56.804042 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m11:56:56.804816 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m11:56:56.805629 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m11:56:56.806076 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m11:56:56.806406 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:56:56.806924 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m11:56:56.809631 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m11:56:56.810155 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:56:56.812397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:56:56.814644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4b416180>]}
[0m11:56:56.814095 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m11:56:56.815774 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m11:56:56.816531 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.14s]
[0m11:56:56.817416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4423bfe0>]}
[0m11:56:56.818000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94a7d0a-0f44-4b26-ba22-5678c2c745b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c46bd47a0>]}
[0m11:56:56.818605 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m11:56:56.819184 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.15s]
[0m11:56:56.819842 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.15s]
[0m11:56:56.820812 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m11:56:56.821344 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m11:56:56.823731 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.824083 [debug] [MainThread]: On master: BEGIN
[0m11:56:56.824318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:56.831274 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:56:56.831746 [debug] [MainThread]: On master: COMMIT
[0m11:56:56.832064 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:56.832371 [debug] [MainThread]: On master: COMMIT
[0m11:56:56.833046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:56.833337 [debug] [MainThread]: On master: Close
[0m11:56:56.833746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:56.833957 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m11:56:56.834243 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m11:56:56.834419 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m11:56:56.834690 [info ] [MainThread]: 
[0m11:56:56.834981 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:56:56.835945 [debug] [MainThread]: Command end result
[0m11:56:56.858534 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:56:56.860909 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:56:56.866703 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:56:56.867040 [info ] [MainThread]: 
[0m11:56:56.867369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:56.867729 [info ] [MainThread]: 
[0m11:56:56.868466 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:56:56.870184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9561775, "process_in_blocks": "101960", "process_kernel_time": 0.411176, "process_mem_max_rss": "107672", "process_out_blocks": "3424", "process_user_time": 2.011539}
[0m11:56:56.870691 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:56.870583 after 0.96 seconds
[0m11:56:56.871019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4ae67a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c4b2dc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778c49a7ec00>]}
[0m11:56:56.871293 [debug] [MainThread]: Flushing usage events
[0m11:57:00.875323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:32.845072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ac1b72720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abfcab200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abf6bc500>]}


============================== 13:14:32.853628 | ca9f3a97-d2d4-4087-a03d-cf68af8b9dde ==============================
[0m13:14:32.853628 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:14:32.854516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:14:33.180479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ac13cf5f0>]}
[0m13:14:33.267430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abf3d7c50>]}
[0m13:14:33.268887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:14:33.386744 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:14:33.516889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:33.517385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:33.559858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abf4b4d10>]}
[0m13:14:33.665868 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:14:33.670004 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:14:33.707732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abdb513d0>]}
[0m13:14:33.708384 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m13:14:33.708927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abd91dee0>]}
[0m13:14:33.712180 [info ] [MainThread]: 
[0m13:14:33.712738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:33.713345 [info ] [MainThread]: 
[0m13:14:33.714285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:33.723796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m13:14:33.788392 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m13:14:33.788962 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m13:14:33.789385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:33.802890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:14:33.805419 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m13:14:33.808218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m13:14:33.817590 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:14:33.818094 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m13:14:33.818421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:33.827368 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:14:33.827937 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:14:33.828441 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:14:33.834925 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m13:14:33.837656 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m13:14:33.838818 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m13:14:33.849859 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:33.851451 [debug] [MainThread]: On master: BEGIN
[0m13:14:33.852226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:33.862943 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:14:33.863685 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:33.864291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:33.872643 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m13:14:33.876275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ac1284620>]}
[0m13:14:33.877442 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:33.878584 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:33.879055 [debug] [MainThread]: On master: BEGIN
[0m13:14:33.880603 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:14:33.881781 [debug] [MainThread]: On master: COMMIT
[0m13:14:33.883213 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:33.884149 [debug] [MainThread]: On master: COMMIT
[0m13:14:33.885484 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:14:33.886007 [debug] [MainThread]: On master: Close
[0m13:14:33.893261 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m13:14:33.894787 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m13:14:33.897235 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m13:14:33.896317 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m13:14:33.901604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m13:14:33.898446 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m13:14:33.903536 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m13:14:33.899739 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m13:14:33.906867 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m13:14:33.920495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m13:14:33.922981 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:33.924075 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m13:14:33.924822 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m13:14:33.928970 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m13:14:33.936818 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m13:14:33.943514 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m13:14:33.966791 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m13:14:34.001137 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.004878 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.005723 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m13:14:34.011540 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.013302 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.013994 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m13:14:34.014387 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:34.015356 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.016341 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.017336 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m13:14:34.018127 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m13:14:34.018957 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:34.020157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:34.024629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:14:34.025880 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.026867 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m13:14:34.031788 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m13:14:34.038934 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m13:14:34.042973 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.044102 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.044996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:14:34.046393 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m13:14:34.047284 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m13:14:34.048255 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.050167 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m13:14:34.051268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:14:34.059961 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m13:14:34.069358 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.070158 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m13:14:34.080782 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m13:14:34.083389 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:14:34.086808 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.087919 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.088682 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:14:34.089503 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m13:14:34.090209 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:14:34.092397 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:14:34.093620 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.094073 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:14:34.094708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:14:34.097006 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:14:34.097504 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.097923 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:14:34.105269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m13:14:34.113257 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m13:14:34.113905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m13:14:34.118683 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m13:14:34.121513 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m13:14:34.122068 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m13:14:34.130102 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:14:34.131673 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:14:34.132913 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:14:34.133919 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m13:14:34.135040 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m13:14:34.136873 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m13:14:34.138981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:14:34.140390 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:14:34.144770 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m13:14:34.145615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m13:14:34.148897 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m13:14:34.151796 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m13:14:34.155484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ac13ce750>]}
[0m13:14:34.156551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abc1af920>]}
[0m13:14:34.157575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9f3a97-d2d4-4087-a03d-cf68af8b9dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abcaef6e0>]}
[0m13:14:34.159391 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.23s]
[0m13:14:34.161353 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.25s]
[0m13:14:34.162472 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.26s]
[0m13:14:34.163670 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m13:14:34.165084 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m13:14:34.166290 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m13:14:34.172078 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:34.172708 [debug] [MainThread]: On master: BEGIN
[0m13:14:34.173277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:34.188564 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:14:34.189627 [debug] [MainThread]: On master: COMMIT
[0m13:14:34.190157 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:34.190797 [debug] [MainThread]: On master: COMMIT
[0m13:14:34.191949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:14:34.192598 [debug] [MainThread]: On master: Close
[0m13:14:34.193315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:34.193708 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m13:14:34.194033 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m13:14:34.194398 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m13:14:34.194978 [info ] [MainThread]: 
[0m13:14:34.195802 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:14:34.200052 [debug] [MainThread]: Command end result
[0m13:14:34.232582 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:14:34.235447 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:14:34.244422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:14:34.244879 [info ] [MainThread]: 
[0m13:14:34.245362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:34.245780 [info ] [MainThread]: 
[0m13:14:34.246312 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:14:34.247795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4773033, "process_in_blocks": "0", "process_kernel_time": 0.556771, "process_mem_max_rss": "108492", "process_out_blocks": "3424", "process_user_time": 3.272535}
[0m13:14:34.249068 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:34.248879 after 1.48 seconds
[0m13:14:34.249580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abfb00320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abd91f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759abd91f4d0>]}
[0m13:14:34.250091 [debug] [MainThread]: Flushing usage events
[0m13:14:35.837556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:20.201020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a45453d8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544cdc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544e69ac0>]}


============================== 13:34:20.209319 | 9a274826-d112-4ff2-aac8-6446a638bc1d ==============================
[0m13:34:20.209319 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:34:20.210542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:20.493443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4546647650>]}
[0m13:34:20.583544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a454584dd30>]}
[0m13:34:20.584617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:20.675914 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:34:20.827916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:20.828405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:20.884695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4542eed940>]}
[0m13:34:20.995061 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:34:20.998538 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:34:21.028940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4542bc0ef0>]}
[0m13:34:21.030486 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m13:34:21.031318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4542e90320>]}
[0m13:34:21.035114 [info ] [MainThread]: 
[0m13:34:21.035950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:21.037171 [info ] [MainThread]: 
[0m13:34:21.039116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:21.047119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m13:34:21.108311 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m13:34:21.108882 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:21.109444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:21.123661 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m13:34:21.125312 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m13:34:21.128213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m13:34:21.135658 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:34:21.136134 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m13:34:21.136501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:21.146019 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:34:21.146668 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:34:21.147200 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:34:21.153251 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m13:34:21.155244 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m13:34:21.156258 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m13:34:21.165023 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.165713 [debug] [MainThread]: On master: BEGIN
[0m13:34:21.166215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:21.176998 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:34:21.177687 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.178372 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:21.185324 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:34:21.187256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4542b7f8c0>]}
[0m13:34:21.188021 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:21.189050 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.189833 [debug] [MainThread]: On master: BEGIN
[0m13:34:21.191720 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:21.192846 [debug] [MainThread]: On master: COMMIT
[0m13:34:21.193649 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.194150 [debug] [MainThread]: On master: COMMIT
[0m13:34:21.195044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:21.195550 [debug] [MainThread]: On master: Close
[0m13:34:21.201959 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m13:34:21.203103 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m13:34:21.204484 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m13:34:21.205647 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m13:34:21.206881 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m13:34:21.207935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m13:34:21.208953 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m13:34:21.210040 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m13:34:21.211067 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m13:34:21.212186 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m13:34:21.212938 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m13:34:21.225012 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m13:34:21.227230 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.232112 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.237552 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.239873 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m13:34:21.246593 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m13:34:21.248057 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m13:34:21.321409 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.324752 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.330560 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.333557 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.334824 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m13:34:21.335963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:21.337403 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.338041 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m13:34:21.338641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:21.339626 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.340293 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m13:34:21.340887 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:21.348563 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:34:21.350001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:34:21.350961 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.352264 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.353684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:34:21.354836 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m13:34:21.355922 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m13:34:21.356848 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.358284 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m13:34:21.365220 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m13:34:21.366491 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m13:34:21.372726 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m13:34:21.381261 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.388111 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.392138 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.393171 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m13:34:21.394507 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m13:34:21.395699 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m13:34:21.397428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:21.399832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:34:21.400704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:34:21.497741 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:34:21.500556 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:34:21.506145 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:34:21.507284 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.508687 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.509706 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.510849 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:34:21.512368 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:34:21.513786 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:34:21.580065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m13:34:21.589182 [debug] [Thread-2 (]: SQL status: COMMIT in 0.073 seconds
[0m13:34:21.609413 [debug] [Thread-3 (]: SQL status: COMMIT in 0.094 seconds
[0m13:34:21.612153 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m13:34:21.616520 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m13:34:21.618187 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m13:34:21.630671 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:34:21.634143 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m13:34:21.632980 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:34:21.629370 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:34:21.635476 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m13:34:21.636781 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:34:21.637813 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m13:34:21.642098 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m13:34:21.642899 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:34:21.647648 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m13:34:21.651692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:34:21.658448 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m13:34:21.654599 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4541e4e390>]}
[0m13:34:21.659174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544693c20>]}
[0m13:34:21.664180 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.44s]
[0m13:34:21.665464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a274826-d112-4ff2-aac8-6446a638bc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a454041df10>]}
[0m13:34:21.666802 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.44s]
[0m13:34:21.668934 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m13:34:21.670323 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.46s]
[0m13:34:21.671488 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m13:34:21.674564 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m13:34:21.680717 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.681804 [debug] [MainThread]: On master: BEGIN
[0m13:34:21.682706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:21.699471 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:34:21.700898 [debug] [MainThread]: On master: COMMIT
[0m13:34:21.701583 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:21.702349 [debug] [MainThread]: On master: COMMIT
[0m13:34:21.703772 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:34:21.705360 [debug] [MainThread]: On master: Close
[0m13:34:21.707139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:21.711400 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m13:34:21.712642 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m13:34:21.713604 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m13:34:21.714847 [info ] [MainThread]: 
[0m13:34:21.716360 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:34:21.720131 [debug] [MainThread]: Command end result
[0m13:34:21.777374 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:34:21.782266 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:34:21.794558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:34:21.795306 [info ] [MainThread]: 
[0m13:34:21.796844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:21.797647 [info ] [MainThread]: 
[0m13:34:21.798454 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:34:21.800434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6709887, "process_in_blocks": "0", "process_kernel_time": 0.447767, "process_mem_max_rss": "108832", "process_out_blocks": "3424", "process_user_time": 3.138407}
[0m13:34:21.801588 [debug] [MainThread]: Command `dbt run` succeeded at 13:34:21.801210 after 1.67 seconds
[0m13:34:21.802384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544981820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544693c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4544693a70>]}
[0m13:34:21.803205 [debug] [MainThread]: Flushing usage events
[0m13:34:23.354377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:05.702947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a2206360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a3b2f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a1e92a50>]}


============================== 13:44:05.711068 | c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14 ==============================
[0m13:44:05.711068 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:44:05.711848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:06.020784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a188d040>]}
[0m13:44:06.132820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a1863e00>]}
[0m13:44:06.134101 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:06.241396 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:44:06.377389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:06.377915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:06.439249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a005d010>]}
[0m13:44:06.554780 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:06.557752 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:06.601495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d99fd912e0>]}
[0m13:44:06.602358 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m13:44:06.603089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d99fe111c0>]}
[0m13:44:06.607316 [info ] [MainThread]: 
[0m13:44:06.608466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:06.610364 [info ] [MainThread]: 
[0m13:44:06.614863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:06.626052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m13:44:06.687104 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m13:44:06.688081 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m13:44:06.688735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:06.704319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m13:44:06.707438 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m13:44:06.710226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m13:44:06.718294 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:44:06.719471 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m13:44:06.719970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:06.731498 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:44:06.732396 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:44:06.733248 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:44:06.741621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m13:44:06.743370 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m13:44:06.744402 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m13:44:06.760157 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:06.760710 [debug] [MainThread]: On master: BEGIN
[0m13:44:06.761324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:06.775900 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:44:06.776646 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:06.777509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:06.785104 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:44:06.787811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d99fd8a090>]}
[0m13:44:06.788496 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:06.789487 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:06.790173 [debug] [MainThread]: On master: BEGIN
[0m13:44:06.791861 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:44:06.793214 [debug] [MainThread]: On master: COMMIT
[0m13:44:06.794922 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:06.795866 [debug] [MainThread]: On master: COMMIT
[0m13:44:06.797564 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:06.798051 [debug] [MainThread]: On master: Close
[0m13:44:06.805796 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m13:44:06.807133 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m13:44:06.808479 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m13:44:06.809962 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m13:44:06.811766 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m13:44:06.813967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m13:44:06.815708 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m13:44:06.816792 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m13:44:06.817833 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m13:44:06.819268 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m13:44:06.820058 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m13:44:06.829419 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:06.830258 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m13:44:06.836076 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m13:44:06.843973 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m13:44:06.845212 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m13:44:06.868944 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m13:44:06.899116 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m13:44:06.960294 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:06.964772 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m13:44:06.976650 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:06.978233 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m13:44:06.979919 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m13:44:06.981630 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:44:06.983685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:06.985492 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m13:44:06.986915 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:44:06.988370 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:06.989589 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m13:44:06.991508 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:07.003564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:44:07.006645 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:07.007754 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m13:44:07.009387 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:07.010143 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m13:44:07.011333 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:44:07.012380 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:44:07.014194 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m13:44:07.015827 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m13:44:07.025218 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m13:44:07.026250 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.008 seconds
[0m13:44:07.029484 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m13:44:07.062039 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:44:07.068593 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:07.070321 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:44:07.072065 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m13:44:07.074012 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m13:44:07.075593 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m13:44:07.078330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:07.079345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:07.080626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:07.160385 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:44:07.167173 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:07.166551 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:44:07.168529 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:44:07.157821 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:44:07.174067 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:44:07.175271 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:44:07.171419 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:44:07.176620 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:44:07.179047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:44:07.189729 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m13:44:07.202675 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m13:44:07.204083 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m13:44:07.209354 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m13:44:07.215026 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m13:44:07.224951 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:44:07.226517 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:44:07.227847 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:44:07.228762 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m13:44:07.229992 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m13:44:07.231086 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m13:44:07.232790 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:44:07.234230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:44:07.241415 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:44:07.240722 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m13:44:07.245481 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m13:44:07.247899 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m13:44:07.253971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a383e7b0>]}
[0m13:44:07.254979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d99fbf4b00>]}
[0m13:44:07.256458 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.43s]
[0m13:44:07.260165 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m13:44:07.258750 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.44s]
[0m13:44:07.257256 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b4cd6-3fa0-4c6e-bdf2-58ec1d05ec14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d99c611040>]}
[0m13:44:07.261843 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m13:44:07.263563 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.43s]
[0m13:44:07.265715 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m13:44:07.270614 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:07.271332 [debug] [MainThread]: On master: BEGIN
[0m13:44:07.271897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:07.287454 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:44:07.288601 [debug] [MainThread]: On master: COMMIT
[0m13:44:07.289933 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:07.290750 [debug] [MainThread]: On master: COMMIT
[0m13:44:07.291711 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:07.292152 [debug] [MainThread]: On master: Close
[0m13:44:07.292756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:07.293342 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m13:44:07.293711 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m13:44:07.294087 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m13:44:07.294554 [info ] [MainThread]: 
[0m13:44:07.295044 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:44:07.296455 [debug] [MainThread]: Command end result
[0m13:44:07.339514 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:07.343418 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:07.361970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:44:07.362716 [info ] [MainThread]: 
[0m13:44:07.363566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:07.364487 [info ] [MainThread]: 
[0m13:44:07.365371 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:44:07.368454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7428831, "process_in_blocks": "0", "process_kernel_time": 0.545956, "process_mem_max_rss": "108940", "process_out_blocks": "3424", "process_user_time": 3.592875}
[0m13:44:07.370050 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:07.369714 after 1.75 seconds
[0m13:44:07.371698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a1ae3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a1ae7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9a005faa0>]}
[0m13:44:07.374019 [debug] [MainThread]: Flushing usage events
[0m13:44:09.408076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:49.487422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab45570380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab4583e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab459043b0>]}


============================== 13:47:49.495704 | cf06a73d-79a3-4e9b-94d0-dd02562dd6c0 ==============================
[0m13:47:49.495704 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:49.496367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:49.822507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab46229520>]}
[0m13:47:49.964358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab43c283b0>]}
[0m13:47:49.965962 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:50.104528 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:50.300772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:50.301649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:50.364112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab43d096d0>]}
[0m13:47:50.453148 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:50.456059 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:50.485315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab43a1c290>]}
[0m13:47:50.485985 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m13:47:50.486736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab43ce6b70>]}
[0m13:47:50.489456 [info ] [MainThread]: 
[0m13:47:50.490040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:50.490621 [info ] [MainThread]: 
[0m13:47:50.492253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:50.500243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m13:47:50.562270 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m13:47:50.562798 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m13:47:50.563184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:50.576619 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:47:50.579485 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m13:47:50.582288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m13:47:50.591948 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:47:50.592557 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m13:47:50.592999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:50.603358 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:47:50.603929 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m13:47:50.604396 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:47:50.609901 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m13:47:50.611920 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m13:47:50.613007 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m13:47:50.623168 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.624002 [debug] [MainThread]: On master: BEGIN
[0m13:47:50.624440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:50.634765 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:47:50.635505 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.636393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:50.642332 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:50.644883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab439ab9b0>]}
[0m13:47:50.645795 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:50.646770 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.647800 [debug] [MainThread]: On master: BEGIN
[0m13:47:50.649200 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:47:50.649644 [debug] [MainThread]: On master: COMMIT
[0m13:47:50.650033 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.650441 [debug] [MainThread]: On master: COMMIT
[0m13:47:50.651282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:50.651704 [debug] [MainThread]: On master: Close
[0m13:47:50.658496 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m13:47:50.659484 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m13:47:50.660747 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m13:47:50.662210 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m13:47:50.663162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m13:47:50.663994 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m13:47:50.665067 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m13:47:50.665778 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m13:47:50.666719 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m13:47:50.667470 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m13:47:50.677837 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.679226 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m13:47:50.683045 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.684386 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m13:47:50.685895 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m13:47:50.691285 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.692247 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m13:47:50.718056 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m13:47:50.799945 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.800714 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.804961 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.806298 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.808031 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m13:47:50.809035 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:50.809990 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.810761 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.811797 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m13:47:50.812497 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m13:47:50.813546 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:47:50.814413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:50.822645 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:47:50.824224 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.825298 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m13:47:50.826369 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m13:47:50.827457 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.828569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:47:50.830499 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m13:47:50.831352 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.832752 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m13:47:50.837629 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:50.844093 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m13:47:50.848322 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.849385 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.019 seconds
[0m13:47:50.855146 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.856174 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m13:47:50.859922 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.860712 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m13:47:50.861859 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m13:47:50.862718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:50.863261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:50.869850 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:47:50.889117 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:47:50.889855 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:47:50.892013 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:47:50.892967 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.893755 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.894552 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.895403 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m13:47:50.895972 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m13:47:50.896529 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m13:47:50.903362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:47:50.911383 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m13:47:50.912230 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m13:47:50.916666 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m13:47:50.917496 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m13:47:50.920811 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m13:47:50.928268 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m13:47:50.929475 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m13:47:50.930533 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m13:47:50.931384 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m13:47:50.932156 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m13:47:50.932839 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m13:47:50.934145 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:47:50.934764 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:47:50.935462 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:47:50.938430 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m13:47:50.940472 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m13:47:50.942369 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m13:47:50.947215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab42c1f620>]}
[0m13:47:50.948168 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.28s]
[0m13:47:50.948883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab40267e90>]}
[0m13:47:50.950027 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m13:47:50.950587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf06a73d-79a3-4e9b-94d0-dd02562dd6c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab4025cd40>]}
[0m13:47:50.951814 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.27s]
[0m13:47:50.953490 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.28s]
[0m13:47:50.954692 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m13:47:50.955785 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m13:47:50.959711 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.960466 [debug] [MainThread]: On master: BEGIN
[0m13:47:50.961042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:50.974954 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:47:50.975639 [debug] [MainThread]: On master: COMMIT
[0m13:47:50.976275 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:50.976883 [debug] [MainThread]: On master: COMMIT
[0m13:47:50.977667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:50.978125 [debug] [MainThread]: On master: Close
[0m13:47:50.978735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:50.979083 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m13:47:50.979412 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m13:47:50.980037 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m13:47:50.980717 [info ] [MainThread]: 
[0m13:47:50.981448 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m13:47:50.984705 [debug] [MainThread]: Command end result
[0m13:47:51.025263 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:51.027523 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:51.038235 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:47:51.038757 [info ] [MainThread]: 
[0m13:47:51.039243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:51.039683 [info ] [MainThread]: 
[0m13:47:51.040552 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:47:51.041822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6507639, "process_in_blocks": "0", "process_kernel_time": 0.373454, "process_mem_max_rss": "108972", "process_out_blocks": "3424", "process_user_time": 3.164327}
[0m13:47:51.042488 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:51.042352 after 1.65 seconds
[0m13:47:51.042945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab46034590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab4576cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab4544e360>]}
[0m13:47:51.043369 [debug] [MainThread]: Flushing usage events
[0m13:47:55.063283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:48:12.544693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10600c7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10600c5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10600c6000>]}


============================== 06:48:12.548847 | 33531e8c-f91a-46b5-9ec9-229b40ee8e2f ==============================
[0m06:48:12.548847 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:48:12.549886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:48:12.751750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10618db350>]}
[0m06:48:12.821699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105e2e0c80>]}
[0m06:48:12.822868 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:48:12.917063 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:48:13.178170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:48:13.179621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:48:13.289477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105e2ec980>]}
[0m06:48:13.545176 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:48:13.552429 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:48:13.600865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105e004710>]}
[0m06:48:13.601774 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m06:48:13.602420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105e07b8c0>]}
[0m06:48:13.605592 [info ] [MainThread]: 
[0m06:48:13.606418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:48:13.607124 [info ] [MainThread]: 
[0m06:48:13.608403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:48:13.619537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m06:48:13.705643 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m06:48:13.706272 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m06:48:13.706764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:48:13.723293 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m06:48:13.725292 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m06:48:13.728619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m06:48:13.737410 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m06:48:13.738020 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m06:48:13.738531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:48:13.749766 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:48:13.750404 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m06:48:13.750912 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:48:13.759950 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m06:48:13.762147 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m06:48:13.763195 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m06:48:13.773346 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:13.773969 [debug] [MainThread]: On master: BEGIN
[0m06:48:13.774402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:48:13.786593 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:48:13.787220 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:13.787826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:48:13.794879 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:48:13.797180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105e309f70>]}
[0m06:48:13.797976 [debug] [MainThread]: On master: ROLLBACK
[0m06:48:13.799304 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:13.800213 [debug] [MainThread]: On master: BEGIN
[0m06:48:13.802021 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:48:13.803181 [debug] [MainThread]: On master: COMMIT
[0m06:48:13.804499 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:13.805290 [debug] [MainThread]: On master: COMMIT
[0m06:48:13.806847 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:48:13.807829 [debug] [MainThread]: On master: Close
[0m06:48:13.815213 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m06:48:13.816879 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m06:48:13.818057 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m06:48:13.819213 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m06:48:13.820787 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m06:48:13.821865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m06:48:13.822903 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m06:48:13.824388 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m06:48:13.825421 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m06:48:13.826405 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m06:48:13.827219 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m06:48:13.840375 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:13.841268 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m06:48:13.845508 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m06:48:13.850561 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m06:48:13.851452 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m06:48:13.859753 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m06:48:13.911992 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m06:48:13.936423 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:13.941493 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m06:48:13.945551 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m06:48:13.948093 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:13.948692 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m06:48:13.949126 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:48:13.949966 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:13.951036 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m06:48:13.950528 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:13.951556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:48:13.952391 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m06:48:13.953647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:48:13.962125 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m06:48:13.963618 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:13.964442 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m06:48:13.965538 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m06:48:13.966516 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:13.967949 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m06:48:13.969610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m06:48:13.970693 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:13.971850 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m06:48:13.976302 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.007 seconds
[0m06:48:13.977299 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.010 seconds
[0m06:48:13.978369 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.005 seconds
[0m06:48:13.987301 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:13.991618 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:13.997633 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:13.998842 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m06:48:14.000450 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m06:48:14.001188 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m06:48:14.002813 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:14.003778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:14.004383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:48:14.007923 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:14.011812 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:14.016441 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:14.017207 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m06:48:14.018103 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m06:48:14.018897 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m06:48:14.020570 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:14.027070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m06:48:14.027985 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m06:48:14.073383 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m06:48:14.078325 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m06:48:14.077097 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m06:48:14.079063 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:14.079834 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:14.080359 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:14.081218 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m06:48:14.081949 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m06:48:14.082635 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m06:48:14.101040 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m06:48:14.102085 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m06:48:14.103077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m06:48:14.110454 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m06:48:14.112851 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m06:48:14.115124 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m06:48:14.124080 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m06:48:14.125158 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m06:48:14.126225 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m06:48:14.127086 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m06:48:14.127779 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m06:48:14.128456 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m06:48:14.133936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:48:14.137661 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m06:48:14.138627 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:48:14.139387 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m06:48:14.144306 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m06:48:14.146376 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m06:48:14.147333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105d3178c0>]}
[0m06:48:14.148719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105d46ab40>]}
[0m06:48:14.149915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33531e8c-f91a-46b5-9ec9-229b40ee8e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105d317da0>]}
[0m06:48:14.150646 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.32s]
[0m06:48:14.152322 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.32s]
[0m06:48:14.154287 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.33s]
[0m06:48:14.155737 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m06:48:14.156862 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m06:48:14.158125 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m06:48:14.164893 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:14.166336 [debug] [MainThread]: On master: BEGIN
[0m06:48:14.167059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:48:14.179175 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:48:14.179748 [debug] [MainThread]: On master: COMMIT
[0m06:48:14.180098 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:14.180411 [debug] [MainThread]: On master: COMMIT
[0m06:48:14.181272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:48:14.181727 [debug] [MainThread]: On master: Close
[0m06:48:14.182348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:48:14.182677 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m06:48:14.182939 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m06:48:14.183195 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m06:48:14.183675 [info ] [MainThread]: 
[0m06:48:14.184041 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m06:48:14.186436 [debug] [MainThread]: Command end result
[0m06:48:14.219488 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:48:14.222175 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:48:14.232687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:48:14.233227 [info ] [MainThread]: 
[0m06:48:14.233699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:48:14.234046 [info ] [MainThread]: 
[0m06:48:14.234949 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:48:14.237078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8200909, "process_in_blocks": "0", "process_kernel_time": 0.415711, "process_mem_max_rss": "108292", "process_out_blocks": "1832", "process_user_time": 2.703999}
[0m06:48:14.237950 [debug] [MainThread]: Command `dbt run` succeeded at 06:48:14.237795 after 1.82 seconds
[0m06:48:14.238333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1060072a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10607bdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a105fd92e70>]}
[0m06:48:14.238734 [debug] [MainThread]: Flushing usage events
[0m06:48:24.189992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:00:56.081125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bc17ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bc7c3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bc0573b0>]}


============================== 07:00:56.089701 | 1bff5e72-819a-4cd1-99e6-9d6390a114b4 ==============================
[0m07:00:56.089701 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:00:56.090357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:00:56.358636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bbdfeb40>]}
[0m07:00:56.463895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bbdcb890>]}
[0m07:00:56.464969 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:00:56.559751 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:00:56.674805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:56.675335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:56.719369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306ba4a52e0>]}
[0m07:00:56.807510 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:00:56.812038 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:00:56.850123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306ba1b5250>]}
[0m07:00:56.851058 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m07:00:56.851562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bbd17b60>]}
[0m07:00:56.854209 [info ] [MainThread]: 
[0m07:00:56.854769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:00:56.856991 [info ] [MainThread]: 
[0m07:00:56.858812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:56.864749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m07:00:56.918122 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m07:00:56.918613 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:56.918909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:56.932759 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m07:00:56.934724 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m07:00:56.937623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m07:00:56.944625 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:00:56.945448 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m07:00:56.945880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:56.958308 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:00:56.958848 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:00:56.959212 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:00:56.967352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m07:00:56.969009 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m07:00:56.970149 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m07:00:56.977647 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:56.978163 [debug] [MainThread]: On master: BEGIN
[0m07:00:56.978639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:56.989886 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m07:00:56.990685 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:56.991252 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:56.999239 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:00:57.002339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bdaf02c0>]}
[0m07:00:57.003083 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:57.004269 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:57.004716 [debug] [MainThread]: On master: BEGIN
[0m07:00:57.005889 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:00:57.006268 [debug] [MainThread]: On master: COMMIT
[0m07:00:57.006562 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:57.006833 [debug] [MainThread]: On master: COMMIT
[0m07:00:57.007658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:00:57.008091 [debug] [MainThread]: On master: Close
[0m07:00:57.013622 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m07:00:57.014454 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m07:00:57.015579 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m07:00:57.016733 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m07:00:57.018339 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m07:00:57.019527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m07:00:57.020635 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m07:00:57.021583 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m07:00:57.022443 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m07:00:57.023356 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m07:00:57.024055 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m07:00:57.032864 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.034036 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m07:00:57.038985 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.043797 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.045213 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m07:00:57.046536 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m07:00:57.047243 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m07:00:57.112477 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.118487 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.124260 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.127591 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.128088 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m07:00:57.128887 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.129367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:57.129901 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m07:00:57.130827 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.131975 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:00:57.132980 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m07:00:57.134672 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:00:57.139844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m07:00:57.140399 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.140785 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m07:00:57.142470 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m07:00:57.143617 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.144696 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m07:00:57.146440 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m07:00:57.154340 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.009 seconds
[0m07:00:57.155356 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.159240 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.160049 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m07:00:57.160686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m07:00:57.161474 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m07:00:57.162677 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.163267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:00:57.164361 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m07:00:57.165369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:00:57.184717 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.013 seconds
[0m07:00:57.196930 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:00:57.195570 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:00:57.200622 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.201433 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.202651 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.203691 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m07:00:57.204563 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:00:57.205573 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:00:57.207524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:00:57.209140 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:00:57.209587 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.209936 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:00:57.215613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m07:00:57.222974 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m07:00:57.223843 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m07:00:57.230372 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m07:00:57.234772 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:00:57.237767 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m07:00:57.240456 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m07:00:57.241295 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m07:00:57.242289 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:00:57.243081 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:00:57.243887 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m07:00:57.244484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:00:57.245049 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m07:00:57.248184 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m07:00:57.249297 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:00:57.255487 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m07:00:57.256709 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:00:57.258858 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m07:00:57.259948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306b826f980>]}
[0m07:00:57.261194 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306b93dddc0>]}
[0m07:00:57.262414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bff5e72-819a-4cd1-99e6-9d6390a114b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306b827f890>]}
[0m07:00:57.263555 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.23s]
[0m07:00:57.264691 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.24s]
[0m07:00:57.266497 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.24s]
[0m07:00:57.267586 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m07:00:57.268628 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m07:00:57.269569 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m07:00:57.273734 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:57.274237 [debug] [MainThread]: On master: BEGIN
[0m07:00:57.274587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:00:57.284161 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:00:57.284721 [debug] [MainThread]: On master: COMMIT
[0m07:00:57.285117 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:57.285404 [debug] [MainThread]: On master: COMMIT
[0m07:00:57.286468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:00:57.287243 [debug] [MainThread]: On master: Close
[0m07:00:57.287938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:57.288300 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m07:00:57.288550 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m07:00:57.288848 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m07:00:57.289269 [info ] [MainThread]: 
[0m07:00:57.289661 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m07:00:57.290710 [debug] [MainThread]: Command end result
[0m07:00:57.321925 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:00:57.325088 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:00:57.334609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:00:57.335357 [info ] [MainThread]: 
[0m07:00:57.336151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:57.336794 [info ] [MainThread]: 
[0m07:00:57.337475 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:00:57.339391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3271543, "process_in_blocks": "0", "process_kernel_time": 0.376163, "process_mem_max_rss": "108508", "process_out_blocks": "3424", "process_user_time": 2.366545}
[0m07:00:57.340038 [debug] [MainThread]: Command `dbt run` succeeded at 07:00:57.339901 after 1.33 seconds
[0m07:00:57.340472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bc717bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bc0573b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306bbcce570>]}
[0m07:00:57.340884 [debug] [MainThread]: Flushing usage events
[0m07:00:59.480684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:10:10.484058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276ba76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276f47110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276ba6120>]}


============================== 07:10:10.491739 | f53987fa-86a0-4b85-8fc5-7ce044538184 ==============================
[0m07:10:10.491739 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:10:10.492371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:10:10.742455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276c06840>]}
[0m07:10:10.819633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d227670a2a0>]}
[0m07:10:10.820591 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:10:10.903142 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:10:11.023205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:11.023772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:11.118443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276618530>]}
[0m07:10:11.276916 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:11.280651 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:11.331707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2274a9fec0>]}
[0m07:10:11.333215 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m07:10:11.333978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2274d01640>]}
[0m07:10:11.336878 [info ] [MainThread]: 
[0m07:10:11.337761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:11.338456 [info ] [MainThread]: 
[0m07:10:11.339488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:10:11.347857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m07:10:11.433212 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m07:10:11.434282 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m07:10:11.435416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:11.454241 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m07:10:11.456741 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m07:10:11.460893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m07:10:11.475284 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:10:11.478156 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m07:10:11.481263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:11.497354 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m07:10:11.498430 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:10:11.499415 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:10:11.507483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m07:10:11.510386 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m07:10:11.513915 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m07:10:11.528184 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.528993 [debug] [MainThread]: On master: BEGIN
[0m07:10:11.529674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:10:11.545015 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:10:11.545805 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.546679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:10:11.558104 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m07:10:11.562037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22765a7080>]}
[0m07:10:11.563113 [debug] [MainThread]: On master: ROLLBACK
[0m07:10:11.564476 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.565241 [debug] [MainThread]: On master: BEGIN
[0m07:10:11.566571 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:10:11.567427 [debug] [MainThread]: On master: COMMIT
[0m07:10:11.568116 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.568742 [debug] [MainThread]: On master: COMMIT
[0m07:10:11.569863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:11.570525 [debug] [MainThread]: On master: Close
[0m07:10:11.578173 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m07:10:11.579174 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m07:10:11.580008 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m07:10:11.581239 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m07:10:11.582791 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m07:10:11.584075 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m07:10:11.587121 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m07:10:11.587849 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m07:10:11.585273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m07:10:11.586214 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m07:10:11.599758 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.600365 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m07:10:11.601124 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m07:10:11.604879 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.609227 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.610014 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m07:10:11.625020 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m07:10:11.631448 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m07:10:11.676585 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.672197 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.681183 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.683452 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.684809 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.685837 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m07:10:11.686555 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m07:10:11.687633 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:10:11.688250 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.688939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:10:11.689738 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m07:10:11.691037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:11.699358 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m07:10:11.700521 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m07:10:11.701470 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.702330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m07:10:11.703166 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.704129 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m07:10:11.704869 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.705565 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m07:10:11.706280 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m07:10:11.710408 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m07:10:11.711666 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m07:10:11.719700 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.720503 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.014 seconds
[0m07:10:11.724656 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.725609 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m07:10:11.729049 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.729845 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m07:10:11.731006 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m07:10:11.731755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:10:11.739581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m07:10:11.741063 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m07:10:11.756686 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:10:11.758896 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:10:11.760966 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:10:11.761794 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.762313 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.762835 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.763293 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:10:11.763750 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:10:11.764193 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:10:11.772400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m07:10:11.780319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m07:10:11.781400 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m07:10:11.785699 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m07:10:11.786702 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m07:10:11.789588 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m07:10:11.797213 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:10:11.798689 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:10:11.799504 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:10:11.800293 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m07:10:11.801002 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m07:10:11.801709 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m07:10:11.803084 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:10:11.805658 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m07:10:11.806805 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:10:11.807853 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:10:11.813475 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m07:10:11.814098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d227857e7e0>]}
[0m07:10:11.816168 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m07:10:11.817510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2270b50110>]}
[0m07:10:11.818742 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.22s]
[0m07:10:11.820431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f53987fa-86a0-4b85-8fc5-7ce044538184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2270b50530>]}
[0m07:10:11.821451 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.23s]
[0m07:10:11.823839 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m07:10:11.825172 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.23s]
[0m07:10:11.826491 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m07:10:11.827602 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m07:10:11.833040 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.833602 [debug] [MainThread]: On master: BEGIN
[0m07:10:11.833974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:10:11.843942 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:10:11.844468 [debug] [MainThread]: On master: COMMIT
[0m07:10:11.844827 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:11.845143 [debug] [MainThread]: On master: COMMIT
[0m07:10:11.845984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:11.846428 [debug] [MainThread]: On master: Close
[0m07:10:11.847087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:11.847444 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m07:10:11.847753 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m07:10:11.848029 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m07:10:11.848428 [info ] [MainThread]: 
[0m07:10:11.848828 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m07:10:11.851189 [debug] [MainThread]: Command end result
[0m07:10:11.880503 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:11.884493 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:11.891713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:10:11.892150 [info ] [MainThread]: 
[0m07:10:11.892585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:11.892931 [info ] [MainThread]: 
[0m07:10:11.893438 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:10:11.894722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4840854, "process_in_blocks": "0", "process_kernel_time": 0.433694, "process_mem_max_rss": "108704", "process_out_blocks": "3424", "process_user_time": 2.87186}
[0m07:10:11.895355 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:11.895226 after 1.48 seconds
[0m07:10:11.895756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2277156270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2274dd3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2276664da0>]}
[0m07:10:11.896249 [debug] [MainThread]: Flushing usage events
[0m07:10:13.303510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:18:50.812270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e082ce960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e082ccda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e0964e630>]}


============================== 07:18:50.819481 | dbac4709-7ac4-4fca-b99b-e8b1ffb1589e ==============================
[0m07:18:50.819481 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:18:50.820104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:18:51.060078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e07d29b80>]}
[0m07:18:51.128176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e07a1f5c0>]}
[0m07:18:51.129155 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:18:51.219574 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:18:51.335632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:18:51.336118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:18:51.378628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e060799d0>]}
[0m07:18:51.461869 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:18:51.464675 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:18:51.491680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e05fcee70>]}
[0m07:18:51.492272 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m07:18:51.492718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e05f88230>]}
[0m07:18:51.494698 [info ] [MainThread]: 
[0m07:18:51.495244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:18:51.495896 [info ] [MainThread]: 
[0m07:18:51.497280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:18:51.503563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m07:18:51.543442 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m07:18:51.543965 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m07:18:51.544288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:18:51.555668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:18:51.557266 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m07:18:51.560473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m07:18:51.566735 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:18:51.567197 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m07:18:51.567546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:18:51.576739 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:18:51.577227 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m07:18:51.577595 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:18:51.582487 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:18:51.584549 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m07:18:51.585336 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m07:18:51.592429 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.592975 [debug] [MainThread]: On master: BEGIN
[0m07:18:51.593728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:18:51.605111 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m07:18:51.605639 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.606052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:18:51.611181 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:18:51.612990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e051bb650>]}
[0m07:18:51.613654 [debug] [MainThread]: On master: ROLLBACK
[0m07:18:51.614686 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.615480 [debug] [MainThread]: On master: BEGIN
[0m07:18:51.616605 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:18:51.617097 [debug] [MainThread]: On master: COMMIT
[0m07:18:51.617524 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.618410 [debug] [MainThread]: On master: COMMIT
[0m07:18:51.619417 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:18:51.619818 [debug] [MainThread]: On master: Close
[0m07:18:51.625703 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m07:18:51.626655 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m07:18:51.627676 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m07:18:51.628686 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m07:18:51.629938 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m07:18:51.631526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m07:18:51.632403 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m07:18:51.633297 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m07:18:51.633884 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m07:18:51.635433 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m07:18:51.636769 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m07:18:51.646020 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.647300 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m07:18:51.651226 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.655370 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.656804 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m07:18:51.658666 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m07:18:51.683450 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m07:18:51.739928 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.740908 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.746655 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.748042 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.749049 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m07:18:51.750560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:18:51.751553 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.752451 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m07:18:51.752859 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:18:51.753770 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.754712 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m07:18:51.755646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:51.760345 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m07:18:51.760928 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.761303 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m07:18:51.763897 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m07:18:51.764905 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.766267 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m07:18:51.766854 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m07:18:51.767653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m07:18:51.774909 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.776155 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.777156 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m07:18:51.778304 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m07:18:51.779632 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m07:18:51.780083 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:18:51.784209 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.791096 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m07:18:51.803805 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m07:18:51.807963 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:18:51.811468 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.812700 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.813182 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:18:51.814176 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m07:18:51.815075 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m07:18:51.817444 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:18:51.819136 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.819896 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m07:18:51.820650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:18:51.823064 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:18:51.823711 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.824101 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m07:18:51.828501 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m07:18:51.835784 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m07:18:51.836597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m07:18:51.843504 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m07:18:51.842913 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m07:18:51.846185 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m07:18:51.848596 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m07:18:51.849390 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m07:18:51.850511 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m07:18:51.851434 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m07:18:51.852495 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m07:18:51.853019 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:18:51.853727 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m07:18:51.856996 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m07:18:51.857617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:18:51.859965 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m07:18:51.863844 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:18:51.865529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e099be990>]}
[0m07:18:51.867395 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m07:18:51.867980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e085bde20>]}
[0m07:18:51.869501 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.23s]
[0m07:18:51.870958 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.23s]
[0m07:18:51.872131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbac4709-7ac4-4fca-b99b-e8b1ffb1589e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e0623daf0>]}
[0m07:18:51.873589 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m07:18:51.874520 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m07:18:51.875570 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.24s]
[0m07:18:51.879228 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m07:18:51.883362 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.884042 [debug] [MainThread]: On master: BEGIN
[0m07:18:51.884417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:18:51.892839 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:18:51.893490 [debug] [MainThread]: On master: COMMIT
[0m07:18:51.893856 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:51.894151 [debug] [MainThread]: On master: COMMIT
[0m07:18:51.894858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:18:51.895337 [debug] [MainThread]: On master: Close
[0m07:18:51.895893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:18:51.896219 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m07:18:51.896476 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m07:18:51.896754 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m07:18:51.897143 [info ] [MainThread]: 
[0m07:18:51.897502 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m07:18:51.898551 [debug] [MainThread]: Command end result
[0m07:18:51.921800 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:18:51.923754 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:18:51.930488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:18:51.930924 [info ] [MainThread]: 
[0m07:18:51.931399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:18:51.931782 [info ] [MainThread]: 
[0m07:18:51.932118 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:18:51.933120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1753963, "process_in_blocks": "0", "process_kernel_time": 0.299536, "process_mem_max_rss": "108588", "process_out_blocks": "3424", "process_user_time": 2.202691}
[0m07:18:51.933767 [debug] [MainThread]: Command `dbt run` succeeded at 07:18:51.933638 after 1.18 seconds
[0m07:18:51.934198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e081ae930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e05fcf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742e05fcd430>]}
[0m07:18:51.934616 [debug] [MainThread]: Flushing usage events
[0m07:18:53.339990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:17.881149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a2c3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e09b6cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a064800>]}


============================== 08:39:17.905072 | 8b8977d9-8c31-4f9f-bec5-ae8b5a332753 ==============================
[0m08:39:17.905072 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:39:17.907604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:39:18.328230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0b6c3350>]}
[0m08:39:18.474419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a067380>]}
[0m08:39:18.477575 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:39:18.747806 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:39:19.197276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:39:19.198952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:39:19.346065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e07f31e50>]}
[0m08:39:19.499791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:39:19.506227 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:39:19.563780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e07c7e270>]}
[0m08:39:19.564548 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m08:39:19.565111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e07c0b290>]}
[0m08:39:19.569094 [info ] [MainThread]: 
[0m08:39:19.570685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:19.572769 [info ] [MainThread]: 
[0m08:39:19.576796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:39:19.586361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m08:39:19.667619 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m08:39:19.668284 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m08:39:19.668719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:19.696054 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m08:39:19.698982 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m08:39:19.702486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m08:39:19.712551 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:39:19.713298 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m08:39:19.713850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:19.725663 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m08:39:19.726586 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:39:19.727227 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:39:19.734726 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m08:39:19.738911 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m08:39:19.740694 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m08:39:19.751558 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:19.752342 [debug] [MainThread]: On master: BEGIN
[0m08:39:19.753037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:19.764904 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:39:19.765737 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:19.766549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:39:19.774572 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m08:39:19.776682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e07c27e30>]}
[0m08:39:19.777396 [debug] [MainThread]: On master: ROLLBACK
[0m08:39:19.778779 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:19.779743 [debug] [MainThread]: On master: BEGIN
[0m08:39:19.781587 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:39:19.782222 [debug] [MainThread]: On master: COMMIT
[0m08:39:19.782758 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:19.783494 [debug] [MainThread]: On master: COMMIT
[0m08:39:19.784879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:39:19.785368 [debug] [MainThread]: On master: Close
[0m08:39:19.792605 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m08:39:19.793566 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m08:39:19.794814 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m08:39:19.796021 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m08:39:19.797474 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m08:39:19.798776 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m08:39:19.799953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m08:39:19.801338 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m08:39:19.802286 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m08:39:19.803167 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m08:39:19.804072 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m08:39:19.805663 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m08:39:19.817443 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:19.823147 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m08:39:19.827881 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m08:39:19.830440 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m08:39:19.843968 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m08:39:19.844964 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m08:39:19.944493 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m08:39:19.943073 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:19.954371 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m08:39:19.957320 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:39:19.957927 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m08:39:19.958408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:39:19.959573 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:39:19.960666 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:19.961722 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m08:39:19.963274 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m08:39:19.964854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:39:19.965908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:19.971670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m08:39:19.972523 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:39:19.973249 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m08:39:19.981274 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m08:39:19.982713 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:39:19.984196 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m08:39:19.984792 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m08:39:19.985800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m08:39:19.996757 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:39:19.998356 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:19.999594 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m08:39:20.001071 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m08:39:20.003234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:39:20.012833 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m08:39:20.014004 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.016 seconds
[0m08:39:20.023911 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:20.039155 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m08:39:20.044268 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:39:20.045269 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m08:39:20.046366 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:39:20.047341 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m08:39:20.048654 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m08:39:20.050020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:39:20.051791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:39:20.054733 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m08:39:20.058207 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m08:39:20.059298 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:20.060362 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:39:20.061523 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m08:39:20.062655 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m08:39:20.065077 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m08:39:20.073175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m08:39:20.074195 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m08:39:20.076840 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m08:39:20.080046 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m08:39:20.083272 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m08:39:20.105500 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:39:20.106735 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:39:20.108905 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:39:20.110187 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m08:39:20.111573 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m08:39:20.112528 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m08:39:20.114410 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:39:20.117968 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m08:39:20.119132 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m08:39:20.122410 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m08:39:20.125551 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m08:39:20.126094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a29e840>]}
[0m08:39:20.129119 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m08:39:20.130939 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.32s]
[0m08:39:20.132717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e06dfd340>]}
[0m08:39:20.134379 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m08:39:20.135268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b8977d9-8c31-4f9f-bec5-ae8b5a332753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e06f55e80>]}
[0m08:39:20.136909 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.33s]
[0m08:39:20.138462 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.33s]
[0m08:39:20.139985 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m08:39:20.141255 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m08:39:20.147057 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:20.147738 [debug] [MainThread]: On master: BEGIN
[0m08:39:20.148150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:20.161018 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m08:39:20.161785 [debug] [MainThread]: On master: COMMIT
[0m08:39:20.162542 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:20.163338 [debug] [MainThread]: On master: COMMIT
[0m08:39:20.164511 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:39:20.165090 [debug] [MainThread]: On master: Close
[0m08:39:20.166175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:20.166639 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m08:39:20.166973 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m08:39:20.167596 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m08:39:20.168362 [info ] [MainThread]: 
[0m08:39:20.169074 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:39:20.173002 [debug] [MainThread]: Command end result
[0m08:39:20.211740 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:39:20.214379 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:39:20.224101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:39:20.224645 [info ] [MainThread]: 
[0m08:39:20.225235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:39:20.225669 [info ] [MainThread]: 
[0m08:39:20.226149 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:39:20.228198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.455971, "process_in_blocks": "0", "process_kernel_time": 1.05759, "process_mem_max_rss": "108768", "process_out_blocks": "3424", "process_user_time": 4.124237}
[0m08:39:20.229206 [debug] [MainThread]: Command `dbt run` succeeded at 08:39:20.228995 after 2.46 seconds
[0m08:39:20.229837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e09d66720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a2c0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761e0a2c0170>]}
[0m08:39:20.230538 [debug] [MainThread]: Flushing usage events
[0m08:39:21.784942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:21.238286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b802b7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b80829880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b7fdd0fe0>]}


============================== 10:51:21.242307 | 1b0f206c-b7d7-4386-bf0d-f92775aa1bb9 ==============================
[0m10:51:21.242307 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:51:21.243132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'debug': 'False', 'profiles_dir': '/home/tshep/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:21.250163 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `ecommerce_pipeline` found at `ecommerce_pipeline` in file
`/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/dbt_proje
ct.yml`. Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m10:51:21.250894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b0f206c-b7d7-4386-bf0d-f92775aa1bb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b7f58a900>]}
[0m10:51:21.490042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b0f206c-b7d7-4386-bf0d-f92775aa1bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b7f3f4ef0>]}
[0m10:51:21.535563 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:21.539166 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:21.540274 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:51:21.542034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b802b7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b7f3f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717b7f4e2960>]}
[0m10:51:21.542697 [debug] [MainThread]: Flushing usage events
[0m10:51:23.049550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:47.470192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0b8093a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0d3209e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0a8a8350>]}


============================== 10:52:47.474625 | 241f8412-5fdb-40c5-94db-38b7d8116e72 ==============================
[0m10:52:47.474625 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:52:47.476388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/tshep/.dbt', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --show-all-deprecations', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:52:47.481315 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `ecommerce_pipeline` found at `ecommerce_pipeline` in file
`/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/dbt_proje
ct.yml`. Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m10:52:47.482025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '241f8412-5fdb-40c5-94db-38b7d8116e72', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0a6e1ac0>]}
[0m10:52:47.663687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '241f8412-5fdb-40c5-94db-38b7d8116e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0ab16660>]}
[0m10:52:47.683498 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:52:47.685483 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:52:47.686591 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
[0m10:52:47.688447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0a8a84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0a6b1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea0a68e990>]}
[0m10:52:47.689175 [debug] [MainThread]: Flushing usage events
[0m10:52:49.340960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:12.875328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2afc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b0459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b045850>]}


============================== 10:53:12.881248 | d03e7bb8-a12f-4a3a-bcb0-3308bef9312a ==============================
[0m10:53:12.881248 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:53:12.882528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/tshep/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tshep/repos/ecommerce-analytics-pipeline/dbt/ecommerce_pipeline/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --show-all-deprecations', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:53:13.069251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd03e7bb8-a12f-4a3a-bcb0-3308bef9312a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2a17e600>]}
[0m10:53:13.084729 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:13.086313 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:13.087692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2afc3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2a0bd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2a2aab70>]}
[0m10:53:13.088290 [debug] [MainThread]: Flushing usage events
[0m10:53:15.245975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:47.964316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd20bc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd1ac9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd20bf620>]}


============================== 08:59:47.984529 | f300d12b-04c1-4a6b-87c2-a0fc538db2d8 ==============================
[0m08:59:47.984529 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:59:47.985647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:48.355192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd14ddd90>]}
[0m08:59:48.489130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcfadeea0>]}
[0m08:59:48.491714 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:59:48.609234 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:59:48.759502 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:59:48.760624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd13a6600>]}
[0m08:59:50.727045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcf8a65a0>]}
[0m08:59:50.855791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:59:50.862384 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:59:50.940941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcdef3530>]}
[0m08:59:50.943733 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m08:59:50.946817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcf773ec0>]}
[0m08:59:50.964448 [info ] [MainThread]: 
[0m08:59:50.967671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:59:50.971542 [info ] [MainThread]: 
[0m08:59:50.976812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:59:51.009607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m08:59:51.202838 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m08:59:51.204068 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m08:59:51.204931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:51.228389 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m08:59:51.230597 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m08:59:51.234178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m08:59:51.249114 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:59:51.249934 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m08:59:51.250687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:51.262641 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m08:59:51.263603 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m08:59:51.265379 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:59:51.272809 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:59:51.276410 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m08:59:51.278557 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m08:59:51.304078 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:51.304705 [debug] [MainThread]: On master: BEGIN
[0m08:59:51.305106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:51.318179 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m08:59:51.318964 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:51.319525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:59:51.329744 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m08:59:51.337459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcdf0c530>]}
[0m08:59:51.339721 [debug] [MainThread]: On master: ROLLBACK
[0m08:59:51.342017 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:51.343837 [debug] [MainThread]: On master: BEGIN
[0m08:59:51.349572 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:59:51.353420 [debug] [MainThread]: On master: COMMIT
[0m08:59:51.355237 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:51.356869 [debug] [MainThread]: On master: COMMIT
[0m08:59:51.359754 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:59:51.361094 [debug] [MainThread]: On master: Close
[0m08:59:51.375609 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m08:59:51.378157 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m08:59:51.383632 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m08:59:51.381119 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m08:59:51.388476 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m08:59:51.391674 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m08:59:51.395049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m08:59:51.398185 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m08:59:51.401533 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m08:59:51.403677 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m08:59:51.406606 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m08:59:51.409247 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m08:59:51.431437 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:51.449158 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m08:59:51.454648 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m08:59:51.458986 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m08:59:51.466782 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m08:59:51.521717 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m08:59:51.584908 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:51.593262 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m08:59:51.594964 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m08:59:51.596545 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:51.598431 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:59:51.599794 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m08:59:51.601522 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:59:51.602621 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m08:59:51.603438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:51.604672 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m08:59:51.605818 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:59:51.607248 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:59:51.617176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m08:59:51.618070 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:59:51.618912 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m08:59:51.621702 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m08:59:51.622879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m08:59:51.624594 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:59:51.625710 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:51.626771 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m08:59:51.627726 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m08:59:50.657703 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m08:59:50.667361 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.011 seconds
[0m08:59:50.669254 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m08:59:50.673743 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:59:50.678149 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:59:50.682950 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:50.683830 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m08:59:50.685271 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m08:59:50.687014 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m08:59:50.689080 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:59:50.689899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:59:50.703529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m08:59:50.719700 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m08:59:50.722580 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m08:59:50.726596 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m08:59:50.727910 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:59:50.728947 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:59:50.729791 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:50.730682 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m08:59:50.731519 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m08:59:50.732300 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m08:59:50.743037 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m08:59:50.751723 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m08:59:50.756804 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m08:59:50.759811 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m08:59:50.771336 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m08:59:50.773639 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m08:59:50.774513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m08:59:50.775430 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m08:59:50.776467 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m08:59:50.779603 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m08:59:50.781398 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m08:59:50.782172 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:59:50.782880 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:59:50.783821 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m08:59:50.787472 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m08:59:50.789923 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m08:59:50.794801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:59:50.796378 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcd2278f0>]}
[0m08:59:50.798753 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m08:59:50.799448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd331e600>]}
[0m08:59:50.801059 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in -0.61s]
[0m08:59:50.803580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300d12b-04c1-4a6b-87c2-a0fc538db2d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcf7702c0>]}
[0m08:59:50.802521 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in -0.61s]
[0m08:59:50.806379 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m08:59:50.807684 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in -0.59s]
[0m08:59:50.809564 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m08:59:50.811769 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m08:59:50.820042 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:50.821096 [debug] [MainThread]: On master: BEGIN
[0m08:59:50.821939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:50.846633 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m08:59:50.847371 [debug] [MainThread]: On master: COMMIT
[0m08:59:50.848693 [debug] [MainThread]: Using postgres connection "master"
[0m08:59:50.850448 [debug] [MainThread]: On master: COMMIT
[0m08:59:50.853721 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:59:50.855470 [debug] [MainThread]: On master: Close
[0m08:59:50.858060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:50.860417 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m08:59:50.863297 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m08:59:50.864930 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m08:59:50.867085 [info ] [MainThread]: 
[0m08:59:50.869167 [info ] [MainThread]: Finished running 3 table models in -1 hours 59 minutes and 59.89 seconds (-0.11s).
[0m08:59:50.876558 [debug] [MainThread]: Command end result
[0m08:59:50.939143 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:59:50.946322 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:59:50.967828 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:59:50.969136 [info ] [MainThread]: 
[0m08:59:50.970410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:50.971916 [info ] [MainThread]: 
[0m08:59:50.973760 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:59:50.977006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1255393, "process_in_blocks": "488", "process_kernel_time": 0.703913, "process_mem_max_rss": "113000", "process_out_blocks": "4256", "process_user_time": 5.576314}
[0m08:59:50.980220 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:50.979412 after 4.13 seconds
[0m08:59:50.981565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdd20bf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcd2d79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebdcd2d7a40>]}
[0m08:59:50.983563 [debug] [MainThread]: Flushing usage events
[0m08:59:50.976086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:38.289187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce8289f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce6680f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce6680ef0>]}


============================== 09:02:38.298819 | f4d7c2af-2963-412f-b1e5-8b5637eac20a ==============================
[0m09:02:38.298819 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:02:38.299883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:02:38.783170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce63a6d50>]}
[0m09:02:39.033087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce640eea0>]}
[0m09:02:39.036287 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:02:39.304690 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:02:39.535551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:02:39.536688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:02:39.600461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce6a0f9b0>]}
[0m09:02:39.723015 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:02:39.726722 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:02:39.771865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce7798d10>]}
[0m09:02:39.772710 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:02:39.773364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce4bd6ba0>]}
[0m09:02:39.777738 [info ] [MainThread]: 
[0m09:02:39.778777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:02:39.780129 [info ] [MainThread]: 
[0m09:02:39.782908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:02:39.792485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:02:39.855180 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:02:39.855796 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:02:39.856233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:39.872292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:02:39.874590 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:02:39.878320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:02:39.888268 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:02:39.889160 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:02:39.889613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:02:39.900583 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:02:39.901921 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:02:39.902997 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:02:39.911603 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:02:39.915196 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:02:39.918046 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:02:39.937501 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:39.939154 [debug] [MainThread]: On master: BEGIN
[0m09:02:39.940138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:02:39.958369 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:02:39.959369 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:39.960759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:02:39.975914 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:02:39.979907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce4bc4890>]}
[0m09:02:39.981458 [debug] [MainThread]: On master: ROLLBACK
[0m09:02:39.983442 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:39.984736 [debug] [MainThread]: On master: BEGIN
[0m09:02:39.990569 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:02:39.993712 [debug] [MainThread]: On master: COMMIT
[0m09:02:39.995148 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:39.996196 [debug] [MainThread]: On master: COMMIT
[0m09:02:39.999228 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:02:40.000513 [debug] [MainThread]: On master: Close
[0m09:02:40.014370 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:02:40.016940 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:02:40.020281 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:02:40.023191 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:02:40.025595 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:02:40.030015 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:02:40.032625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:02:40.034141 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:02:40.036567 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:02:40.038563 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:02:40.040623 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:02:40.043226 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:02:40.056434 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.063752 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.069276 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.071922 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:02:40.079953 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:02:40.087499 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:02:40.194638 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.196085 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.200903 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.204412 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.205913 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.207424 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:02:40.208950 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.210382 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:02:40.211926 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:02:40.213603 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:02:40.215204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:02:40.216720 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:02:40.229723 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m09:02:40.231025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:02:40.232605 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:02:40.233658 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.235191 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.237226 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.238767 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:02:40.240861 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:02:40.242227 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:02:40.253504 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m09:02:40.260583 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.017 seconds
[0m09:02:40.278962 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m09:02:40.281652 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.284997 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.294002 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.294800 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:02:40.295916 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:02:40.296929 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:02:40.298930 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:02:40.299995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:02:40.301614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:02:40.364250 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:02:40.365558 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:02:40.366241 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.367169 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:02:40.368173 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.368902 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:02:40.369523 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.370120 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:02:40.370930 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:02:40.383202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m09:02:40.384004 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m09:02:40.390825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:02:40.396103 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:02:40.399354 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:02:40.402501 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:02:40.412964 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:02:40.415210 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:02:40.416251 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:02:40.417248 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:02:40.417940 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:02:40.418681 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:02:40.420167 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:02:40.420855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:02:40.424239 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:02:40.425339 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:02:40.428071 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:02:40.436811 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:02:40.441872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce0980650>]}
[0m09:02:40.444445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce63c7530>]}
[0m09:02:40.447315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d7c2af-2963-412f-b1e5-8b5637eac20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce092e570>]}
[0m09:02:40.451481 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.40s]
[0m09:02:40.454913 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.41s]
[0m09:02:40.458728 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.41s]
[0m09:02:40.462927 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:02:40.467104 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:02:40.470948 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:02:40.481445 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:40.482591 [debug] [MainThread]: On master: BEGIN
[0m09:02:40.483416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:02:40.499419 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:02:40.503701 [debug] [MainThread]: On master: COMMIT
[0m09:02:40.506189 [debug] [MainThread]: Using postgres connection "master"
[0m09:02:40.508473 [debug] [MainThread]: On master: COMMIT
[0m09:02:40.511330 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:02:40.512354 [debug] [MainThread]: On master: Close
[0m09:02:40.513563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:02:40.514183 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:02:40.514694 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:02:40.515200 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:02:40.515833 [info ] [MainThread]: 
[0m09:02:40.516405 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m09:02:40.519312 [debug] [MainThread]: Command end result
[0m09:02:40.604200 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:02:40.608556 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:02:40.626626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:02:40.627167 [info ] [MainThread]: 
[0m09:02:40.627795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:02:40.628295 [info ] [MainThread]: 
[0m09:02:40.629010 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:02:40.631822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.421964, "process_in_blocks": "0", "process_kernel_time": 0.574353, "process_mem_max_rss": "108560", "process_out_blocks": "3424", "process_user_time": 3.863168}
[0m09:02:40.632769 [debug] [MainThread]: Command `dbt run` succeeded at 09:02:40.632595 after 2.42 seconds
[0m09:02:40.633390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce643fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce4b56960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7ce8289f10>]}
[0m09:02:40.633966 [debug] [MainThread]: Flushing usage events
[0m09:02:45.078395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:29.968398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf7fe8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf7eb1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf6089250>]}


============================== 09:06:29.977679 | d5eb4f45-ab1e-445b-b685-e66f334e5b29 ==============================
[0m09:06:29.977679 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:06:29.978538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:06:30.274949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf47223c0>]}
[0m09:06:30.372668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf7b48ef0>]}
[0m09:06:30.374154 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:30.494620 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:06:30.648599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:06:30.649171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:06:30.707611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf4723830>]}
[0m09:06:30.831471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:06:30.834650 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:06:30.876390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf47123c0>]}
[0m09:06:30.877789 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:06:30.879111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf6047b60>]}
[0m09:06:30.882876 [info ] [MainThread]: 
[0m09:06:30.883624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:06:30.884396 [info ] [MainThread]: 
[0m09:06:30.885518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:06:30.896147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:06:30.991512 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:06:30.992113 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:06:30.992634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:31.011354 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m09:06:31.013968 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:06:31.018122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:06:31.028741 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:06:31.029801 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:06:31.030467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:31.044585 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m09:06:31.046189 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:06:31.047436 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:06:31.061073 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m09:06:31.065573 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:06:31.067186 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:06:31.082987 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.084977 [debug] [MainThread]: On master: BEGIN
[0m09:06:31.086391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:06:31.102016 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:06:31.102919 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.103996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:06:31.111045 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m09:06:31.113691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf4435dc0>]}
[0m09:06:31.114573 [debug] [MainThread]: On master: ROLLBACK
[0m09:06:31.117289 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.118174 [debug] [MainThread]: On master: BEGIN
[0m09:06:31.120283 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:06:31.121898 [debug] [MainThread]: On master: COMMIT
[0m09:06:31.122426 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.122855 [debug] [MainThread]: On master: COMMIT
[0m09:06:31.123968 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:06:31.125036 [debug] [MainThread]: On master: Close
[0m09:06:31.132282 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:06:31.133970 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:06:31.135983 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:06:31.137722 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:06:31.139076 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:06:31.140801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:06:31.142497 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:06:31.144633 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:06:31.145896 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:06:31.147130 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:06:31.148070 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:06:31.161340 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:06:31.164725 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.169074 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.176171 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.179159 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:06:31.181383 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:06:31.202032 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:06:31.274556 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.284200 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.288735 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.289679 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.291881 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.292968 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.293746 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:06:31.294734 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:06:31.295681 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:06:31.296799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:31.298017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:06:31.299157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:06:31.312731 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:06:31.314304 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.315490 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:06:31.316587 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:06:31.318161 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.318723 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:06:31.319623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m09:06:31.321293 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.322371 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:06:31.325456 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.007 seconds
[0m09:06:31.334012 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m09:06:31.334832 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.014 seconds
[0m09:06:31.345469 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.349545 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.353754 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.355100 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:06:31.356268 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:06:31.357516 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:06:31.359895 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:06:31.360870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:06:31.373456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:06:31.394804 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:06:31.395823 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:06:31.399427 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:06:31.400228 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.401130 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.402285 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.403376 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:06:31.404436 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:06:31.405372 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:06:31.416657 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m09:06:31.424682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m09:06:31.425843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:06:31.434806 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:06:31.436044 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:06:31.439605 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:06:31.452702 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:06:31.453635 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:06:31.455365 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:06:31.456200 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:06:31.457270 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:06:31.458712 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:06:31.460858 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:06:31.464688 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:06:31.466382 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:06:31.471685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:06:31.473816 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:06:31.474995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf368d940>]}
[0m09:06:31.477180 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:06:31.478644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf056b4d0>]}
[0m09:06:31.480468 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.32s]
[0m09:06:31.483353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5eb4f45-ab1e-445b-b685-e66f334e5b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf056bd70>]}
[0m09:06:31.485395 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.33s]
[0m09:06:31.487967 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:06:31.490494 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.34s]
[0m09:06:31.492262 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:06:31.494844 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:06:31.502396 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.503228 [debug] [MainThread]: On master: BEGIN
[0m09:06:31.503961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:06:31.522315 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:06:31.524107 [debug] [MainThread]: On master: COMMIT
[0m09:06:31.526017 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:31.526978 [debug] [MainThread]: On master: COMMIT
[0m09:06:31.528756 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:06:31.529561 [debug] [MainThread]: On master: Close
[0m09:06:31.530857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:06:31.531860 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:06:31.532952 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:06:31.534280 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:06:31.537958 [info ] [MainThread]: 
[0m09:06:31.539583 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m09:06:31.546595 [debug] [MainThread]: Command end result
[0m09:06:31.596877 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:06:31.600050 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:06:31.610586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:06:31.611141 [info ] [MainThread]: 
[0m09:06:31.611881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:06:31.612718 [info ] [MainThread]: 
[0m09:06:31.613634 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:06:31.617385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7291793, "process_in_blocks": "0", "process_kernel_time": 0.500284, "process_mem_max_rss": "108924", "process_out_blocks": "3424", "process_user_time": 3.323054}
[0m09:06:31.618678 [debug] [MainThread]: Command `dbt run` succeeded at 09:06:31.618518 after 1.73 seconds
[0m09:06:31.619142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf97ba870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf6614b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ecf4435f40>]}
[0m09:06:31.619612 [debug] [MainThread]: Flushing usage events
[0m09:06:33.277290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:02.278721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f8fb3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f9214500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f9217bf0>]}


============================== 09:37:02.292769 | 6bb22823-ea6e-411d-8240-a4ea5bcba9de ==============================
[0m09:37:02.292769 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:37:02.293919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:37:02.678303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f9548590>]}
[0m09:37:02.779730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f8cb53a0>]}
[0m09:37:02.781356 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:02.878219 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:37:03.067027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:03.067770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:03.122894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f89f5610>]}
[0m09:37:03.241601 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:03.246571 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:03.283809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f6efd100>]}
[0m09:37:03.284600 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:37:03.285427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f8af2b70>]}
[0m09:37:03.288121 [info ] [MainThread]: 
[0m09:37:03.288765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:03.289398 [info ] [MainThread]: 
[0m09:37:03.291698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:03.310941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:37:03.366714 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:37:03.367291 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:37:03.367686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:03.382870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m09:37:03.384895 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:37:03.388442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:37:03.396437 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:37:03.397011 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:37:03.397454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:03.410989 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:37:03.411553 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:37:03.411946 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:37:03.418586 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:37:03.420519 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:37:03.421597 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:37:03.430655 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.431428 [debug] [MainThread]: On master: BEGIN
[0m09:37:03.431917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:03.444741 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:37:03.445599 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.446458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:03.455111 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:37:03.457084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f6efc920>]}
[0m09:37:03.457951 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:03.459056 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.459995 [debug] [MainThread]: On master: BEGIN
[0m09:37:03.461520 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:37:03.461981 [debug] [MainThread]: On master: COMMIT
[0m09:37:03.462355 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.462709 [debug] [MainThread]: On master: COMMIT
[0m09:37:03.463630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:03.464343 [debug] [MainThread]: On master: Close
[0m09:37:03.472591 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:37:03.474094 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:37:03.475367 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:37:03.476918 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:37:03.478512 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:37:03.479984 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:37:03.481692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:37:03.482979 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:37:03.483910 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:37:03.484953 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:37:03.485705 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:37:03.486651 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:37:03.498828 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.503337 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.508262 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.510840 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:37:03.512639 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:37:03.525759 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:37:03.631841 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.632792 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.637761 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.642072 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.642759 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:37:03.643321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:03.644557 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.645541 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:37:03.646178 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:37:03.647195 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.648215 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:37:03.649148 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:37:03.655528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:37:03.656416 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.657009 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:37:03.660291 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m09:37:03.661395 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.662254 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:37:03.663192 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m09:37:03.664111 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:37:03.674875 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.676162 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m09:37:03.677509 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.679025 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:37:03.683312 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.684419 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:37:03.685780 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:37:03.686689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:37:03.695787 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.008 seconds
[0m09:37:03.696788 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:37:03.706644 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.721640 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:37:03.723979 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:37:03.724778 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:37:03.725692 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.726346 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.727475 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:37:03.728027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:37:03.728635 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:37:03.731059 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:37:03.732366 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.732896 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:37:03.743991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:37:03.754020 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:37:03.755124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m09:37:03.755963 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m09:37:03.764930 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:37:03.767705 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:37:03.770826 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:37:03.771804 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:37:03.772933 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:37:03.773897 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:37:03.775048 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:37:03.775670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:37:03.776504 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:37:03.780223 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:37:03.781187 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:37:03.786015 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:37:03.787922 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:37:03.788793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f954a420>]}
[0m09:37:03.790965 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:37:03.792352 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.30s]
[0m09:37:03.793607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f6126a20>]}
[0m09:37:03.796068 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:37:03.797319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb22823-ea6e-411d-8240-a4ea5bcba9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f6126090>]}
[0m09:37:03.798796 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.31s]
[0m09:37:03.802260 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.31s]
[0m09:37:03.804370 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:37:03.806585 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:37:03.815027 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.818244 [debug] [MainThread]: On master: BEGIN
[0m09:37:03.820095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:03.833773 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:37:03.834485 [debug] [MainThread]: On master: COMMIT
[0m09:37:03.835167 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:03.836202 [debug] [MainThread]: On master: COMMIT
[0m09:37:03.838087 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:37:03.838823 [debug] [MainThread]: On master: Close
[0m09:37:03.839842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:03.841015 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:37:03.842337 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:37:03.843389 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:37:03.845110 [info ] [MainThread]: 
[0m09:37:03.846133 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m09:37:03.851210 [debug] [MainThread]: Command end result
[0m09:37:03.883970 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:03.886122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:03.894988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:37:03.895563 [info ] [MainThread]: 
[0m09:37:03.896120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:37:03.896549 [info ] [MainThread]: 
[0m09:37:03.896994 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:37:03.898465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.700063, "process_in_blocks": "0", "process_kernel_time": 0.476614, "process_mem_max_rss": "108600", "process_out_blocks": "3424", "process_user_time": 3.158953}
[0m09:37:03.899192 [debug] [MainThread]: Command `dbt run` succeeded at 09:37:03.899030 after 1.70 seconds
[0m09:37:03.899701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1def01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f89aacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd1f8d078c0>]}
[0m09:37:03.900170 [debug] [MainThread]: Flushing usage events
[0m09:37:05.327559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:24.690020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d355c57a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d35600ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d355c56bd0>]}


============================== 09:43:24.702731 | 2fa37c06-6192-4807-bfdf-381e73b63bd6 ==============================
[0m09:43:24.702731 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:43:24.704128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:25.074294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3551eb110>]}
[0m09:43:25.241578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3553ed280>]}
[0m09:43:25.243424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:43:25.440292 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:43:25.679732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:25.680391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:25.752913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d35536d370>]}
[0m09:43:25.874415 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:25.877982 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:25.920221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d353603e90>]}
[0m09:43:25.921777 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:43:25.923193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3535ceab0>]}
[0m09:43:25.927467 [info ] [MainThread]: 
[0m09:43:25.928697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:25.929591 [info ] [MainThread]: 
[0m09:43:25.930715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:25.938119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:43:26.000391 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:43:26.001027 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:43:26.001787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:26.016584 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m09:43:26.018767 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:43:26.021999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:43:26.030366 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:43:26.030923 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:43:26.031308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:26.043059 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:43:26.043994 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:43:26.044651 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:43:26.051147 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:43:26.053310 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:43:26.054338 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:43:26.063811 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.064455 [debug] [MainThread]: On master: BEGIN
[0m09:43:26.065014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:26.080743 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:43:26.082108 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.083284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:26.094909 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m09:43:26.097965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d353846e40>]}
[0m09:43:26.098845 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:26.100144 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.100869 [debug] [MainThread]: On master: BEGIN
[0m09:43:26.103030 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:43:26.105209 [debug] [MainThread]: On master: COMMIT
[0m09:43:26.106043 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.106678 [debug] [MainThread]: On master: COMMIT
[0m09:43:26.108263 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:43:26.109637 [debug] [MainThread]: On master: Close
[0m09:43:26.118946 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:43:26.120066 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:43:26.121056 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:43:26.122335 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:43:26.123859 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:43:26.125600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:43:26.127048 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:43:26.128589 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:43:26.130008 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:43:26.131792 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:43:26.133453 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:43:26.150610 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.152428 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:43:26.158844 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.165134 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.166476 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:43:26.181020 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:43:26.194189 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:43:26.282460 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.285983 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.289881 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.291435 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.293219 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.294012 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:43:26.294921 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.295876 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:43:26.297100 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:43:26.297993 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:43:26.298649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:26.300219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:43:26.311607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m09:43:26.312814 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m09:43:26.313846 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.314809 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.315734 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:43:26.317344 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:43:26.318645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:43:26.320553 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.321920 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:43:26.329915 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m09:43:26.331434 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m09:43:26.333501 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.013 seconds
[0m09:43:26.349320 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.356184 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.360062 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.360768 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:43:26.361441 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:43:26.362516 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:43:26.364233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:26.365013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:26.372447 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:43:26.413685 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:43:26.414678 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:43:26.415835 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.417276 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:43:26.418801 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.420140 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:43:26.421331 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.422780 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:43:26.424085 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:43:26.434246 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m09:43:26.442877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m09:43:26.445816 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:43:26.452674 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m09:43:26.453974 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:43:26.457683 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:43:26.463331 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:43:26.465558 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:43:26.466966 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:43:26.469336 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:43:26.470237 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:43:26.471673 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:43:26.472316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:43:26.473788 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:43:26.477183 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:43:26.478122 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:43:26.480598 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:43:26.482959 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:43:26.486852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d353701160>]}
[0m09:43:26.488174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d350679370>]}
[0m09:43:26.489517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa37c06-6192-4807-bfdf-381e73b63bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d352787410>]}
[0m09:43:26.491133 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.36s]
[0m09:43:26.492657 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.36s]
[0m09:43:26.493799 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.36s]
[0m09:43:26.495198 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:43:26.496337 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:43:26.497477 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:43:26.504641 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.505793 [debug] [MainThread]: On master: BEGIN
[0m09:43:26.506484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:26.517886 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:43:26.518510 [debug] [MainThread]: On master: COMMIT
[0m09:43:26.518995 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:26.519451 [debug] [MainThread]: On master: COMMIT
[0m09:43:26.520566 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:43:26.521266 [debug] [MainThread]: On master: Close
[0m09:43:26.522099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:26.522505 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:43:26.522935 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:43:26.523298 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:43:26.523961 [info ] [MainThread]: 
[0m09:43:26.524614 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:43:26.526917 [debug] [MainThread]: Command end result
[0m09:43:26.557711 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:26.560975 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:26.574993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:43:26.575525 [info ] [MainThread]: 
[0m09:43:26.576104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:26.576526 [info ] [MainThread]: 
[0m09:43:26.577142 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:43:26.579156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9888189, "process_in_blocks": "0", "process_kernel_time": 0.470714, "process_mem_max_rss": "109296", "process_out_blocks": "3432", "process_user_time": 3.39352}
[0m09:43:26.579971 [debug] [MainThread]: Command `dbt run` succeeded at 09:43:26.579812 after 1.99 seconds
[0m09:43:26.580450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d35512fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d352837440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3538c9a60>]}
[0m09:43:26.580912 [debug] [MainThread]: Flushing usage events
[0m09:43:28.099617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:36.695496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e292a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e17adac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e0e58bc0>]}


============================== 09:46:36.707520 | 4d59d403-2f87-477e-a371-5baaac3ed5af ==============================
[0m09:46:36.707520 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:46:36.708754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:37.007098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e1666c30>]}
[0m09:46:37.110935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e14414c0>]}
[0m09:46:37.112332 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:46:37.224667 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:46:37.403070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:37.403869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:37.456816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73df269790>]}
[0m09:46:37.574196 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:46:37.578447 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:46:37.611363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73def6d010>]}
[0m09:46:37.612224 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:46:37.612878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73def2f230>]}
[0m09:46:37.615839 [info ] [MainThread]: 
[0m09:46:37.616569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:37.617455 [info ] [MainThread]: 
[0m09:46:37.619510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:37.629108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:46:37.684196 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:46:37.685229 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:46:37.686592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:37.700634 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m09:46:37.703052 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:46:37.706213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:46:37.714059 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:46:37.714675 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:46:37.715058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:37.726377 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:46:37.727459 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:46:37.727948 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:46:37.734660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:46:37.736908 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:46:37.738008 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:46:37.748846 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:37.749468 [debug] [MainThread]: On master: BEGIN
[0m09:46:37.750081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:37.763652 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:46:37.764769 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:37.766067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:37.774491 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:46:37.777344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73df1adf10>]}
[0m09:46:37.778835 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:37.780101 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:37.780665 [debug] [MainThread]: On master: BEGIN
[0m09:46:37.782214 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:46:37.783418 [debug] [MainThread]: On master: COMMIT
[0m09:46:37.784767 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:37.785579 [debug] [MainThread]: On master: COMMIT
[0m09:46:37.786866 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:46:37.787652 [debug] [MainThread]: On master: Close
[0m09:46:37.796051 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:46:37.798789 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:46:37.800332 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:46:37.801831 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:46:37.802907 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:46:37.804940 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:46:37.806462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:46:37.808084 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:46:37.809627 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:46:37.810547 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:46:37.811277 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:46:37.812272 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:46:37.843712 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:46:37.840291 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:37.849343 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:46:37.852881 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:46:37.856319 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:46:37.880651 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:46:37.950553 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:37.951391 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:46:37.956269 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:46:37.959118 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:46:37.960184 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:46:37.960952 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:46:37.961987 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:46:37.963110 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:37.964046 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:46:37.964881 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:46:37.965910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:37.966683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:37.974660 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m09:46:37.975837 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:46:37.976631 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:46:37.978735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:46:37.979537 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:37.980415 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:46:37.981281 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:46:37.982052 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:46:37.983283 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m09:46:37.984442 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:46:37.986243 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m09:46:38.001088 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:46:38.008568 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.009 seconds
[0m09:46:38.007783 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:38.009745 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:46:38.013704 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:46:38.014849 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:46:38.017625 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:46:38.019356 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:46:38.021674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:38.029043 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:46:38.048108 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:46:38.050661 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:46:38.053830 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:46:38.054956 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:46:38.056029 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:38.056993 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:46:38.057873 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:46:38.058725 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:46:38.059743 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:46:38.091990 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m09:46:38.099945 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m09:46:38.105031 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:46:38.108584 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:46:38.109570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m09:46:38.118453 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:46:38.119420 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:46:38.122616 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:46:38.123582 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:46:38.124693 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:46:38.125804 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:46:38.127066 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:46:38.128429 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:46:38.129692 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:46:38.130703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:46:38.135411 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:46:38.137714 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:46:38.139997 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:46:38.144800 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73c6f6bc20>]}
[0m09:46:38.145826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e29e6930>]}
[0m09:46:38.147470 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 0[0m in 0.33s]
[0m09:46:38.148659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59d403-2f87-477e-a371-5baaac3ed5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73de0efdd0>]}
[0m09:46:38.150251 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 0[0m in 0.34s]
[0m09:46:38.151517 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:46:38.153076 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 0[0m in 0.34s]
[0m09:46:38.154268 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:46:38.155926 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:46:38.161171 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.162152 [debug] [MainThread]: On master: BEGIN
[0m09:46:38.162843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:38.174771 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:46:38.175650 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.176511 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.177137 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.178054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:38.178536 [debug] [MainThread]: On master: Close
[0m09:46:38.179917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:38.181664 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:46:38.183352 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:46:38.184309 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:46:38.187321 [info ] [MainThread]: 
[0m09:46:38.188757 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:46:38.191833 [debug] [MainThread]: Command end result
[0m09:46:38.228341 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:46:38.231021 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:46:38.240769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:46:38.241599 [info ] [MainThread]: 
[0m09:46:38.242200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:38.242653 [info ] [MainThread]: 
[0m09:46:38.243769 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:46:38.247641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6421835, "process_in_blocks": "0", "process_kernel_time": 0.435688, "process_mem_max_rss": "108844", "process_out_blocks": "3424", "process_user_time": 3.093757}
[0m09:46:38.248622 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:38.248436 after 1.64 seconds
[0m09:46:38.249269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e11ab770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e2989190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c73e0de8c20>]}
[0m09:46:38.249776 [debug] [MainThread]: Flushing usage events
[0m09:46:40.358845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:43.738115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b71287ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b7320c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b719e0260>]}


============================== 09:47:43.747047 | 46a2d744-b7bc-4c14-9ac4-0c3eae320b34 ==============================
[0m09:47:43.747047 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:47:43.748074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:47:43.814263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e504fa9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5066e7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e505347800>]}


============================== 09:47:43.834002 | 7c89ba6f-1641-4541-9f31-1ac4ed815a69 ==============================
[0m09:47:43.834002 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:47:43.835090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:47:44.191965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b711ed610>]}
[0m09:47:44.332971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e505636ae0>]}
[0m09:47:44.402305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b7143fd10>]}
[0m09:47:44.404634 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:47:44.525139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e504ce3740>]}
[0m09:47:44.526973 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:47:44.568976 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:47:44.663632 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:47:44.742970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:44.744001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:44.831448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b6f999f10>]}
[0m09:47:44.854932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:44.855504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:44.905607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5058b77d0>]}
[0m09:47:44.948116 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:47:44.952202 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:47:44.997138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b6f75c410>]}
[0m09:47:44.997878 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:47:44.998427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b6f6ff9b0>]}
[0m09:47:45.001256 [info ] [MainThread]: 
[0m09:47:45.001905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:45.002565 [info ] [MainThread]: 
[0m09:47:45.004068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:47:45.012061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:47:45.037584 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:47:45.040931 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:47:45.089211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e504d30e90>]}
[0m09:47:45.090831 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:47:45.091882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e503513b30>]}
[0m09:47:45.093850 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:47:45.096090 [info ] [MainThread]: 
[0m09:47:45.094676 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:47:45.097329 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:45.098220 [info ] [MainThread]: 
[0m09:47:45.098308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:45.099112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:47:45.106891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:47:45.116921 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m09:47:45.119275 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:47:45.122866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:47:45.136484 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:47:45.137258 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:47:45.137832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:45.153221 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:47:45.154233 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:47:45.154908 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:47:45.159547 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m09:47:45.162606 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:47:45.164694 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:47:45.179812 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.180702 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.181396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:45.200829 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:47:45.202624 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:47:45.202684 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m09:47:45.203401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:45.203848 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.205208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:47:45.215335 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m09:47:45.217777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b71257c20>]}
[0m09:47:45.218784 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:45.219749 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.220283 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.221837 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:47:45.222689 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.224519 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.225780 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.225801 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m09:47:45.227248 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:47:45.227916 [debug] [MainThread]: On master: Close
[0m09:47:45.229784 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:47:45.234392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:47:45.236647 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.237669 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.239251 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:47:45.240542 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.246274 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:47:45.244209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:47:45.247007 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:47:45.247443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:45.242622 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:47:45.246382 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:47:45.248103 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.249423 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:47:45.261799 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m09:47:45.262593 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:47:45.263236 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:47:45.250538 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:47:45.257313 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.268483 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m09:47:45.270897 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:47:45.272051 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:47:45.266939 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.267884 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.273666 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.282589 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.283826 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.285135 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.284928 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.285870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:45.291948 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.301003 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:47:45.301627 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.302305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:47:45.298805 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.309552 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m09:47:45.312349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e50502e720>]}
[0m09:47:45.313256 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:45.314325 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.315066 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.317015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:47:45.318233 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.318826 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.319291 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.320564 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:47:45.321772 [debug] [MainThread]: On master: Close
[0m09:47:45.331301 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.332694 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.337261 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.335523 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:47:45.340047 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:47:45.341650 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:47:45.343858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:47:45.345696 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:47:45.347091 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:47:45.348157 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.348984 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.349918 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.362342 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.366051 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.370806 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.372453 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.381410 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.433570 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.437050 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.438481 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.441218 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.442052 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.443678 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:47:45.444779 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.388928 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.445448 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:47:45.446291 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:47:45.447268 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:47:45.448321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:45.449944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:47:45.462465 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:47:45.463629 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.465620 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:47:45.466546 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:47:45.467518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:47:45.469042 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.470445 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.472314 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:47:45.473563 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:47:45.475210 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.009 seconds
[0m09:47:45.486066 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.011 seconds
[0m09:47:45.489523 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.490170 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.014 seconds
[0m09:47:45.494022 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.488198 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.495078 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m09:47:45.499018 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.500825 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.499971 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m09:47:45.501180 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m09:47:45.502397 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:47:45.502645 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.505409 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.506545 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.506933 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.507531 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.508059 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:47:45.507852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:47:45.508598 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:47:45.509287 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:47:45.509865 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:47:45.510526 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:47:45.511093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:45.508637 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:47:45.509444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:47:45.513357 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.521774 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:47:45.527809 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m09:47:45.530387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:47:45.532119 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.532926 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.534085 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m09:47:45.526340 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.536075 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:47:45.537815 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:47:45.539436 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.542596 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:47:45.527558 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:47:45.547544 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:47:45.567988 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:47:45.569466 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:47:45.570097 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.570667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:47:45.572920 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:47:45.573622 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:47:45.575980 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:47:45.576605 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.577425 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.578032 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:47:45.578557 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:47:45.579786 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:47:45.582289 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.041 seconds
[0m09:47:45.587726 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m09:47:45.583191 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.042 seconds
[0m09:47:45.588799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m09:47:45.590590 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.046 seconds
[0m09:47:45.597396 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:47:45.594687 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.598473 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.602052 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.602733 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m09:47:45.603337 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m09:47:45.603930 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m09:47:45.606380 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_segmentation__dbt_backup" already exists

[0m09:47:45.607955 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: ROLLBACK
[0m09:47:45.609218 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "top_selling_products__dbt_backup" already exists

[0m09:47:45.610598 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "daily_revenue__dbt_backup" already exists

[0m09:47:45.597881 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:47:45.612870 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: ROLLBACK
[0m09:47:45.614623 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:47:45.600884 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:47:45.616810 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: ROLLBACK
[0m09:47:45.616527 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:47:45.618701 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m09:47:45.618576 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:47:45.619675 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:47:45.620101 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:47:45.621362 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:47:45.622342 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:47:45.623081 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:47:45.624369 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:47:45.623485 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m09:47:45.624338 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:47:45.635132 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:47:45.632816 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:47:45.635657 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m09:47:45.644153 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.019 seconds
[0m09:47:45.644419 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:47:45.646075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m09:47:45.642990 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:47:45.652304 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:47:45.655460 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:47:45.662965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b7318e420>]}
[0m09:47:45.665585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b712c9a00>]}
[0m09:47:45.667976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d744-b7bc-4c14-9ac4-0c3eae320b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b6f721370>]}
[0m09:47:45.670478 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.41s]
[0m09:47:45.671678 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.41s]
[0m09:47:45.673437 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.42s]
[0m09:47:45.677367 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.679086 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.680400 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.692047 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.692799 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.693272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:45.693306 [debug] [Thread-3 (]: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:47:45.697921 [debug] [Thread-1 (]: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:47:45.703652 [debug] [Thread-2 (]: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:47:45.707985 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:47:45.708553 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.709065 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.707279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5023d82c0>]}
[0m09:47:45.710184 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.712132 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:47:45.707960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5034dbfb0>]}
[0m09:47:45.712814 [debug] [MainThread]: On master: Close
[0m09:47:45.713872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:45.708758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c89ba6f-1641-4541-9f31-1ac4ed815a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5058966f0>]}
[0m09:47:45.714341 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:47:45.714927 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:47:45.715793 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:47:45.711600 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model dev.top_selling_products ................. [[31mERROR[0m in 0.35s]
[0m09:47:45.717286 [info ] [MainThread]: 
[0m09:47:45.718758 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m09:47:45.713756 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.daily_revenue ........................ [[31mERROR[0m in 0.36s]
[0m09:47:45.722988 [debug] [MainThread]: Command end result
[0m09:47:45.715902 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.customer_segmentation ................ [[31mERROR[0m in 0.36s]
[0m09:47:45.722078 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:47:45.724290 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:47:45.726681 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:47:45.729981 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.top_selling_products' to be skipped because of status 'error'.  Reason: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql.
[0m09:47:45.736973 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.daily_revenue' to be skipped because of status 'error'.  Reason: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql.
[0m09:47:45.738758 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.customer_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql.
[0m09:47:45.741963 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.742836 [debug] [MainThread]: On master: BEGIN
[0m09:47:45.743220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:45.754557 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:47:45.755391 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.756030 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:45.756535 [debug] [MainThread]: On master: COMMIT
[0m09:47:45.757633 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:47:45.758008 [debug] [MainThread]: On master: Close
[0m09:47:45.758595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:45.758918 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:47:45.759213 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:47:45.759493 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:47:45.759900 [info ] [MainThread]: 
[0m09:47:45.760284 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m09:47:45.761750 [debug] [MainThread]: Command end result
[0m09:47:45.762420 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:47:45.765886 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:47:45.779083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:47:45.779874 [info ] [MainThread]: 
[0m09:47:45.780644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:47:45.781268 [info ] [MainThread]: 
[0m09:47:45.781979 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:47:45.783862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1186337, "process_in_blocks": "0", "process_kernel_time": 0.57833, "process_mem_max_rss": "108992", "process_out_blocks": "3416", "process_user_time": 3.532603}
[0m09:47:45.784713 [debug] [MainThread]: Command `dbt run` succeeded at 09:47:45.784524 after 2.12 seconds
[0m09:47:45.785290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b714c4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b71dac2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b71dad130>]}
[0m09:47:45.785780 [debug] [MainThread]: Flushing usage events
[0m09:47:45.803561 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:47:45.805894 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:47:45.815627 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:47:45.816150 [info ] [MainThread]: 
[0m09:47:45.816815 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:47:45.818008 [info ] [MainThread]: 
[0m09:47:45.819012 [error] [MainThread]:   Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:47:45.819725 [info ] [MainThread]: 
[0m09:47:45.820607 [error] [MainThread]:   Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:47:45.821316 [info ] [MainThread]: 
[0m09:47:45.822006 [error] [MainThread]:   Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation__dbt_backup" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:47:45.822594 [info ] [MainThread]: 
[0m09:47:45.823245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m09:47:45.826615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0920143, "process_in_blocks": "392", "process_kernel_time": 0.574518, "process_mem_max_rss": "108524", "process_out_blocks": "3432", "process_user_time": 3.49867}
[0m09:47:45.827756 [debug] [MainThread]: Command `dbt run` failed at 09:47:45.827564 after 2.09 seconds
[0m09:47:45.828279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e504da4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e505897710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5058966f0>]}
[0m09:47:45.828938 [debug] [MainThread]: Flushing usage events
[0m09:47:47.410240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:47.410238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:23.223047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b07547a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b15e1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b0de1b80>]}


============================== 09:48:23.232649 | fd654063-ccca-4d9d-bd42-8743bf15c5e2 ==============================
[0m09:48:23.232649 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:48:23.233595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:48:23.586349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ae9b8bc0>]}
[0m09:48:23.676088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b02435c0>]}
[0m09:48:23.677216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:48:23.770491 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:48:23.929685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:48:23.930256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:48:23.980247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0aea75490>]}
[0m09:48:24.079244 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:48:24.082541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:48:24.121900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ae7b0470>]}
[0m09:48:24.122701 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:48:24.123445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b0e8ce00>]}
[0m09:48:24.126441 [info ] [MainThread]: 
[0m09:48:24.127211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:24.128251 [info ] [MainThread]: 
[0m09:48:24.130264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:48:24.136673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:48:24.217291 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:48:24.217910 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:48:24.218311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:24.241463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m09:48:24.243580 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:48:24.247065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:48:24.255662 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:48:24.256224 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:48:24.256601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:24.265807 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:48:24.266441 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:48:24.266982 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:48:24.271726 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m09:48:24.273990 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:48:24.274901 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:48:24.284043 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.284616 [debug] [MainThread]: On master: BEGIN
[0m09:48:24.285087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:24.296033 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:48:24.297153 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.298744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:24.305158 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:48:24.309797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b0263410>]}
[0m09:48:24.310573 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:24.311684 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.312162 [debug] [MainThread]: On master: BEGIN
[0m09:48:24.313208 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:48:24.313888 [debug] [MainThread]: On master: COMMIT
[0m09:48:24.314421 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.314913 [debug] [MainThread]: On master: COMMIT
[0m09:48:24.315737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:24.316147 [debug] [MainThread]: On master: Close
[0m09:48:24.321325 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:48:24.322155 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:48:24.323100 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:48:24.324619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:48:24.326547 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:48:24.327987 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:48:24.328798 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:48:24.329972 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:48:24.331907 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:48:24.342806 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.344087 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:48:24.344953 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:48:24.346183 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:48:24.347067 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:48:24.350614 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.369978 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.408186 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:48:24.414702 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.419224 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.422321 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.423289 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:48:24.423970 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:48:24.425109 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.425659 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:48:24.426128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:24.427521 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:48:24.434566 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.435554 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.436175 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:48:24.436810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:48:24.438687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:48:24.439810 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.441480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:48:24.443164 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:48:24.444387 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.445511 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:48:24.450383 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:48:24.451913 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.006 seconds
[0m09:48:24.452917 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.453967 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.009 seconds
[0m09:48:24.464039 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.464855 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:48:24.469196 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.469937 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m09:48:24.471056 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m09:48:24.472660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:24.476247 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.476801 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:48:24.477458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:48:24.478519 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.008 seconds
[0m09:48:24.482557 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.483220 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:48:24.487029 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.487873 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:48:24.500717 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m09:48:24.516405 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:48:24.517765 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.518313 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:48:24.519182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:48:24.522188 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:48:24.523978 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:48:24.526406 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.528252 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m09:48:24.534117 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.535005 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:48:24.543470 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:48:24.544252 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:48:24.551676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:48:24.555280 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:48:24.562823 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:48:24.565305 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:48:24.567963 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:48:24.571208 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:48:24.572394 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:48:24.573751 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.574559 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:48:24.575227 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:48:24.577730 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:48:24.581527 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:48:24.582414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:48:24.583152 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m09:48:24.585526 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:48:24.590877 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:48:24.591796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b21ce2a0>]}
[0m09:48:24.592901 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:48:24.593626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ad9a9ca0>]}
[0m09:48:24.594879 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.26s]
[0m09:48:24.595656 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:48:24.596770 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.27s]
[0m09:48:24.597950 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:48:24.599688 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:48:24.603441 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:48:24.605485 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:48:24.606295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd654063-ccca-4d9d-bd42-8743bf15c5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d09e73a0c0>]}
[0m09:48:24.607096 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.26s]
[0m09:48:24.607908 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:48:24.611865 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.612660 [debug] [MainThread]: On master: BEGIN
[0m09:48:24.613230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:24.623648 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:48:24.624409 [debug] [MainThread]: On master: COMMIT
[0m09:48:24.625060 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:24.625674 [debug] [MainThread]: On master: COMMIT
[0m09:48:24.626695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:24.627713 [debug] [MainThread]: On master: Close
[0m09:48:24.629042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:24.629830 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:48:24.635325 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:48:24.638179 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:48:24.640513 [info ] [MainThread]: 
[0m09:48:24.641223 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m09:48:24.644253 [debug] [MainThread]: Command end result
[0m09:48:24.672272 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:48:24.675000 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:48:24.683572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:48:24.684148 [info ] [MainThread]: 
[0m09:48:24.684678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:48:24.685165 [info ] [MainThread]: 
[0m09:48:24.685636 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:48:24.687829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5316865, "process_in_blocks": "0", "process_kernel_time": 0.448995, "process_mem_max_rss": "108652", "process_out_blocks": "3424", "process_user_time": 3.048059}
[0m09:48:24.689166 [debug] [MainThread]: Command `dbt run` succeeded at 09:48:24.688930 after 1.53 seconds
[0m09:48:24.689679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0b0618380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ae89d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0ae831b80>]}
[0m09:48:24.690198 [debug] [MainThread]: Flushing usage events
[0m09:48:26.120972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:26.094700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7261c1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e72605f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7261c0bf0>]}


============================== 09:51:26.104735 | 551955fe-1f55-43bb-8573-dc439737991c ==============================
[0m09:51:26.104735 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:51:26.096939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb573e5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56b79d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56d85940>]}
[0m09:51:26.105681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}


============================== 09:51:26.106357 | 63b1092d-a12c-4719-b71a-7c334e8bb38e ==============================
[0m09:51:26.106357 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:51:26.107258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:51:26.511386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56ac9b50>]}
[0m09:51:26.515140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e725fcbad0>]}
[0m09:51:26.661069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb5676b5c0>]}
[0m09:51:26.662368 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:26.665112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7244ec7d0>]}
[0m09:51:26.666521 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:26.787605 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:51:26.801325 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:51:26.930173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:26.930969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:26.945158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:26.945698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:26.979106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7245c4800>]}
[0m09:51:26.995822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb54f85760>]}
[0m09:51:27.087353 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:51:27.090391 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:51:27.102099 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:51:27.124183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e724367230>]}
[0m09:51:27.124916 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:51:27.125450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e72457d490>]}
[0m09:51:27.128217 [info ] [MainThread]: 
[0m09:51:27.129009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:51:27.130054 [info ] [MainThread]: 
[0m09:51:27.131395 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:51:27.132688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:27.140360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:51:27.172973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb54d36ab0>]}
[0m09:51:27.173682 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:51:27.174239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb54cb8fb0>]}
[0m09:51:27.177882 [info ] [MainThread]: 
[0m09:51:27.178767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:51:27.179470 [info ] [MainThread]: 
[0m09:51:27.180518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:27.188852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:51:27.205200 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:51:27.205872 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:51:27.206321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:27.223935 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m09:51:27.226020 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:51:27.229617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:51:27.241126 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:51:27.244838 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:51:27.245591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:27.258783 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:51:27.260245 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:51:27.261560 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:51:27.264565 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:51:27.265596 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:51:27.266504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:27.268663 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:51:27.271883 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:51:27.273502 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:51:27.286800 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.287463 [debug] [MainThread]: On master: BEGIN
[0m09:51:27.287979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:27.288826 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m09:51:27.290761 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:51:27.294042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:51:27.301526 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:51:27.302509 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.303910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:27.305345 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:51:27.306118 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:51:27.306741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:27.321549 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m09:51:27.323066 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:51:27.323590 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:51:27.323546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7242154c0>]}
[0m09:51:27.324097 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:51:27.324213 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:27.325346 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.326106 [debug] [MainThread]: On master: BEGIN
[0m09:51:27.327576 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:51:27.328103 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.328443 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.328838 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.329749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:27.330010 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:51:27.330498 [debug] [MainThread]: On master: Close
[0m09:51:27.332913 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:51:27.334841 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:51:27.342137 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.343447 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.345901 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.352354 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.348468 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:51:27.354091 [debug] [MainThread]: On master: BEGIN
[0m09:51:27.354950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:27.351271 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:51:27.353114 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:51:27.354606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:51:27.356178 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:51:27.357578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:51:27.359253 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.370878 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:51:27.372174 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.373379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:27.360569 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.380419 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m09:51:27.361780 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.384450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56d86960>]}
[0m09:51:27.385593 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:27.387819 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.389530 [debug] [MainThread]: On master: BEGIN
[0m09:51:27.376410 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.391656 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:51:27.392578 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.393302 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.393990 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.382853 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.395773 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:51:27.393404 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.396695 [debug] [MainThread]: On master: Close
[0m09:51:27.398295 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.408650 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.410173 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:51:27.411983 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.418487 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.413296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:51:27.414764 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.417549 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:51:27.420333 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.421715 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:51:27.424261 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:51:27.438234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:51:27.439616 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.441014 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.442714 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.420712 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.450919 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.456430 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.458732 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.474020 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.497386 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.546662 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.547959 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.550441 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.551980 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.552935 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.554052 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:51:27.555111 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:51:27.556112 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.556947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:51:27.557841 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:51:27.558648 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:51:27.560395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:27.570424 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m09:51:27.571660 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.572873 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:51:27.574824 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m09:51:27.575730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:51:27.576364 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.577109 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.578261 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:51:27.579220 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:51:27.581612 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:51:27.582702 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.590415 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.591879 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.012 seconds
[0m09:51:27.591799 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.594057 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.595217 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.598700 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.018 seconds
[0m09:51:27.596724 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:51:27.598219 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.598801 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:51:27.600012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:27.601385 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:51:27.602484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:51:27.603757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:51:27.603129 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.607254 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.617451 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.620486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:51:27.619712 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:51:27.621209 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:51:27.622097 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m09:51:27.622456 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:51:27.623177 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.625877 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:51:27.624547 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.626483 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:51:27.630604 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m09:51:27.632584 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:51:27.634520 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.627584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:51:27.640952 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:51:27.629102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:51:27.787627 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:51:27.789086 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:51:27.794459 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:51:27.795473 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.796253 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.796841 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.797710 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:51:27.798825 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:51:27.800296 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:51:27.814805 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:51:27.820313 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.182 seconds
[0m09:51:27.825335 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m09:51:27.823023 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.188 seconds
[0m09:51:27.828084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m09:51:27.863702 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.219 seconds
[0m09:51:27.889490 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:51:27.894408 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.897171 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.906981 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.907905 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:51:27.908650 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:51:27.909697 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:51:27.887445 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:51:27.896439 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:51:27.913116 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_segmentation" already exists

[0m09:51:27.912138 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:51:27.914129 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "daily_revenue" already exists

[0m09:51:27.913748 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:51:27.915259 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "top_selling_products" already exists

[0m09:51:27.915901 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:51:27.917097 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:51:27.918147 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:51:27.916559 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: ROLLBACK
[0m09:51:27.917725 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: ROLLBACK
[0m09:51:27.919027 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:51:27.919129 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: ROLLBACK
[0m09:51:27.920783 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:51:27.921221 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:51:27.922870 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:51:27.925739 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:51:27.924683 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m09:51:27.927234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:51:27.926649 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m09:51:27.927696 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m09:51:27.928813 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:51:27.930289 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m09:51:27.928478 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:51:27.932150 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:51:27.934265 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:51:27.932119 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:51:27.939484 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:51:27.940544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7245c4920>]}
[0m09:51:27.942306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e720307f80>]}
[0m09:51:27.944281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551955fe-1f55-43bb-8573-dc439737991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e720308860>]}
[0m09:51:27.946063 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.58s]
[0m09:51:27.948159 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.59s]
[0m09:51:27.949858 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.59s]
[0m09:51:27.951239 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:51:27.953917 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.955338 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:51:27.963472 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.964794 [debug] [MainThread]: On master: BEGIN
[0m09:51:27.965424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:27.970118 [debug] [Thread-1 (]: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:51:27.976502 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:51:27.977196 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.977093 [debug] [Thread-2 (]: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:51:27.977805 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:27.978221 [debug] [MainThread]: On master: COMMIT
[0m09:51:27.978563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb4fe4b4a0>]}
[0m09:51:27.979138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:27.980149 [debug] [MainThread]: On master: Close
[0m09:51:27.981930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:27.982860 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:51:27.984275 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:51:27.985394 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:51:27.986853 [info ] [MainThread]: 
[0m09:51:27.990699 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m09:51:27.979783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb4feb7980>]}
[0m09:51:27.994879 [debug] [MainThread]: Command end result
[0m09:51:27.982354 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.customer_segmentation ................ [[31mERROR[0m in 0.56s]
[0m09:51:27.991418 [debug] [Thread-3 (]: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:51:27.994313 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.daily_revenue ........................ [[31mERROR[0m in 0.55s]
[0m09:51:27.997441 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:51:27.998913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1092d-a12c-4719-b71a-7c334e8bb38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb4cd0bbc0>]}
[0m09:51:27.999843 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:51:28.001275 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.customer_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql.
[0m09:51:28.002562 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model dev.top_selling_products ................. [[31mERROR[0m in 0.56s]
[0m09:51:28.005249 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.daily_revenue' to be skipped because of status 'error'.  Reason: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql.
[0m09:51:28.006294 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:51:28.008998 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.top_selling_products' to be skipped because of status 'error'.  Reason: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql.
[0m09:51:28.016618 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:28.017752 [debug] [MainThread]: On master: BEGIN
[0m09:51:28.018417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:28.037020 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:51:28.038244 [debug] [MainThread]: On master: COMMIT
[0m09:51:28.039444 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:28.040439 [debug] [MainThread]: On master: COMMIT
[0m09:51:28.041952 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:51:28.042710 [debug] [MainThread]: On master: Close
[0m09:51:28.044370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:28.045303 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:51:28.045871 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:51:28.046800 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:51:28.048334 [info ] [MainThread]: 
[0m09:51:28.050726 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:51:28.049663 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m09:51:28.055139 [debug] [MainThread]: Command end result
[0m09:51:28.055875 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:51:28.078213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:51:28.079014 [info ] [MainThread]: 
[0m09:51:28.080147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:28.081221 [info ] [MainThread]: 
[0m09:51:28.084145 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:51:28.087742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0824773, "process_in_blocks": "0", "process_kernel_time": 0.537982, "process_mem_max_rss": "109152", "process_out_blocks": "3456", "process_user_time": 3.506033}
[0m09:51:28.088894 [debug] [MainThread]: Command `dbt run` succeeded at 09:51:28.088660 after 2.08 seconds
[0m09:51:28.089748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e726797140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e725ea3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e725debad0>]}
[0m09:51:28.090455 [debug] [MainThread]: Flushing usage events
[0m09:51:28.116371 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:51:28.120317 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:51:28.132701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:51:28.133234 [info ] [MainThread]: 
[0m09:51:28.134348 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:51:28.136018 [info ] [MainThread]: 
[0m09:51:28.137255 [error] [MainThread]:   Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m09:51:28.138774 [info ] [MainThread]: 
[0m09:51:28.139939 [error] [MainThread]:   Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m09:51:28.140692 [info ] [MainThread]: 
[0m09:51:28.141545 [error] [MainThread]:   Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m09:51:28.142685 [info ] [MainThread]: 
[0m09:51:28.143514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m09:51:28.145564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1386757, "process_in_blocks": "0", "process_kernel_time": 0.559787, "process_mem_max_rss": "109280", "process_out_blocks": "3408", "process_user_time": 3.410627}
[0m09:51:28.146546 [debug] [MainThread]: Command `dbt run` failed at 09:51:28.146334 after 2.14 seconds
[0m09:51:28.147148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56a83cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb56be9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb567b33e0>]}
[0m09:51:28.147756 [debug] [MainThread]: Flushing usage events
[0m09:51:29.694904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:29.694860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:05.510502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a6b5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a3a3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29adb0cb0>]}


============================== 09:52:05.521393 | 7f3fd374-ff89-495d-89cd-de44344e2936 ==============================
[0m09:52:05.521393 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:52:05.522318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:05.883993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a8bbfb0>]}
[0m09:52:05.995705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29b06a5d0>]}
[0m09:52:05.997540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:06.100649 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:52:06.261413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:06.261994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:06.331357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc298867800>]}
[0m09:52:06.446178 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:52:06.449673 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:52:06.483371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc298611e80>]}
[0m09:52:06.484214 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m09:52:06.485526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29aa72f30>]}
[0m09:52:06.489940 [info ] [MainThread]: 
[0m09:52:06.490825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:06.491538 [info ] [MainThread]: 
[0m09:52:06.492876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:06.501722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m09:52:06.565687 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m09:52:06.566414 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m09:52:06.566980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:06.590893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m09:52:06.593008 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m09:52:06.597495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m09:52:06.606327 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:52:06.606872 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m09:52:06.607229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:06.617232 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:52:06.617853 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m09:52:06.618327 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:52:06.624950 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m09:52:06.627499 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m09:52:06.628626 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m09:52:06.639789 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.640465 [debug] [MainThread]: On master: BEGIN
[0m09:52:06.640861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:06.652892 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:52:06.653476 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.654165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:06.659005 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:52:06.661067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc298886870>]}
[0m09:52:06.661723 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:06.662840 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.663344 [debug] [MainThread]: On master: BEGIN
[0m09:52:06.664965 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:52:06.665474 [debug] [MainThread]: On master: COMMIT
[0m09:52:06.666047 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.666579 [debug] [MainThread]: On master: COMMIT
[0m09:52:06.668108 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:52:06.668816 [debug] [MainThread]: On master: Close
[0m09:52:06.675423 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m09:52:06.676062 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m09:52:06.676793 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m09:52:06.677509 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m09:52:06.678858 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m09:52:06.680077 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m09:52:06.680995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m09:52:06.681782 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m09:52:06.682713 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m09:52:06.683636 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m09:52:06.684751 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m09:52:06.685533 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m09:52:06.700049 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.704303 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.713288 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.716768 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m09:52:06.718453 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m09:52:06.759899 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m09:52:06.809111 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.813629 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.815401 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.818689 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.820015 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m09:52:06.820844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:06.822506 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.823361 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m09:52:06.823950 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:06.824842 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.825504 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m09:52:06.826072 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:06.836029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:52:06.837000 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:52:06.838189 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.839420 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.840160 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m09:52:06.840865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:52:06.841604 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m09:52:06.842813 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.843654 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m09:52:06.846617 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.004 seconds
[0m09:52:06.854795 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.010 seconds
[0m09:52:06.856274 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.013 seconds
[0m09:52:06.860085 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.864036 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.867768 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.868637 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m09:52:06.869388 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m09:52:06.870241 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m09:52:06.872321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:06.872942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:06.876736 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.877377 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:52:06.881204 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.882022 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m09:52:06.885479 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.886439 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m09:52:06.887555 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m09:52:06.888727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:06.896067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:52:06.902866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m09:52:06.946078 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:52:06.947248 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:52:06.951347 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:52:06.952035 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.952963 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.953716 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.954646 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m09:52:06.955428 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m09:52:06.956296 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m09:52:06.961069 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:52:06.969544 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m09:52:06.970328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:52:06.972492 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m09:52:06.976309 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m09:52:06.981667 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m09:52:06.990953 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m09:52:06.992017 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m09:52:06.993105 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m09:52:06.993886 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m09:52:06.994534 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m09:52:06.995253 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m09:52:07.000786 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:52:07.004467 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m09:52:07.005396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:52:07.006191 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:52:07.009292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29c01e4b0>]}
[0m09:52:07.011214 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m09:52:07.013115 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m09:52:07.014001 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.32s]
[0m09:52:07.015234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc2988963f0>]}
[0m09:52:07.016103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3fd374-ff89-495d-89cd-de44344e2936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29463bfe0>]}
[0m09:52:07.017819 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m09:52:07.019117 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.33s]
[0m09:52:07.020317 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.33s]
[0m09:52:07.021878 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m09:52:07.022895 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m09:52:07.026372 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:07.027132 [debug] [MainThread]: On master: BEGIN
[0m09:52:07.027545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:07.037069 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:52:07.037810 [debug] [MainThread]: On master: COMMIT
[0m09:52:07.038409 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:07.038955 [debug] [MainThread]: On master: COMMIT
[0m09:52:07.039858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:07.040349 [debug] [MainThread]: On master: Close
[0m09:52:07.040950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:07.041334 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m09:52:07.041656 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m09:52:07.042060 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m09:52:07.042560 [info ] [MainThread]: 
[0m09:52:07.043218 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m09:52:07.045077 [debug] [MainThread]: Command end result
[0m09:52:07.079853 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:52:07.082215 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:52:07.092587 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:52:07.093182 [info ] [MainThread]: 
[0m09:52:07.093784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:07.094489 [info ] [MainThread]: 
[0m09:52:07.095602 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:52:07.097189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6725246, "process_in_blocks": "0", "process_kernel_time": 0.589427, "process_mem_max_rss": "108824", "process_out_blocks": "3424", "process_user_time": 3.303705}
[0m09:52:07.097921 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:07.097749 after 1.67 seconds
[0m09:52:07.098401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a706330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a128170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc29a128260>]}
[0m09:52:07.098986 [debug] [MainThread]: Flushing usage events
[0m09:52:08.765511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:47.683949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e33144e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e3312b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e331338a70>]}


============================== 21:37:47.694241 | eda466c1-4757-45aa-b302-4c05e568b4c0 ==============================
[0m21:37:47.694241 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:37:47.679225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb616e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb6393b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb613bb00>]}


============================== 21:37:47.695669 | 1dac8253-876f-43c6-b2d2-66fde58f9f49 ==============================
[0m21:37:47.695669 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:37:47.695798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:47.696465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:37:48.222186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb5b882f0>]}
[0m21:37:48.222581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e330fa2660>]}
[0m21:37:48.349053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb63f7530>]}
[0m21:37:48.353006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e33128cbf0>]}
[0m21:37:48.354440 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:37:48.355504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:37:48.496290 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:37:48.499082 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:37:48.763375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:48.764116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:48.764516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:48.765205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:48.844696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb43bd550>]}
[0m21:37:48.860604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e32f684890>]}
[0m21:37:48.981804 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:37:48.986506 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:37:49.009986 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:37:49.013237 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:37:49.063067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e32f457e60>]}
[0m21:37:49.063328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb413e540>]}
[0m21:37:49.064311 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m21:37:49.064498 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m21:37:49.064916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e330fa2f30>]}
[0m21:37:49.065290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb407f7d0>]}
[0m21:37:49.068834 [info ] [MainThread]: 
[0m21:37:49.068824 [info ] [MainThread]: 
[0m21:37:49.069626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:49.070092 [info ] [MainThread]: 
[0m21:37:49.069797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:49.071022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:49.071100 [info ] [MainThread]: 
[0m21:37:49.072173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:49.080382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m21:37:49.080395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m21:37:49.181360 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m21:37:49.182190 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m21:37:49.182932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:49.183659 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m21:37:49.187498 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m21:37:49.190332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:49.226222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m21:37:49.228621 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m21:37:49.228794 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m21:37:49.231811 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m21:37:49.233112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m21:37:49.236111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m21:37:49.244051 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:37:49.244962 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m21:37:49.245569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:49.254426 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:37:49.255449 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m21:37:49.256304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:49.264021 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:37:49.265534 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:37:49.266697 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m21:37:49.273729 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m21:37:49.274066 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:37:49.275226 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:37:49.276430 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m21:37:49.278030 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m21:37:49.279677 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m21:37:49.286379 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m21:37:49.289407 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m21:37:49.290854 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m21:37:49.296065 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.296896 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.297542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:49.304467 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.305323 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.306020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:49.313888 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m21:37:49.315436 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.316780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:37:49.322194 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m21:37:49.323183 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.323444 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m21:37:49.324090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:37:49.326786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb3345b80>]}
[0m21:37:49.329484 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:49.332234 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.333129 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.333364 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m21:37:49.335115 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:37:49.335969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e330e97650>]}
[0m21:37:49.336255 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.336883 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:49.337412 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.337989 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.338165 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.338634 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.339103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:49.339928 [debug] [MainThread]: On master: Close
[0m21:37:49.340277 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:37:49.341338 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.342363 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.343066 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.344277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:49.346650 [debug] [MainThread]: On master: Close
[0m21:37:49.347588 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.348780 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.350362 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.351724 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m21:37:49.353808 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.353116 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m21:37:49.355286 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m21:37:49.355047 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.357500 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.356440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m21:37:49.357880 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m21:37:49.356464 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m21:37:49.359128 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m21:37:49.359089 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m21:37:49.360190 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.360301 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m21:37:49.361740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m21:37:49.363126 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m21:37:49.364793 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m21:37:49.366523 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.361155 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.367583 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.362311 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.373886 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.378774 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.368612 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.387471 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.390350 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.384292 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.388328 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.393880 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.395776 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.402485 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.403561 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.452813 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.454261 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.460064 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.460993 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.470033 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.471338 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.472611 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.474771 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m21:37:49.476195 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.476795 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m21:37:49.477480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:49.478090 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m21:37:49.479093 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:37:49.481023 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:49.492982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:37:49.494181 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.496002 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m21:37:49.498014 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m21:37:49.498994 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m21:37:49.500393 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.501469 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.502274 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m21:37:49.502904 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m21:37:49.509998 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.010 seconds
[0m21:37:49.518236 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.014 seconds
[0m21:37:49.523510 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.533829 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m21:37:49.525206 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.021 seconds
[0m21:37:49.540464 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.551541 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.552298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:37:49.553060 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m21:37:49.553989 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m21:37:49.572940 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.571958 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.580490 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.583251 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.584678 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m21:37:49.586725 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.587318 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.587886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:37:49.588648 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m21:37:49.589273 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m21:37:49.590689 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:49.591957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:49.577832 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:37:49.599926 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m21:37:49.600840 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.601709 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m21:37:49.606123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:37:49.601644 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m21:37:49.602965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m21:37:49.607351 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.606839 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m21:37:49.607916 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.609867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m21:37:49.611041 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m21:37:49.612368 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m21:37:49.613720 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.612482 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.615483 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m21:37:49.613277 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m21:37:49.614538 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.616685 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m21:37:49.618995 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m21:37:49.621559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:37:49.623752 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.009 seconds
[0m21:37:49.629718 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m21:37:49.633822 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.031 seconds
[0m21:37:49.630890 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m21:37:49.634790 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m21:37:49.635104 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.018 seconds
[0m21:37:49.644250 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.638932 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m21:37:49.647538 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.654578 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.655581 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m21:37:49.657171 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m21:37:49.658337 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m21:37:49.643213 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m21:37:49.657744 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:37:49.659418 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:37:49.661801 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customer_segmentation" already exists

[0m21:37:49.660822 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:37:49.662624 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "top_selling_products" already exists

[0m21:37:49.661940 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m21:37:49.663326 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m21:37:49.664679 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m21:37:49.663983 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "daily_revenue" already exists

[0m21:37:49.664840 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: ROLLBACK
[0m21:37:49.665922 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: ROLLBACK
[0m21:37:49.667149 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: ROLLBACK
[0m21:37:49.666756 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:37:49.668727 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m21:37:49.669892 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m21:37:49.670630 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m21:37:49.667801 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:37:49.671496 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m21:37:49.672643 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m21:37:49.668892 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:37:49.673743 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m21:37:49.674730 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m21:37:49.673199 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m21:37:49.675617 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m21:37:49.676005 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m21:37:49.677584 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m21:37:49.677832 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m21:37:49.684226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e32e5b9f70>]}
[0m21:37:49.685315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e32f6677d0>]}
[0m21:37:49.687090 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda466c1-4757-45aa-b302-4c05e568b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e32e5d6480>]}
[0m21:37:49.689156 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.32s]
[0m21:37:49.690845 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.32s]
[0m21:37:49.692050 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.32s]
[0m21:37:49.693287 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.694343 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.695259 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.700443 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.701052 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.701694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:49.714338 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:37:49.715146 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.716216 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.717206 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.718798 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:37:49.719468 [debug] [MainThread]: On master: Close
[0m21:37:49.720507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:49.721824 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m21:37:49.722702 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m21:37:49.723333 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m21:37:49.724277 [info ] [MainThread]: 
[0m21:37:49.725802 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m21:37:49.729085 [debug] [MainThread]: Command end result
[0m21:37:49.726634 [debug] [Thread-3 (]: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m21:37:49.731096 [debug] [Thread-2 (]: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m21:37:49.732277 [debug] [Thread-1 (]: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m21:37:49.738123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb670dee0>]}
[0m21:37:49.740125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb0158da0>]}
[0m21:37:49.741656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dac8253-876f-43c6-b2d2-66fde58f9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb32f6810>]}
[0m21:37:49.743068 [error] [Thread-3 (]: 3 of 3 ERROR creating sql table model dev.top_selling_products ................. [[31mERROR[0m in 0.37s]
[0m21:37:49.748437 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m21:37:49.744763 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.daily_revenue ........................ [[31mERROR[0m in 0.38s]
[0m21:37:49.751326 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.top_selling_products' to be skipped because of status 'error'.  Reason: Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql.
[0m21:37:49.746673 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.customer_segmentation ................ [[31mERROR[0m in 0.39s]
[0m21:37:49.754211 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m21:37:49.757030 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m21:37:49.758141 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.daily_revenue' to be skipped because of status 'error'.  Reason: Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql.
[0m21:37:49.759279 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_pipeline.customer_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql.
[0m21:37:49.762864 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.763623 [debug] [MainThread]: On master: BEGIN
[0m21:37:49.764175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:49.772936 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:37:49.776408 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:37:49.777710 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:37:49.778568 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.779312 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:49.779806 [debug] [MainThread]: On master: COMMIT
[0m21:37:49.780703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:49.781250 [debug] [MainThread]: On master: Close
[0m21:37:49.782128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:49.782579 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m21:37:49.783034 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m21:37:49.783411 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m21:37:49.784108 [info ] [MainThread]: 
[0m21:37:49.784971 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m21:37:49.790396 [debug] [MainThread]: Command end result
[0m21:37:49.791897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:37:49.792597 [info ] [MainThread]: 
[0m21:37:49.793440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:37:49.794230 [info ] [MainThread]: 
[0m21:37:49.795196 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:37:49.799832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2222176, "process_in_blocks": "58320", "process_kernel_time": 0.950846, "process_mem_max_rss": "107200", "process_out_blocks": "3424", "process_user_time": 4.031737}
[0m21:37:49.801327 [debug] [MainThread]: Command `dbt run` succeeded at 21:37:49.800963 after 2.22 seconds
[0m21:37:49.802496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e3313c6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e332e1e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e330f294f0>]}
[0m21:37:49.803636 [debug] [MainThread]: Flushing usage events
[0m21:37:49.831084 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:37:49.834610 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:37:49.848254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:37:49.848895 [info ] [MainThread]: 
[0m21:37:49.849551 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:37:49.850111 [info ] [MainThread]: 
[0m21:37:49.850745 [error] [MainThread]:   Database Error in model top_selling_products (models/marts/top_selling_products.sql)
  relation "top_selling_products" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/top_selling_products.sql
[0m21:37:49.852070 [info ] [MainThread]: 
[0m21:37:49.853900 [error] [MainThread]:   Database Error in model daily_revenue (models/marts/daily_revenue.sql)
  relation "daily_revenue" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/daily_revenue.sql
[0m21:37:49.855364 [info ] [MainThread]: 
[0m21:37:49.856765 [error] [MainThread]:   Database Error in model customer_segmentation (models/marts/customer_segmentation.sql)
  relation "customer_segmentation" already exists
  compiled code at target/run/ecommerce_pipeline/models/marts/customer_segmentation.sql
[0m21:37:49.858936 [info ] [MainThread]: 
[0m21:37:49.860203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:37:49.862313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.286906, "process_in_blocks": "55824", "process_kernel_time": 0.910016, "process_mem_max_rss": "108252", "process_out_blocks": "3416", "process_user_time": 4.12744}
[0m21:37:49.863525 [debug] [MainThread]: Command `dbt run` failed at 21:37:49.863254 after 2.29 seconds
[0m21:37:49.864309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb6324c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb670dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffb613bb00>]}
[0m21:37:49.864950 [debug] [MainThread]: Flushing usage events
[0m21:37:51.518209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:51.545512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:27.150915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b22c38c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b221e1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b2222bcb0>]}


============================== 21:38:27.161970 | 09d41a17-f1d1-4537-8a4b-12ae9e2788f2 ==============================
[0m21:38:27.161970 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:38:27.162971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:27.007724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b21f1ce00>]}
[0m21:38:27.221793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b237d0260>]}
[0m21:38:27.226724 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:38:27.396781 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:38:27.580768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:38:27.581324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:38:27.640304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b20749190>]}
[0m21:38:27.781634 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:38:27.785201 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:38:27.829554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b20657980>]}
[0m21:38:27.830381 [info ] [MainThread]: Found 3 models, 4 sources, 429 macros
[0m21:38:27.830980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b203db770>]}
[0m21:38:27.833677 [info ] [MainThread]: 
[0m21:38:27.834478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:38:27.835131 [info ] [MainThread]: 
[0m21:38:27.836561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:27.845823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_db'
[0m21:38:27.899883 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db"
[0m21:38:27.900494 [debug] [ThreadPool]: On list_ecommerce_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db"} */

    select distinct nspname from pg_namespace
  
[0m21:38:27.900987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:27.912568 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m21:38:27.914574 [debug] [ThreadPool]: On list_ecommerce_db: Close
[0m21:38:27.917775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_dev)
[0m21:38:27.927462 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:38:27.928348 [debug] [ThreadPool]: On list_ecommerce_db_dev: BEGIN
[0m21:38:27.928936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:27.942091 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:38:27.943140 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_db_dev"
[0m21:38:27.944101 [debug] [ThreadPool]: On list_ecommerce_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "list_ecommerce_db_dev"} */
select
      'ecommerce_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'ecommerce_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m21:38:27.949219 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m21:38:27.951284 [debug] [ThreadPool]: On list_ecommerce_db_dev: ROLLBACK
[0m21:38:27.952296 [debug] [ThreadPool]: On list_ecommerce_db_dev: Close
[0m21:38:27.962978 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:27.963599 [debug] [MainThread]: On master: BEGIN
[0m21:38:27.964056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:27.977298 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:38:27.978022 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:27.978761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:38:27.989485 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m21:38:27.991765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b23d604a0>]}
[0m21:38:27.992456 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:27.993340 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:27.993762 [debug] [MainThread]: On master: BEGIN
[0m21:38:27.995096 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:38:27.995594 [debug] [MainThread]: On master: COMMIT
[0m21:38:27.995995 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:27.996332 [debug] [MainThread]: On master: COMMIT
[0m21:38:27.997174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:27.998413 [debug] [MainThread]: On master: Close
[0m21:38:28.005592 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.customer_segmentation
[0m21:38:28.006427 [debug] [Thread-2 (]: Began running node model.ecommerce_pipeline.daily_revenue
[0m21:38:28.007568 [debug] [Thread-3 (]: Began running node model.ecommerce_pipeline.top_selling_products
[0m21:38:28.008821 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.customer_segmentation ......................... [RUN]
[0m21:38:28.010790 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.daily_revenue ................................. [RUN]
[0m21:38:28.012132 [info ] [Thread-3 (]: 3 of 3 START sql table model dev.top_selling_products .......................... [RUN]
[0m21:38:28.013346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_dev, now model.ecommerce_pipeline.customer_segmentation)
[0m21:38:28.014509 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.daily_revenue'
[0m21:38:28.015744 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_pipeline.top_selling_products'
[0m21:38:28.016578 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.customer_segmentation
[0m21:38:28.017297 [debug] [Thread-2 (]: Began compiling node model.ecommerce_pipeline.daily_revenue
[0m21:38:28.017985 [debug] [Thread-3 (]: Began compiling node model.ecommerce_pipeline.top_selling_products
[0m21:38:28.028517 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.033110 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.037370 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.039543 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.customer_segmentation
[0m21:38:28.040968 [debug] [Thread-2 (]: Began executing node model.ecommerce_pipeline.daily_revenue
[0m21:38:28.048252 [debug] [Thread-3 (]: Began executing node model.ecommerce_pipeline.top_selling_products
[0m21:38:28.154936 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.159551 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.162258 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.165314 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.167350 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.168454 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: BEGIN
[0m21:38:28.169878 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: BEGIN
[0m21:38:28.170975 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.172160 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:38:28.172965 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:38:28.173668 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: BEGIN
[0m21:38:28.175599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:28.187944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m21:38:28.189300 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.191244 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */

  
    

  create  table "ecommerce_db"."dev"."top_selling_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    p.id as product_id, 
    p.title as product_name, 
    p.category as product_category, 
    p.rating as avg_product_rating, 
    SUM(o.total_amount) as total_revenue 
FROM 
    "ecommerce_db"."dev"."raw_products" p 
JOIN 
    "ecommerce_db"."dev"."raw_orders" o 
ON 
    p.id = o.product_id 
GROUP BY p.id
ORDER BY total_revenue DESC
  );
  
[0m21:38:28.193608 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m21:38:28.195284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m21:38:28.196657 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.197989 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.199490 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */

  
    

  create  table "ecommerce_db"."dev"."daily_revenue__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    order_date, 
    SUM(total_amount) as daily_revenue 
FROM "ecommerce_db"."dev"."raw_orders" 
GROUP BY order_date 
ORDER BY order_date ASC
  );
  
[0m21:38:28.201141 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */

  
    

  create  table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.id, 
    c.firstname, 
    c.lastname, 
    c.email, 
    c.phone, 
    COUNT(*) as total_orders, 
    CASE 
        WHEN COUNT(*) > 1 THEN 1 
        ELSE 0 
    END AS is_returning_customer 
FROM "ecommerce_db"."dev"."raw_customers" c 
JOIN "ecommerce_db"."dev"."raw_orders" o 
ON c.id = o.customer_id 
GROUP BY c.id
  );
  
[0m21:38:28.203707 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.010 seconds
[0m21:38:28.217449 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.012 seconds
[0m21:38:28.218991 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.013 seconds
[0m21:38:28.241076 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.245379 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.252302 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.253150 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m21:38:28.254833 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue" rename to "daily_revenue__dbt_backup"
[0m21:38:28.256878 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation" rename to "customer_segmentation__dbt_backup"
[0m21:38:28.260312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:38:28.261758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:38:28.265522 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.266195 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m21:38:28.269762 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.270983 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
alter table "ecommerce_db"."dev"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m21:38:28.276257 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.277417 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
alter table "ecommerce_db"."dev"."customer_segmentation__dbt_tmp" rename to "customer_segmentation"
[0m21:38:28.279240 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
alter table "ecommerce_db"."dev"."daily_revenue__dbt_tmp" rename to "daily_revenue"
[0m21:38:28.280646 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:38:28.282778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:38:28.290432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:38:28.354367 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m21:38:28.357423 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m21:38:28.363000 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m21:38:28.365711 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.367668 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.369072 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.370687 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: COMMIT
[0m21:38:28.371414 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: COMMIT
[0m21:38:28.371979 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: COMMIT
[0m21:38:28.388117 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m21:38:28.398452 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m21:38:28.401582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m21:38:28.440916 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_db"."dev"."daily_revenue__dbt_backup"
[0m21:38:28.441826 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_db"."dev"."top_selling_products__dbt_backup"
[0m21:38:28.445474 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_db"."dev"."customer_segmentation__dbt_backup"
[0m21:38:28.462838 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_pipeline.top_selling_products"
[0m21:38:28.463889 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_pipeline.daily_revenue"
[0m21:38:28.465822 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_pipeline.customer_segmentation"
[0m21:38:28.467019 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.top_selling_products"} */
drop table if exists "ecommerce_db"."dev"."top_selling_products__dbt_backup" cascade
[0m21:38:28.467803 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.daily_revenue"} */
drop table if exists "ecommerce_db"."dev"."daily_revenue__dbt_backup" cascade
[0m21:38:28.468957 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.customer_segmentation"} */
drop table if exists "ecommerce_db"."dev"."customer_segmentation__dbt_backup" cascade
[0m21:38:28.475507 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m21:38:28.480414 [debug] [Thread-2 (]: On model.ecommerce_pipeline.daily_revenue: Close
[0m21:38:28.481500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m21:38:28.482611 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m21:38:28.487524 [debug] [Thread-1 (]: On model.ecommerce_pipeline.customer_segmentation: Close
[0m21:38:28.490212 [debug] [Thread-3 (]: On model.ecommerce_pipeline.top_selling_products: Close
[0m21:38:28.490862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b1c51ed50>]}
[0m21:38:28.492401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b1c4e7110>]}
[0m21:38:28.494193 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d41a17-f1d1-4537-8a4b-12ae9e2788f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b1c4e7920>]}
[0m21:38:28.498569 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.daily_revenue ............................ [[32mSELECT 13[0m in 0.47s]
[0m21:38:28.503891 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.customer_segmentation .................... [[32mSELECT 17[0m in 0.48s]
[0m21:38:28.508483 [info ] [Thread-3 (]: 3 of 3 OK created sql table model dev.top_selling_products ..................... [[32mSELECT 11[0m in 0.48s]
[0m21:38:28.512074 [debug] [Thread-2 (]: Finished running node model.ecommerce_pipeline.daily_revenue
[0m21:38:28.516066 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.customer_segmentation
[0m21:38:28.517573 [debug] [Thread-3 (]: Finished running node model.ecommerce_pipeline.top_selling_products
[0m21:38:28.527696 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:28.529222 [debug] [MainThread]: On master: BEGIN
[0m21:38:28.530984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:28.540835 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:38:28.541447 [debug] [MainThread]: On master: COMMIT
[0m21:38:28.541956 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:28.542431 [debug] [MainThread]: On master: COMMIT
[0m21:38:28.543353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:28.543752 [debug] [MainThread]: On master: Close
[0m21:38:28.544353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:28.544735 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.customer_segmentation' was properly closed.
[0m21:38:28.545211 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.daily_revenue' was properly closed.
[0m21:38:28.545563 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.top_selling_products' was properly closed.
[0m21:38:28.546164 [info ] [MainThread]: 
[0m21:38:28.546650 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m21:38:28.548896 [debug] [MainThread]: Command end result
[0m21:38:28.591579 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:38:28.593993 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:38:28.602858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:38:28.603346 [info ] [MainThread]: 
[0m21:38:28.603843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:38:28.604237 [info ] [MainThread]: 
[0m21:38:28.604794 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:38:28.607096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1134543, "process_in_blocks": "0", "process_kernel_time": 0.511532, "process_mem_max_rss": "109064", "process_out_blocks": "3424", "process_user_time": 4.260228}
[0m21:38:28.608693 [debug] [MainThread]: Command `dbt run` succeeded at 21:38:28.608390 after 2.12 seconds
[0m21:38:28.609544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b22c38c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b22c38080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3b22c3b650>]}
[0m21:38:28.610078 [debug] [MainThread]: Flushing usage events
[0m21:38:30.182680 [debug] [MainThread]: An error was encountered while trying to flush usage events
