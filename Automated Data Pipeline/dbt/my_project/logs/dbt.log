[0m11:32:53.766277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71957eeef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7195809447d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719581757ef0>]}


============================== 11:32:53.774261 | 7f6b2993-5809-48aa-b2b8-9dfe7ca620bf ==============================
[0m11:32:53.774261 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:32:53.775082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:53.833517 [info ] [MainThread]: dbt version: 1.9.0
[0m11:32:53.834218 [info ] [MainThread]: python version: 3.12.4
[0m11:32:53.834787 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:32:53.835377 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:32:53.836059 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:32:53.836683 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:32:53.837295 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:32:53.969231 [info ] [MainThread]: Configuration:
[0m11:32:53.969807 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:32:53.970365 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:32:53.970994 [info ] [MainThread]: Required dependencies:
[0m11:32:53.971665 [debug] [MainThread]: Executing "git --help"
[0m11:32:53.975388 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:32:53.975920 [debug] [MainThread]: STDERR: "b''"
[0m11:32:53.976401 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:32:53.976852 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:32:53.977654 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:32:53.978490 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:32:53.980513 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2844048, "process_in_blocks": "0", "process_kernel_time": 0.400786, "process_mem_max_rss": "88924", "process_out_blocks": "1480", "process_user_time": 1.952345}
[0m11:32:53.981572 [debug] [MainThread]: Command `dbt debug` failed at 11:32:53.981387 after 0.29 seconds
[0m11:32:53.982438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71957f1e98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71957f0e1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71957e92c5f0>]}
[0m11:32:53.983269 [debug] [MainThread]: Flushing usage events
[0m11:32:54.102553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:31.717956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7552a118aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75529f4943b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7552a0f108c0>]}


============================== 11:34:31.726092 | 83b68d7d-6f9c-4822-9259-a0e278e74270 ==============================
[0m11:34:31.726092 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:34:31.726910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:31.788891 [info ] [MainThread]: dbt version: 1.9.0
[0m11:34:31.789705 [info ] [MainThread]: python version: 3.12.4
[0m11:34:31.790871 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:34:31.791741 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:34:31.792948 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:34:31.793842 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:34:31.794735 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:34:31.939729 [info ] [MainThread]: Configuration:
[0m11:34:31.940342 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:34:31.941301 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:34:31.941935 [info ] [MainThread]: Required dependencies:
[0m11:34:31.942503 [debug] [MainThread]: Executing "git --help"
[0m11:34:31.946533 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:34:31.947089 [debug] [MainThread]: STDERR: "b''"
[0m11:34:31.947429 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:34:31.947907 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:34:31.948752 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:34:31.949572 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:34:31.951753 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.31224677, "process_in_blocks": "0", "process_kernel_time": 0.454978, "process_mem_max_rss": "88784", "process_out_blocks": "1480", "process_user_time": 2.139195}
[0m11:34:31.953003 [debug] [MainThread]: Command `dbt debug` failed at 11:34:31.952769 after 0.31 seconds
[0m11:34:31.953860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75529f15f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75529f213d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75529f21b5f0>]}
[0m11:34:31.954627 [debug] [MainThread]: Flushing usage events
[0m11:34:34.432922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:46.286682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b6100c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b6118f5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b610320500>]}


============================== 11:38:46.297871 | a48984d8-e4ba-4a2f-9928-f98a26dc522d ==============================
[0m11:38:46.297871 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:38:46.298991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:38:46.387088 [info ] [MainThread]: dbt version: 1.9.0
[0m11:38:46.388793 [info ] [MainThread]: python version: 3.12.4
[0m11:38:46.389606 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:38:46.390506 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:38:46.391343 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:38:46.392233 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:38:46.393083 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:38:46.588451 [info ] [MainThread]: Configuration:
[0m11:38:46.589089 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:38:46.589869 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:38:46.590582 [info ] [MainThread]: Required dependencies:
[0m11:38:46.591560 [debug] [MainThread]: Executing "git --help"
[0m11:38:46.598268 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:38:46.600250 [debug] [MainThread]: STDERR: "b''"
[0m11:38:46.601277 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:38:46.602299 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:38:46.603296 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:38:46.603991 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:38:46.605847 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42122954, "process_in_blocks": "0", "process_kernel_time": 0.573725, "process_mem_max_rss": "88804", "process_out_blocks": "1480", "process_user_time": 2.709936}
[0m11:38:46.606964 [debug] [MainThread]: Command `dbt debug` failed at 11:38:46.606716 after 0.42 seconds
[0m11:38:46.607681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b610524fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b610098ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60fb56120>]}
[0m11:38:46.608524 [debug] [MainThread]: Flushing usage events
[0m11:38:47.185898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:44.046063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483e6a0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483c3a27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483c3328d0>]}


============================== 11:39:44.056587 | 57d4efbd-d928-49ea-9b98-34bafb70a76f ==============================
[0m11:39:44.056587 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:39:44.057644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:39:44.114748 [info ] [MainThread]: dbt version: 1.9.0
[0m11:39:44.115315 [info ] [MainThread]: python version: 3.12.4
[0m11:39:44.116738 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:39:44.118189 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:39:44.243514 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:39:44.244502 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:39:44.245962 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:39:44.247568 [info ] [MainThread]: adapter type: postgres
[0m11:39:44.248500 [info ] [MainThread]: adapter version: 1.9.0
[0m11:39:44.414872 [info ] [MainThread]: Configuration:
[0m11:39:44.416110 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:39:44.417701 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:39:44.419105 [info ] [MainThread]: Required dependencies:
[0m11:39:44.420093 [debug] [MainThread]: Executing "git --help"
[0m11:39:44.424200 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:39:44.425824 [debug] [MainThread]: STDERR: "b''"
[0m11:39:44.426674 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:39:44.427625 [info ] [MainThread]: Connection:
[0m11:39:44.428615 [info ] [MainThread]:   host: db
[0m11:39:44.429581 [info ] [MainThread]:   port: 5432
[0m11:39:44.430421 [info ] [MainThread]:   user: admin
[0m11:39:44.431305 [info ] [MainThread]:   database: db
[0m11:39:44.432222 [info ] [MainThread]:   schema: dev
[0m11:39:44.433344 [info ] [MainThread]:   connect_timeout: 10
[0m11:39:44.434438 [info ] [MainThread]:   role: None
[0m11:39:44.435350 [info ] [MainThread]:   search_path: None
[0m11:39:44.439161 [info ] [MainThread]:   keepalives_idle: 0
[0m11:39:44.440150 [info ] [MainThread]:   sslmode: None
[0m11:39:44.441237 [info ] [MainThread]:   sslcert: None
[0m11:39:44.442233 [info ] [MainThread]:   sslkey: None
[0m11:39:44.443173 [info ] [MainThread]:   sslrootcert: None
[0m11:39:44.444004 [info ] [MainThread]:   application_name: dbt
[0m11:39:44.444902 [info ] [MainThread]:   retries: 1
[0m11:39:44.448434 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:39:44.594003 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:39:44.644415 [debug] [MainThread]: Using postgres connection "debug"
[0m11:39:44.644917 [debug] [MainThread]: On debug: select 1 as id
[0m11:39:44.645345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:44.661509 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m11:39:44.662784 [debug] [MainThread]: On debug: Close
[0m11:39:44.663310 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:39:44.663941 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:39:44.669274 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.69670665, "process_in_blocks": "0", "process_kernel_time": 0.464625, "process_mem_max_rss": "102096", "process_out_blocks": "1520", "process_user_time": 2.190951}
[0m11:39:44.669928 [debug] [MainThread]: Command `dbt debug` succeeded at 11:39:44.669794 after 0.70 seconds
[0m11:39:44.670385 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:39:44.670819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483c532ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483c23d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e483a45bb30>]}
[0m11:39:44.671294 [debug] [MainThread]: Flushing usage events
[0m11:39:44.723576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:33.561802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6138923200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d613a374380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61385f90a0>]}


============================== 11:40:33.569831 | bc9ceb56-caa6-4a1f-a4fd-a9813527296d ==============================
[0m11:40:33.569831 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:40:33.570522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:33.863348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6138322de0>]}
[0m11:40:33.954920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d613846e8d0>]}
[0m11:40:33.956313 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:40:34.082755 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:40:34.083726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:40:34.084543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6136b704a0>]}
[0m11:40:35.882322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61397287a0>]}
[0m11:40:35.999253 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:40:36.002641 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:40:36.042484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61356973b0>]}
[0m11:40:36.043074 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:40:36.043609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d613686e4b0>]}
[0m11:40:36.048496 [info ] [MainThread]: 
[0m11:40:36.049475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:36.050639 [info ] [MainThread]: 
[0m11:40:36.053582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:40:36.059839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:40:36.144122 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:40:36.144587 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:40:36.144922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:36.167607 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m11:40:36.170057 [debug] [ThreadPool]: On list_db: Close
[0m11:40:36.172791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:40:36.182489 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:40:36.183247 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:40:36.183911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:36.199406 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m11:40:36.200415 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:40:36.201355 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:40:36.238040 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m11:40:36.239674 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:40:36.240489 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:40:36.246748 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.248431 [debug] [MainThread]: On master: BEGIN
[0m11:40:36.249500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:36.267478 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:40:36.268477 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.269485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:40:36.304164 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m11:40:36.307123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61366f7e60>]}
[0m11:40:36.308117 [debug] [MainThread]: On master: ROLLBACK
[0m11:40:36.309030 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.309439 [debug] [MainThread]: On master: BEGIN
[0m11:40:36.310350 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:40:36.310862 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.311603 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.312379 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.313321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:40:36.314469 [debug] [MainThread]: On master: Close
[0m11:40:36.320445 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m11:40:36.321230 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m11:40:36.322057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.my_first_dbt_model)
[0m11:40:36.323031 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m11:40:36.335041 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m11:40:36.337178 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m11:40:36.511247 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m11:40:36.515642 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:40:36.516297 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m11:40:36.516842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:36.532193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m11:40:36.533196 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:40:36.534021 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "db"."dev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m11:40:36.539171 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m11:40:36.551466 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:40:36.552157 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "db"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:40:36.553521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:36.577432 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m11:40:36.577935 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:40:36.578319 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m11:40:36.581569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:40:36.588930 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."my_first_dbt_model__dbt_backup"
[0m11:40:36.596541 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:40:36.597355 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "db"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m11:40:36.598625 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:40:36.601500 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m11:40:36.603452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d613675b050>]}
[0m11:40:36.604401 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.28s]
[0m11:40:36.605353 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m11:40:36.607024 [debug] [Thread-3 (]: Began running node model.my_project.my_second_dbt_model
[0m11:40:36.607772 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m11:40:36.608653 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.my_second_dbt_model'
[0m11:40:36.609221 [debug] [Thread-3 (]: Began compiling node model.my_project.my_second_dbt_model
[0m11:40:36.613594 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m11:40:36.615013 [debug] [Thread-3 (]: Began executing node model.my_project.my_second_dbt_model
[0m11:40:36.640022 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m11:40:36.640717 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:40:36.641114 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m11:40:36.641481 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:40:36.652419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m11:40:36.653184 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:40:36.653882 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "db"."dev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "db"."dev"."my_first_dbt_model"
where id = 1
  );
[0m11:40:36.675978 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m11:40:36.680264 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:40:36.681353 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "db"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:40:36.682495 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:36.684189 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m11:40:36.684635 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:40:36.685042 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m11:40:36.688044 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:40:36.690446 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."my_second_dbt_model__dbt_backup"
[0m11:40:36.694266 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:40:36.694757 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "db"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m11:40:36.696020 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:40:36.698440 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: Close
[0m11:40:36.699566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc9ceb56-caa6-4a1f-a4fd-a9813527296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6136b98050>]}
[0m11:40:36.701263 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m11:40:36.703088 [debug] [Thread-3 (]: Finished running node model.my_project.my_second_dbt_model
[0m11:40:36.706232 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.706684 [debug] [MainThread]: On master: BEGIN
[0m11:40:36.707029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:36.719145 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:40:36.720095 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.721162 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:36.722253 [debug] [MainThread]: On master: COMMIT
[0m11:40:36.724035 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:40:36.725075 [debug] [MainThread]: On master: Close
[0m11:40:36.726222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:36.726724 [debug] [MainThread]: Connection 'model.my_project.my_first_dbt_model' was properly closed.
[0m11:40:36.727280 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m11:40:36.728017 [info ] [MainThread]: 
[0m11:40:36.729129 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m11:40:36.732703 [debug] [MainThread]: Command end result
[0m11:40:36.772961 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:40:36.776088 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:40:36.784376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:40:36.784823 [info ] [MainThread]: 
[0m11:40:36.785313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:36.785846 [info ] [MainThread]: 
[0m11:40:36.786521 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:40:36.787989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3013024, "process_in_blocks": "0", "process_kernel_time": 0.592543, "process_mem_max_rss": "112984", "process_out_blocks": "4208", "process_user_time": 4.81241}
[0m11:40:36.788732 [debug] [MainThread]: Command `dbt run` succeeded at 11:40:36.788580 after 3.30 seconds
[0m11:40:36.789156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6135629460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61389fa930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61389fb3e0>]}
[0m11:40:36.789574 [debug] [MainThread]: Flushing usage events
[0m11:40:38.086945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:16.196883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e780de3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e76e9d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e76583980>]}


============================== 11:48:16.200893 | 036b5491-b7c5-4c80-ab44-32803f975dbc ==============================
[0m11:48:16.200893 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:48:16.201490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:16.417652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e77f93350>]}
[0m11:48:16.493365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7671f260>]}
[0m11:48:16.494429 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:48:16.601180 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:48:16.712435 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:48:16.712984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7674be60>]}
[0m11:48:18.052990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e745b97f0>]}
[0m11:48:18.142244 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:18.145244 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:18.166256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e74931df0>]}
[0m11:48:18.166893 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:48:18.167348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e746bf3e0>]}
[0m11:48:18.169737 [info ] [MainThread]: 
[0m11:48:18.170266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:18.170911 [info ] [MainThread]: 
[0m11:48:18.172305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:18.174453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:48:18.288563 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:48:18.289096 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:48:18.289617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:18.304823 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:48:18.306803 [debug] [ThreadPool]: On list_db: Close
[0m11:48:18.308900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:48:18.316532 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:18.316956 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:48:18.317320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:18.327311 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:48:18.328452 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:18.328949 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:48:18.332679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m11:48:18.334303 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:48:18.335086 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:48:18.341971 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:18.342426 [debug] [MainThread]: On master: BEGIN
[0m11:48:18.342763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:18.352930 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:48:18.353493 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:18.354185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:18.358537 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:48:18.360310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e7453e8a0>]}
[0m11:48:18.360957 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:18.361753 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:18.362202 [debug] [MainThread]: On master: BEGIN
[0m11:48:18.363213 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:48:18.364030 [debug] [MainThread]: On master: COMMIT
[0m11:48:18.364670 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:18.365073 [debug] [MainThread]: On master: COMMIT
[0m11:48:18.365789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:48:18.366190 [debug] [MainThread]: On master: Close
[0m11:48:18.370248 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:48:18.370905 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:48:18.371581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:48:18.373454 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:48:18.383509 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:48:18.384995 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:48:18.435519 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:48:18.436967 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:18.437445 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:48:18.438042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:18.448039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:48:18.448532 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:18.449034 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT * 
FROM "db"."dev"."weather"
  );
  
[0m11:48:18.452820 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m11:48:18.460489 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:18.461197 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:48:18.462246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:18.483604 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:48:18.484198 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:18.484633 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:48:19.152109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.667 seconds
[0m11:48:19.160552 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:48:19.166852 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:19.167332 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:48:19.168159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:48:19.170700 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:48:19.172887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036b5491-b7c5-4c80-ab44-32803f975dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e77f92480>]}
[0m11:48:19.173869 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 5[0m in 0.80s]
[0m11:48:19.174867 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:48:19.177715 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:19.178131 [debug] [MainThread]: On master: BEGIN
[0m11:48:19.178495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:19.188450 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:48:19.189557 [debug] [MainThread]: On master: COMMIT
[0m11:48:19.190120 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:19.190524 [debug] [MainThread]: On master: COMMIT
[0m11:48:19.191282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:48:19.191818 [debug] [MainThread]: On master: Close
[0m11:48:19.192492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:19.192885 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:48:19.193299 [info ] [MainThread]: 
[0m11:48:19.193778 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m11:48:19.195435 [debug] [MainThread]: Command end result
[0m11:48:19.231019 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:19.232892 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:19.239780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:48:19.240203 [info ] [MainThread]: 
[0m11:48:19.240836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:19.241450 [info ] [MainThread]: 
[0m11:48:19.242902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:19.245007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.143217, "process_in_blocks": "0", "process_kernel_time": 0.512029, "process_mem_max_rss": "110176", "process_out_blocks": "2520", "process_user_time": 3.668209}
[0m11:48:19.245680 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:19.245550 after 3.14 seconds
[0m11:48:19.246118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e768fde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e76db2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e76b2fb00>]}
[0m11:48:19.246549 [debug] [MainThread]: Flushing usage events
[0m11:48:19.359726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:14.145967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760370f3c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760370d8a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036f47d9a0>]}


============================== 11:52:14.150284 | 00a1c7b4-7488-4349-9325-c86d2d21c043 ==============================
[0m11:52:14.150284 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:52:14.150876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:52:14.392297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760370d8a7b0>]}
[0m11:52:14.469868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d753bf0>]}
[0m11:52:14.470889 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:52:14.581418 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:52:14.789396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:14.790123 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:52:16.071551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d607830>]}
[0m11:52:16.159306 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:16.162523 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:16.183155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d2520f0>]}
[0m11:52:16.183741 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:52:16.184203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d23f350>]}
[0m11:52:16.186308 [info ] [MainThread]: 
[0m11:52:16.186835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:16.187440 [info ] [MainThread]: 
[0m11:52:16.188449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:16.190221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:52:16.258893 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:52:16.259440 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:52:16.260155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:16.274506 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m11:52:16.276286 [debug] [ThreadPool]: On list_db: Close
[0m11:52:16.278275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:52:16.286185 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:16.286627 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:52:16.286942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:16.296355 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:52:16.296982 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:16.297648 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:52:16.301321 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:52:16.302831 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:52:16.303509 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:52:16.309709 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.310174 [debug] [MainThread]: On master: BEGIN
[0m11:52:16.310532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:16.320950 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:52:16.321550 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.322133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:16.327922 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:52:16.330286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d380e00>]}
[0m11:52:16.330924 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:16.331775 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.332205 [debug] [MainThread]: On master: BEGIN
[0m11:52:16.333085 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:52:16.333497 [debug] [MainThread]: On master: COMMIT
[0m11:52:16.334079 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.334558 [debug] [MainThread]: On master: COMMIT
[0m11:52:16.335219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:16.335613 [debug] [MainThread]: On master: Close
[0m11:52:16.339920 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:52:16.340837 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:52:16.341614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:52:16.342639 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:52:16.351832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:52:16.352564 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:52:16.402995 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:52:16.404018 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:16.404467 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:52:16.404833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:16.415614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:52:16.416147 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:16.416731 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM source;
  );
  
[0m11:52:16.417778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: FROM source;
                    ^

[0m11:52:16.418487 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m11:52:16.419550 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:52:16.427476 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 27: FROM source;
                      ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:52:16.431068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a1c7b4-7488-4349-9325-c86d2d21c043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d380b30>]}
[0m11:52:16.433235 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.09s]
[0m11:52:16.435708 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:52:16.437148 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 27: FROM source;
                      ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m11:52:16.442647 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.443614 [debug] [MainThread]: On master: BEGIN
[0m11:52:16.444546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:16.457208 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:52:16.458036 [debug] [MainThread]: On master: COMMIT
[0m11:52:16.458942 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:16.459380 [debug] [MainThread]: On master: COMMIT
[0m11:52:16.460153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:16.460634 [debug] [MainThread]: On master: Close
[0m11:52:16.461213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:16.461560 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:52:16.462015 [info ] [MainThread]: 
[0m11:52:16.463600 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:52:16.466860 [debug] [MainThread]: Command end result
[0m11:52:16.612967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:16.615104 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:16.622779 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:52:16.623245 [info ] [MainThread]: 
[0m11:52:16.623842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:52:16.624526 [info ] [MainThread]: 
[0m11:52:16.625658 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 27: FROM source;
                      ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:52:16.626215 [info ] [MainThread]: 
[0m11:52:16.626828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:52:16.628705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6081889, "process_in_blocks": "0", "process_kernel_time": 0.514252, "process_mem_max_rss": "110236", "process_out_blocks": "2520", "process_user_time": 3.049637}
[0m11:52:16.629588 [debug] [MainThread]: Command `dbt run` failed at 11:52:16.629360 after 2.61 seconds
[0m11:52:16.630168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036f12f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036f97c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76036d775cd0>]}
[0m11:52:16.631012 [debug] [MainThread]: Flushing usage events
[0m11:52:16.713246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:30.974806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715935f047a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71593645b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715936a7b020>]}


============================== 11:52:30.978649 | 4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2 ==============================
[0m11:52:30.978649 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:52:30.979366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:52:31.188908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715935a2adb0>]}
[0m11:52:31.265475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71593595aed0>]}
[0m11:52:31.266691 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:52:31.369566 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:52:31.503441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:31.504383 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:52:31.861863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715933de8ad0>]}
[0m11:52:31.976398 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:31.979228 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:31.999773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715933de1fa0>]}
[0m11:52:32.000303 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:52:32.000763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715933ec8f80>]}
[0m11:52:32.002839 [info ] [MainThread]: 
[0m11:52:32.003372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:32.003960 [info ] [MainThread]: 
[0m11:52:32.005043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:32.006565 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:52:32.067516 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:52:32.068146 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:52:32.068482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:32.080396 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m11:52:32.081850 [debug] [ThreadPool]: On list_db: Close
[0m11:52:32.083434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:52:32.090505 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:32.090933 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:52:32.091251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:32.101206 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:52:32.101766 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:32.102202 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:52:32.106015 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:52:32.107538 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:52:32.108375 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:52:32.114462 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:32.114917 [debug] [MainThread]: On master: BEGIN
[0m11:52:32.115256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:32.124802 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:52:32.125299 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:32.125993 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:32.129706 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:52:32.131400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715931faab70>]}
[0m11:52:32.132077 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:32.132914 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:32.133399 [debug] [MainThread]: On master: BEGIN
[0m11:52:32.134454 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:52:32.134992 [debug] [MainThread]: On master: COMMIT
[0m11:52:32.135493 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:32.135995 [debug] [MainThread]: On master: COMMIT
[0m11:52:32.136687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:32.137099 [debug] [MainThread]: On master: Close
[0m11:52:32.140721 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:52:32.141498 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:52:32.142240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:52:32.142879 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:52:32.152160 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:52:32.152958 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:52:32.198951 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:52:32.199871 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:32.200300 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:52:32.200651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.211346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:52:32.212107 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:32.212524 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM source
  );
  
[0m11:52:33.670913 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.458 seconds
[0m11:52:33.679143 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:33.679734 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:52:33.680757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:52:33.684142 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:33.684790 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:52:33.686457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:52:33.722192 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:52:33.723089 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:33.723899 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:52:34.193475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.467 seconds
[0m11:52:34.216056 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:52:34.223058 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:52:34.223653 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:52:34.734330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.509 seconds
[0m11:52:34.750205 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:52:34.763967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6da09f-f0b8-4dc7-9ffb-b25dfec6bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71593777e990>]}
[0m11:52:34.766433 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 5[0m in 2.61s]
[0m11:52:34.769134 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:52:34.774760 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:34.775963 [debug] [MainThread]: On master: BEGIN
[0m11:52:34.776913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:34.792892 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:52:34.795791 [debug] [MainThread]: On master: COMMIT
[0m11:52:34.796274 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:34.796663 [debug] [MainThread]: On master: COMMIT
[0m11:52:34.797393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:34.797816 [debug] [MainThread]: On master: Close
[0m11:52:34.798416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:34.798787 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:52:34.799301 [info ] [MainThread]: 
[0m11:52:34.799808 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m11:52:34.801637 [debug] [MainThread]: Command end result
[0m11:52:34.833127 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:34.835085 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:34.843757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:52:34.844191 [info ] [MainThread]: 
[0m11:52:34.844869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:34.845513 [info ] [MainThread]: 
[0m11:52:34.846290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:34.848608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9720163, "process_in_blocks": "0", "process_kernel_time": 0.503324, "process_mem_max_rss": "110192", "process_out_blocks": "2520", "process_user_time": 2.672412}
[0m11:52:34.849415 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:34.849269 after 3.97 seconds
[0m11:52:34.849916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715935d69a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715936141370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715936637770>]}
[0m11:52:34.850357 [debug] [MainThread]: Flushing usage events
[0m11:52:34.902928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:33.824699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216cb1ee810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216cababb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216cba189e0>]}


============================== 11:57:33.828807 | 3863f299-3ac2-48cd-8939-e9d4b1a24134 ==============================
[0m11:57:33.828807 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:57:33.829749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:57:34.041897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8fcbbc0>]}
[0m11:57:34.117051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8fca990>]}
[0m11:57:34.118020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:57:34.222172 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:57:34.362279 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m11:57:34.362881 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m11:57:34.363293 [debug] [MainThread]: Partial parsing: added file: my_project://models/staging/stg_weather.sql
[0m11:57:34.363656 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/staging/staging.sql
[0m11:57:34.713846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8eaaf90>]}
[0m11:57:34.804466 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:57:34.807423 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:57:34.829311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8aca870>]}
[0m11:57:34.829903 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m11:57:34.830486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8c03500>]}
[0m11:57:34.832903 [info ] [MainThread]: 
[0m11:57:34.833474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:34.833967 [info ] [MainThread]: 
[0m11:57:34.835172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:57:34.844481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:57:34.911196 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:57:34.911667 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:57:34.911999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:34.924995 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:57:34.926609 [debug] [ThreadPool]: On list_db: Close
[0m11:57:34.928632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:57:34.935166 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:57:34.935599 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:57:34.935939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:34.945315 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:57:34.945913 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:57:34.946738 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:57:34.950994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m11:57:34.952613 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:57:34.953289 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:57:34.960286 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:34.960970 [debug] [MainThread]: On master: BEGIN
[0m11:57:34.961387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:34.972021 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:57:34.972549 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:34.973345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:57:34.977548 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:57:34.979608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216bad40950>]}
[0m11:57:34.980340 [debug] [MainThread]: On master: ROLLBACK
[0m11:57:34.981185 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:34.981678 [debug] [MainThread]: On master: BEGIN
[0m11:57:34.982802 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:57:34.983352 [debug] [MainThread]: On master: COMMIT
[0m11:57:34.984220 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:34.984797 [debug] [MainThread]: On master: COMMIT
[0m11:57:34.985576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:57:34.986035 [debug] [MainThread]: On master: Close
[0m11:57:34.990059 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:57:34.990963 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.stg_weather ................................... [RUN]
[0m11:57:34.991740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:57:34.992666 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:57:35.001495 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:57:35.002509 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:57:35.047221 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:57:35.048231 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:57:35.048828 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:57:35.049227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:35.060089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:57:35.061065 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:57:35.061734 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT
    *
FROM de_dup

-- SELECT 
--     id, 
--     city, 
--     temperature, 
--     weather_descriptions, 
--     wind_speed, 
--     time as weather_time_local,
--     (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
-- FROM source
  );
  
[0m11:57:35.083309 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.021 seconds
[0m11:57:35.090917 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:57:35.091549 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:57:35.092553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:35.113127 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:57:35.113666 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:57:35.114147 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:57:35.117299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:57:35.124361 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:57:35.131051 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:57:35.131545 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:57:35.132388 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:57:35.136174 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:57:35.138956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216cc4b2630>]}
[0m11:57:35.139872 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.stg_weather .............................. [[32mSELECT 5[0m in 0.15s]
[0m11:57:35.141008 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:57:35.143006 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m11:57:35.143809 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m11:57:35.144753 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:57:35.145505 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m11:57:35.149648 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:57:35.151391 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m11:57:35.157718 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:57:35.160152 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:57:35.160955 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m11:57:35.162075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:57:35.172681 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m11:57:35.173589 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:57:35.174274 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT *
FROM "db"."dev"."stg_weather"
  );
  
[0m11:57:35.178073 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.003 seconds
[0m11:57:35.185925 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:57:35.186859 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:57:35.188340 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:35.191022 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m11:57:35.191800 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:57:35.192612 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m11:57:35.195848 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:57:35.198709 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:57:35.200172 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:57:35.201293 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:57:35.202257 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:57:35.204066 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m11:57:35.204868 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3863f299-3ac2-48cd-8939-e9d4b1a24134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216b8341b80>]}
[0m11:57:35.205663 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.06s]
[0m11:57:35.206909 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m11:57:35.210123 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:35.210593 [debug] [MainThread]: On master: BEGIN
[0m11:57:35.210959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:35.224966 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:57:35.226180 [debug] [MainThread]: On master: COMMIT
[0m11:57:35.226997 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:35.227669 [debug] [MainThread]: On master: COMMIT
[0m11:57:35.228483 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:57:35.228878 [debug] [MainThread]: On master: Close
[0m11:57:35.229441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:35.229842 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:57:35.230308 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:57:35.230787 [info ] [MainThread]: 
[0m11:57:35.231327 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:57:35.235594 [debug] [MainThread]: Command end result
[0m11:57:35.263400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:57:35.265286 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:57:35.273366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:57:35.273809 [info ] [MainThread]: 
[0m11:57:35.274386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:35.275102 [info ] [MainThread]: 
[0m11:57:35.275974 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:57:35.278029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5506035, "process_in_blocks": "0", "process_kernel_time": 0.508317, "process_mem_max_rss": "110512", "process_out_blocks": "2568", "process_user_time": 2.67264}
[0m11:57:35.278899 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:35.278725 after 1.55 seconds
[0m11:57:35.279384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216caa9c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216c8e7f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216cb5a8cb0>]}
[0m11:57:35.279848 [debug] [MainThread]: Flushing usage events
[0m11:57:35.370077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:42.175049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b54ac110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b6304620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b431a480>]}


============================== 12:00:42.179630 | 03cb1545-47a2-4f1a-bbdb-0fbc9c074407 ==============================
[0m12:00:42.179630 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:00:42.181562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:00:42.574915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b3ff0e30>]}
[0m12:00:42.652811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b34a78c0>]}
[0m12:00:42.653817 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:42.771294 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:00:42.943626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:00:42.944338 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/stg_weather.sql
[0m12:00:43.400630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b1931640>]}
[0m12:00:43.507766 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:00:43.510796 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:00:43.539815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b1846540>]}
[0m12:00:43.540392 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m12:00:43.540828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b1951160>]}
[0m12:00:43.542985 [info ] [MainThread]: 
[0m12:00:43.543471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:43.544037 [info ] [MainThread]: 
[0m12:00:43.545152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:43.552149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:00:43.619132 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:00:43.620016 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:00:43.620555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:43.635576 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:00:43.637065 [debug] [ThreadPool]: On list_db: Close
[0m12:00:43.638867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:00:43.644869 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:00:43.645362 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:00:43.645951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:43.656092 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:00:43.656573 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:00:43.657075 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:00:43.660962 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:00:43.663420 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:00:43.665032 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:00:43.674757 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:43.675198 [debug] [MainThread]: On master: BEGIN
[0m12:00:43.675532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:43.686945 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:00:43.687718 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:43.688361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:43.693138 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:00:43.694994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b52d0500>]}
[0m12:00:43.695951 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:43.697930 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:43.698696 [debug] [MainThread]: On master: BEGIN
[0m12:00:43.700142 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:00:43.701146 [debug] [MainThread]: On master: COMMIT
[0m12:00:43.702421 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:43.702998 [debug] [MainThread]: On master: COMMIT
[0m12:00:43.703689 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:43.704137 [debug] [MainThread]: On master: Close
[0m12:00:43.708264 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:00:43.709309 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.stg_weather ................................... [RUN]
[0m12:00:43.710430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:00:43.711479 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:00:43.731754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:00:43.734515 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:00:43.805324 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:00:43.806238 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:00:43.806781 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:00:43.807240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:43.819915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:00:43.820724 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:00:43.821337 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:00:43.826206 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m12:00:43.838402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:00:43.838986 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:00:43.839998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:00:43.873076 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:00:43.873669 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:00:43.874205 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:00:43.876787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:00:43.888415 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:00:43.895206 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:00:43.897932 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:00:43.899368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:00:43.903676 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:00:43.906053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b52263c0>]}
[0m12:00:43.906887 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.19s]
[0m12:00:43.907829 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:00:43.909450 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m12:00:43.910227 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m12:00:43.911129 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:00:43.911879 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m12:00:43.919086 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:00:43.920026 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m12:00:43.924267 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:00:43.925460 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.926617 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m12:00:43.927137 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:00:43.938587 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:00:43.939282 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.939869 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT *
FROM "db"."dev"."stg_weather"
  );
  
[0m12:00:43.942638 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.002 seconds
[0m12:00:43.946521 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.947244 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:00:43.948493 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:00:43.951785 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.952242 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:00:43.952995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:00:43.956856 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m12:00:43.957428 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.958033 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m12:00:43.961353 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:00:43.967873 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:00:43.969027 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m12:00:43.969584 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:00:43.973492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:00:43.975684 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m12:00:43.976735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb1545-47a2-4f1a-bbdb-0fbc9c074407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b00fb1d0>]}
[0m12:00:43.978199 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.07s]
[0m12:00:43.980973 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m12:00:43.985040 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:43.985570 [debug] [MainThread]: On master: BEGIN
[0m12:00:43.986079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:44.000036 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:00:44.001830 [debug] [MainThread]: On master: COMMIT
[0m12:00:44.002827 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:44.003310 [debug] [MainThread]: On master: COMMIT
[0m12:00:44.004042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:44.004558 [debug] [MainThread]: On master: Close
[0m12:00:44.005498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:44.006341 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:00:44.007180 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:00:44.008082 [info ] [MainThread]: 
[0m12:00:44.009313 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:00:44.014443 [debug] [MainThread]: Command end result
[0m12:00:44.049605 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:00:44.053172 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:00:44.062225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:00:44.063466 [info ] [MainThread]: 
[0m12:00:44.065021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:44.066315 [info ] [MainThread]: 
[0m12:00:44.067614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:00:44.072486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0296626, "process_in_blocks": "0", "process_kernel_time": 0.56445, "process_mem_max_rss": "110492", "process_out_blocks": "2568", "process_user_time": 3.330658}
[0m12:00:44.074288 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:44.073916 after 2.03 seconds
[0m12:00:44.075216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b54ac110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b47bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b19332c0>]}
[0m12:00:44.075905 [debug] [MainThread]: Flushing usage events
[0m12:00:44.174588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:17.228421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4ec6df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4efbcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd50a98b30>]}


============================== 12:05:17.232999 | 8cef457f-fb0c-4294-a293-9169dcc9a9de ==============================
[0m12:05:17.232999 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:05:17.234451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:05:17.495495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4ee2c980>]}
[0m12:05:17.576447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd501a4890>]}
[0m12:05:17.577565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:05:17.687578 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:05:17.832711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:05:17.833372 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_average.sql
[0m12:05:17.833881 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m12:05:18.188781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4d07ed50>]}
[0m12:05:18.279222 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:05:18.282449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:05:18.302715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4cfa6e70>]}
[0m12:05:18.303256 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:05:18.303680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4cedc800>]}
[0m12:05:18.305831 [info ] [MainThread]: 
[0m12:05:18.306390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:18.306990 [info ] [MainThread]: 
[0m12:05:18.308038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:18.314310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:05:18.382366 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:05:18.382976 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:05:18.383354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:18.396730 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:05:18.398520 [debug] [ThreadPool]: On list_db: Close
[0m12:05:18.400581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:05:18.406914 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:05:18.407332 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:05:18.407640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:18.417055 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:05:18.417583 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:05:18.418189 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:05:18.421914 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m12:05:18.423558 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:05:18.424263 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:05:18.432106 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.432832 [debug] [MainThread]: On master: BEGIN
[0m12:05:18.433465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:18.444340 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:05:18.445262 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.445893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:18.450225 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:05:18.452384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4d2eabd0>]}
[0m12:05:18.453281 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:18.454258 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.454735 [debug] [MainThread]: On master: BEGIN
[0m12:05:18.455796 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:05:18.456223 [debug] [MainThread]: On master: COMMIT
[0m12:05:18.456696 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.457200 [debug] [MainThread]: On master: COMMIT
[0m12:05:18.457818 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:18.458216 [debug] [MainThread]: On master: Close
[0m12:05:18.462067 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:05:18.462747 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:05:18.463509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:05:18.464563 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:05:18.474680 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:05:18.475615 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:05:18.521315 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:05:18.522112 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.522595 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:05:18.522959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:18.532432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:05:18.532924 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.533502 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:05:18.537593 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m12:05:18.544767 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.545285 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:05:18.546247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:18.549426 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.549910 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:05:18.551060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:18.576467 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:05:18.576964 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.577608 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:05:18.580656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:05:18.588378 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:05:18.597035 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:05:18.597599 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:05:18.600910 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:05:18.603909 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:05:18.607127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd5094e690>]}
[0m12:05:18.608363 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.14s]
[0m12:05:18.609696 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:05:18.611599 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:05:18.612267 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:05:18.612972 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:05:18.614218 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:05:18.615671 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:05:18.616835 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:05:18.617674 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:05:18.618561 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:05:18.625521 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:05:18.635654 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:05:18.637088 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:05:18.643259 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:05:18.644036 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:05:18.648987 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:05:18.649555 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:05:18.650312 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:05:18.650893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:18.651665 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.652217 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:05:18.652637 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:18.662167 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:05:18.663068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m12:05:18.663811 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:05:18.664702 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.665293 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:05:18.665867 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:05:18.669267 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:05:18.673410 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.673924 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:05:18.674918 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:05:18.678401 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.679606 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:05:18.681156 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:18.683785 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:05:18.684273 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.684756 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:05:18.690868 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:05:18.694886 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:05:18.696446 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:05:18.696907 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:05:18.701903 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:05:18.703618 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:05:18.704316 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd370d3560>]}
[0m12:05:18.705149 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.09s]
[0m12:05:18.706324 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:05:18.722621 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.056 seconds
[0m12:05:18.726622 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:05:18.727213 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:05:18.728690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:18.732486 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:05:18.733014 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:05:18.733442 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:05:18.737187 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:05:18.739609 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:05:18.740250 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:05:18.740630 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:05:18.741436 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:05:18.742999 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:05:18.743640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cef457f-fb0c-4294-a293-9169dcc9a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd36fb1760>]}
[0m12:05:18.744293 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.13s]
[0m12:05:18.745288 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:05:18.747763 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.748198 [debug] [MainThread]: On master: BEGIN
[0m12:05:18.748555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:18.757975 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:05:18.758894 [debug] [MainThread]: On master: COMMIT
[0m12:05:18.759905 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:18.760958 [debug] [MainThread]: On master: COMMIT
[0m12:05:18.762261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:18.763687 [debug] [MainThread]: On master: Close
[0m12:05:18.765301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:18.765858 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:05:18.766803 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:05:18.767540 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:05:18.768498 [info ] [MainThread]: 
[0m12:05:18.769229 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:05:18.771237 [debug] [MainThread]: Command end result
[0m12:05:18.799746 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:05:18.801893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:05:18.809009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:05:18.809455 [info ] [MainThread]: 
[0m12:05:18.809918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:18.810474 [info ] [MainThread]: 
[0m12:05:18.811167 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:05:18.813442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7407314, "process_in_blocks": "0", "process_kernel_time": 0.457313, "process_mem_max_rss": "110576", "process_out_blocks": "2616", "process_user_time": 3.124973}
[0m12:05:18.814465 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:18.814257 after 1.74 seconds
[0m12:05:18.815201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4ee01310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4d098aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd4fe4e150>]}
[0m12:05:18.816020 [debug] [MainThread]: Flushing usage events
[0m12:05:20.279248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:42.435246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd3e1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd4e7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efb878440>]}


============================== 12:16:42.443744 | 03d69e51-ff28-4757-9cd2-291a923fb07a ==============================
[0m12:16:42.443744 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:16:42.444752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:16:42.750478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efb8291f0>]}
[0m12:16:42.837296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef9c64200>]}
[0m12:16:42.838538 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:16:42.979283 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:16:43.124472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:43.124993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:43.172133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef9d40050>]}
[0m12:16:43.273814 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:16:43.277017 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:16:43.318619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef9a54bf0>]}
[0m12:16:43.319349 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:16:43.319944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef9d1eb70>]}
[0m12:16:43.322744 [info ] [MainThread]: 
[0m12:16:43.323355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:43.324366 [info ] [MainThread]: 
[0m12:16:43.325777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:43.333048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:16:43.433054 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:16:43.433689 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:16:43.434205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:43.457091 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m12:16:43.458749 [debug] [ThreadPool]: On list_db: Close
[0m12:16:43.460924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:16:43.469745 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:16:43.470323 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:16:43.470700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:43.481322 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:16:43.481942 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:16:43.482520 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:16:43.489547 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m12:16:43.491679 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:16:43.492627 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:16:43.503368 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:43.503860 [debug] [MainThread]: On master: BEGIN
[0m12:16:43.504281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:43.515696 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:16:43.516495 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:43.517240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:43.525655 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:16:43.527810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef9d1eb70>]}
[0m12:16:43.528905 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:43.530199 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:43.531256 [debug] [MainThread]: On master: BEGIN
[0m12:16:43.533112 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:16:43.533906 [debug] [MainThread]: On master: COMMIT
[0m12:16:43.534740 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:43.535488 [debug] [MainThread]: On master: COMMIT
[0m12:16:43.536672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:43.537452 [debug] [MainThread]: On master: Close
[0m12:16:43.553227 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:16:43.554540 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:16:43.555570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:16:43.556570 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:16:43.593707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:16:43.594856 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:16:43.661466 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:16:43.662338 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.662889 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:16:43.663369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:43.673346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:16:43.674214 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.674852 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:16:43.682729 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:16:43.694074 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.694613 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:16:43.695743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:43.699296 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.699828 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:16:43.700902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:43.727023 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:16:43.727584 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.728028 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:16:43.938143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.209 seconds
[0m12:16:43.946472 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:16:43.953606 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:16:43.954143 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:16:43.958234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:16:43.961675 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:16:43.965114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd49e720>]}
[0m12:16:43.966443 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.41s]
[0m12:16:43.967700 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:16:43.969755 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:16:43.970312 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:16:43.971232 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:16:43.972361 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:16:43.973840 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:16:43.975079 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:16:43.975876 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:16:43.976746 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:16:43.983103 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:16:43.990635 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:16:43.992287 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:16:43.992987 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:16:43.999165 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:16:44.002839 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:16:44.004225 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.004992 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.005489 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:16:44.006277 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:16:44.007320 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:16:44.008661 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:16:44.020295 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m12:16:44.021554 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.022724 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:16:44.023884 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:16:44.024651 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.025453 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:16:44.029413 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.004 seconds
[0m12:16:44.033587 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.034205 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.008 seconds
[0m12:16:44.034720 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:16:44.039518 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.042206 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:16:44.043773 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:16:44.048359 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.048981 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:16:44.049527 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:16:44.053295 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.054229 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:16:44.054887 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:44.057517 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:16:44.058106 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:16:44.058632 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.060763 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:16:44.061468 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:16:44.062045 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.062933 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:16:44.066502 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:16:44.070519 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:16:44.071107 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m12:16:44.072436 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:44.075561 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:16:44.076305 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:16:44.077128 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:44.078023 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:16:44.080904 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:16:44.082868 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:16:44.083456 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:16:44.085263 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:16:44.085886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef8baa450>]}
[0m12:16:44.087884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d69e51-ff28-4757-9cd2-291a923fb07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef8ba9640>]}
[0m12:16:44.086925 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.11s]
[0m12:16:44.090442 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.11s]
[0m12:16:44.091943 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:16:44.093019 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:16:44.095938 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:44.096630 [debug] [MainThread]: On master: BEGIN
[0m12:16:44.097264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:44.109043 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:16:44.109663 [debug] [MainThread]: On master: COMMIT
[0m12:16:44.110169 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:44.110553 [debug] [MainThread]: On master: COMMIT
[0m12:16:44.111307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:44.111758 [debug] [MainThread]: On master: Close
[0m12:16:44.112453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:44.112823 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:16:44.113180 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:16:44.113495 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:16:44.113950 [info ] [MainThread]: 
[0m12:16:44.114516 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:16:44.117053 [debug] [MainThread]: Command end result
[0m12:16:44.148339 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:16:44.150285 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:16:44.158732 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:16:44.159202 [info ] [MainThread]: 
[0m12:16:44.159704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:44.160551 [info ] [MainThread]: 
[0m12:16:44.161360 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:16:44.163094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.793304, "process_in_blocks": "0", "process_kernel_time": 0.684511, "process_mem_max_rss": "108556", "process_out_blocks": "3392", "process_user_time": 2.943399}
[0m12:16:44.163765 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:44.163629 after 1.79 seconds
[0m12:16:44.164271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efb9e6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efb5ad5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efc071e50>]}
[0m12:16:44.164703 [debug] [MainThread]: Flushing usage events
[0m12:16:45.512459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:21.454173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6ec8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6be89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b754da60>]}


============================== 12:27:21.458996 | 57023e64-3dc2-4a70-af05-a8359697d279 ==============================
[0m12:27:21.458996 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:27:21.459863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:21.691362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b72dfc80>]}
[0m12:27:21.777213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6c5c530>]}
[0m12:27:21.778207 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:27:21.905938 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:27:22.045793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:22.046284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:22.094819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b500fb00>]}
[0m12:27:22.193450 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:27:22.196482 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:27:22.219461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b4d08590>]}
[0m12:27:22.220079 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:27:22.220688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b4cffd40>]}
[0m12:27:22.223451 [info ] [MainThread]: 
[0m12:27:22.224159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:22.225118 [info ] [MainThread]: 
[0m12:27:22.226463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:22.233941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:27:22.311859 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:27:22.312397 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:27:22.312828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:22.331188 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m12:27:22.333312 [debug] [ThreadPool]: On list_db: Close
[0m12:27:22.336054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:27:22.342529 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:27:22.342997 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:27:22.343318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:22.353654 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:27:22.354122 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:27:22.354752 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:27:22.359803 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:27:22.361613 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:27:22.362588 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:27:22.372166 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.372631 [debug] [MainThread]: On master: BEGIN
[0m12:27:22.373045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:22.384557 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:27:22.385524 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.386438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:22.391115 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:27:22.393098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6827830>]}
[0m12:27:22.393905 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:22.395044 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.395512 [debug] [MainThread]: On master: BEGIN
[0m12:27:22.396456 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:27:22.397133 [debug] [MainThread]: On master: COMMIT
[0m12:27:22.397845 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.398780 [debug] [MainThread]: On master: COMMIT
[0m12:27:22.400721 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:22.401271 [debug] [MainThread]: On master: Close
[0m12:27:22.405662 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:27:22.406402 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:27:22.407092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:27:22.407676 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:27:22.419195 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:27:22.420359 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:27:22.490523 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:27:22.491622 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.492215 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:27:22.492845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:22.504889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:27:22.505732 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.506557 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:27:22.512958 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:27:22.534134 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.535462 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:27:22.537092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:22.542222 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.542741 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:27:22.543664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:27:22.573518 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:27:22.574097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.574633 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:27:22.617887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m12:27:22.625377 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:27:22.633983 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:27:22.634578 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:27:22.639524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:27:22.642415 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:27:22.644570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b8596420>]}
[0m12:27:22.646153 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.24s]
[0m12:27:22.647539 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:27:22.649448 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:27:22.649986 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:27:22.650778 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:27:22.653253 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:27:22.654128 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:27:22.651766 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:27:22.661987 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:27:22.663081 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:27:22.664012 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:27:22.669033 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:27:22.670323 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:27:22.674635 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:27:22.675425 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:27:22.679747 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:27:22.680444 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.681526 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:27:22.682569 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:27:22.684340 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.685443 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:27:22.686390 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:27:22.698518 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m12:27:22.699183 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.699879 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:27:22.700745 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:27:22.701915 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.702924 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:27:22.706463 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.005 seconds
[0m12:27:22.711110 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.712052 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.008 seconds
[0m12:27:22.713004 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:27:22.720222 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.721125 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:27:22.721776 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:22.725415 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.725988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:27:22.726554 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:27:22.733403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.734564 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:27:22.735245 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:22.737704 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:27:22.738165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:27:22.738648 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.740388 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:27:22.741049 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:27:22.741528 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.742240 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:27:22.744135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m12:27:22.748674 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:27:22.749372 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:27:22.750282 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:27:22.752859 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:27:22.753436 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:27:22.754224 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:27:22.754923 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:27:22.757982 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:27:22.760955 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:27:22.761550 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:27:22.764065 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:27:22.765191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8acd36e40>]}
[0m12:27:22.767672 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57023e64-3dc2-4a70-af05-a8359697d279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8acd36e70>]}
[0m12:27:22.766758 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.11s]
[0m12:27:22.769188 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.10s]
[0m12:27:22.770498 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:27:22.771512 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:27:22.774852 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.775707 [debug] [MainThread]: On master: BEGIN
[0m12:27:22.776393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:22.791011 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:27:22.792163 [debug] [MainThread]: On master: COMMIT
[0m12:27:22.793551 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:22.794500 [debug] [MainThread]: On master: COMMIT
[0m12:27:22.795815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:22.796647 [debug] [MainThread]: On master: Close
[0m12:27:22.798007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:22.799581 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:27:22.800689 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:27:22.801435 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:27:22.802186 [info ] [MainThread]: 
[0m12:27:22.803092 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:27:22.806533 [debug] [MainThread]: Command end result
[0m12:27:22.841074 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:27:22.842981 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:27:22.851631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:27:22.852180 [info ] [MainThread]: 
[0m12:27:22.853069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:22.854748 [info ] [MainThread]: 
[0m12:27:22.855694 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:27:22.858356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5006559, "process_in_blocks": "0", "process_kernel_time": 0.61583, "process_mem_max_rss": "107500", "process_out_blocks": "1792", "process_user_time": 2.900886}
[0m12:27:22.859603 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:22.859371 after 1.50 seconds
[0m12:27:22.860634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6df9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b6b21fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b7303530>]}
[0m12:27:22.861348 [debug] [MainThread]: Flushing usage events
[0m12:27:23.896466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:46.450383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295b546e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295502e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295559a90>]}


============================== 12:31:46.462610 | 96f3e6b8-8475-4da5-8fc5-d20184e1e7ec ==============================
[0m12:31:46.462610 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:31:46.463520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:31:46.737301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96f3e6b8-8475-4da5-8fc5-d20184e1e7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2950236e0>]}
[0m12:31:46.815798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96f3e6b8-8475-4da5-8fc5-d20184e1e7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295177d10>]}
[0m12:31:46.816758 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:31:46.933092 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:31:47.077258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:47.077782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:47.122454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96f3e6b8-8475-4da5-8fc5-d20184e1e7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2936f4ad0>]}
[0m12:31:47.217750 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:31:47.221082 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:31:47.251485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96f3e6b8-8475-4da5-8fc5-d20184e1e7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa293480b90>]}
[0m12:31:47.252258 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:31:47.253133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f3e6b8-8475-4da5-8fc5-d20184e1e7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa293754590>]}
[0m12:31:47.255631 [info ] [MainThread]: 
[0m12:31:47.256145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:47.256712 [info ] [MainThread]: 
[0m12:31:47.257784 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:47.264288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:31:47.339195 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:31:47.339643 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:31:47.339981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:47.343958 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: FATAL:  the database system is not yet accepting connections
DETAIL:  Consistent recovery state has not been yet reached.

[0m12:31:47.347944 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:31:47.348762 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:31:47.349530 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:31:47.349981 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:31:47.350408 [debug] [ThreadPool]: On list_db: No close available on handle
[0m12:31:47.351411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:47.351819 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m12:31:47.352255 [info ] [MainThread]: 
[0m12:31:47.352806 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m12:31:47.354128 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: FATAL:  the database system is not yet accepting connections
  DETAIL:  Consistent recovery state has not been yet reached.
  
[0m12:31:47.356289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.96999234, "process_in_blocks": "0", "process_kernel_time": 0.492738, "process_mem_max_rss": "104868", "process_out_blocks": "2472", "process_user_time": 2.555832}
[0m12:31:47.357096 [debug] [MainThread]: Command `dbt run` failed at 12:31:47.356944 after 0.97 seconds
[0m12:31:47.357623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295358cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2933e1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2933f21e0>]}
[0m12:31:47.358341 [debug] [MainThread]: Flushing usage events
[0m12:31:48.624488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:42.331074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11ecf9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed120758590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11effcef0>]}


============================== 12:34:42.339002 | c7b54540-6171-4a39-87f4-ff4a55ef4c18 ==============================
[0m12:34:42.339002 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:34:42.339716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:42.621948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11e6e3aa0>]}
[0m12:34:42.710859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11e77b5c0>]}
[0m12:34:42.712045 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:34:42.897237 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:34:43.097387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:43.097950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:43.174613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11e702870>]}
[0m12:34:43.308786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:34:43.311836 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:34:43.344375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11cc1c3b0>]}
[0m12:34:43.345010 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:34:43.345558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11cf2fb30>]}
[0m12:34:43.348097 [info ] [MainThread]: 
[0m12:34:43.348675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:43.349354 [info ] [MainThread]: 
[0m12:34:43.350419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:43.357868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:34:43.447509 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:34:43.448037 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:34:43.448471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:43.469474 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m12:34:43.471681 [debug] [ThreadPool]: On list_db: Close
[0m12:34:43.474380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:34:43.482196 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:34:43.482715 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:34:43.483167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:43.494908 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:34:43.495643 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:34:43.496397 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:34:43.501723 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:34:43.504269 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:34:43.505297 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:34:43.514822 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.516226 [debug] [MainThread]: On master: BEGIN
[0m12:34:43.517301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:43.530978 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:34:43.531757 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.533067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:34:43.540692 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:34:43.543058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11ea4a7e0>]}
[0m12:34:43.543798 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:43.544567 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.545996 [debug] [MainThread]: On master: BEGIN
[0m12:34:43.548436 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:34:43.550012 [debug] [MainThread]: On master: COMMIT
[0m12:34:43.550815 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.551315 [debug] [MainThread]: On master: COMMIT
[0m12:34:43.552216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:34:43.552739 [debug] [MainThread]: On master: Close
[0m12:34:43.557452 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:34:43.558717 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:34:43.560105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:34:43.560995 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:34:43.570575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:34:43.571963 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:34:43.631003 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:34:43.631797 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.632264 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:34:43.632700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:43.642055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:34:43.642761 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.643321 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:34:43.649923 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:34:43.659909 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.660688 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:34:43.662377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:43.666892 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.667376 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:34:43.668567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:43.692612 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:34:43.693098 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.693515 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:34:43.695940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:43.703792 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:34:43.711777 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:34:43.712281 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:34:43.715949 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:34:43.718816 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:34:43.720906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed1206da720>]}
[0m12:34:43.721809 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.16s]
[0m12:34:43.722701 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:34:43.724907 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:34:43.725714 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:34:43.726518 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:34:43.727568 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:34:43.729071 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:34:43.730520 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:34:43.731549 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:34:43.732694 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:34:43.743443 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:34:43.749803 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:34:43.751197 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:34:43.751999 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:34:43.756746 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:34:43.764120 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:34:43.766435 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.767187 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:34:43.767943 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:34:43.768609 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.769563 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:34:43.770355 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:34:43.782477 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:34:43.783976 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.784965 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m12:34:43.786096 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:34:43.787186 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.788150 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:34:43.793569 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.005 seconds
[0m12:34:43.794386 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.006 seconds
[0m12:34:43.798669 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.802668 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.803394 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:34:43.804137 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:34:43.805412 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:43.806255 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:34:43.812943 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.820729 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.821416 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:34:43.822370 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:34:43.824317 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:34:43.825696 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:34:43.828572 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:34:43.830802 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:34:43.831601 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.832369 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.833335 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:34:43.834113 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:34:43.837263 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m12:34:43.840669 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:34:43.841322 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:34:43.842323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:34:43.845403 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:34:43.846162 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:34:43.847094 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:34:43.847982 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:34:43.851502 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:34:43.854102 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:34:43.854839 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:34:43.858151 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:34:43.859377 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed117d05fd0>]}
[0m12:34:43.861001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7b54540-6171-4a39-87f4-ff4a55ef4c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed114c24350>]}
[0m12:34:43.862278 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.13s]
[0m12:34:43.864073 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.13s]
[0m12:34:43.865845 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:34:43.867164 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:34:43.871123 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.871952 [debug] [MainThread]: On master: BEGIN
[0m12:34:43.872538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:43.887098 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:34:43.887984 [debug] [MainThread]: On master: COMMIT
[0m12:34:43.888514 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.888905 [debug] [MainThread]: On master: COMMIT
[0m12:34:43.889533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:34:43.889933 [debug] [MainThread]: On master: Close
[0m12:34:43.890751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:43.891363 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:34:43.892031 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:34:43.892759 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:34:43.893817 [info ] [MainThread]: 
[0m12:34:43.894627 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m12:34:43.899234 [debug] [MainThread]: Command end result
[0m12:34:43.933318 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:34:43.935273 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:34:43.943226 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:34:43.943702 [info ] [MainThread]: 
[0m12:34:43.944280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:43.944908 [info ] [MainThread]: 
[0m12:34:43.945884 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:34:43.948577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6809614, "process_in_blocks": "0", "process_kernel_time": 0.674113, "process_mem_max_rss": "108172", "process_out_blocks": "3392", "process_user_time": 3.214076}
[0m12:34:43.949357 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:43.949134 after 1.68 seconds
[0m12:34:43.949898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11f0a30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11f35d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed11f14e2a0>]}
[0m12:34:43.950434 [debug] [MainThread]: Flushing usage events
[0m12:34:44.014745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:13.520568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e238c32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e233947a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e238c0c20>]}


============================== 12:38:13.524644 | b1a549f7-07ff-4f76-8893-41ea8f389229 ==============================
[0m12:38:13.524644 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:38:13.525393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:13.762993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e218215e0>]}
[0m12:38:13.843013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e217f8e00>]}
[0m12:38:13.844109 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:38:13.969461 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:38:14.125610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:14.126138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:14.177185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e217287d0>]}
[0m12:38:14.270785 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:38:14.273683 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:38:14.294040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e21450350>]}
[0m12:38:14.294610 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:38:14.295147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e216c6d80>]}
[0m12:38:14.297674 [info ] [MainThread]: 
[0m12:38:14.298275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:14.299913 [info ] [MainThread]: 
[0m12:38:14.301270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:14.307623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:38:14.376038 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:38:14.376523 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:38:14.376899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:14.396538 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m12:38:14.398545 [debug] [ThreadPool]: On list_db: Close
[0m12:38:14.400829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:38:14.407754 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:38:14.408199 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:38:14.408557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:14.418120 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:38:14.418836 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:38:14.419600 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:14.424334 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:38:14.426014 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:38:14.426782 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:38:14.435946 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.436656 [debug] [MainThread]: On master: BEGIN
[0m12:38:14.437523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:14.446603 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:38:14.447364 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.448675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:14.453713 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:38:14.455813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e24271640>]}
[0m12:38:14.456648 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:14.457382 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.457793 [debug] [MainThread]: On master: BEGIN
[0m12:38:14.458703 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:38:14.459241 [debug] [MainThread]: On master: COMMIT
[0m12:38:14.460122 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.460747 [debug] [MainThread]: On master: COMMIT
[0m12:38:14.461415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:14.461983 [debug] [MainThread]: On master: Close
[0m12:38:14.466935 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:38:14.468140 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:38:14.469225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:38:14.470242 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:38:14.480527 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:38:14.481531 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:38:14.527537 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:38:14.528352 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.528872 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:38:14.529345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:14.539866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:38:14.540861 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.541411 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:38:14.547499 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m12:38:14.561416 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.561986 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:38:14.563049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:38:14.568001 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.568561 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:38:14.569566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:38:14.601229 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:38:14.601857 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.602311 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:38:14.606295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:38:14.613573 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:38:14.621058 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:38:14.621609 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:38:14.824171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.202 seconds
[0m12:38:14.827030 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:38:14.829291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e24d224e0>]}
[0m12:38:14.830140 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.36s]
[0m12:38:14.831217 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:38:14.833160 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:38:14.833728 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:38:14.834408 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:38:14.837100 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:38:14.835574 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:38:14.838228 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:38:14.839376 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:38:14.843752 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:38:14.844797 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:38:14.852331 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:38:14.853220 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:38:14.859865 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:38:14.860623 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:38:14.865098 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:38:14.866736 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.867753 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.868369 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:38:14.868984 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:38:14.869640 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:38:14.870194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:38:14.882019 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m12:38:14.883252 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m12:38:14.884215 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.885430 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.886439 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:38:14.887405 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:38:14.892075 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.004 seconds
[0m12:38:14.895792 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.896484 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.008 seconds
[0m12:38:14.897259 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:38:14.904044 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.904880 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:38:14.905367 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:38:14.908724 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.909154 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:38:14.909688 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:38:14.914253 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.915536 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:38:14.916264 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:38:14.919132 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:38:14.919684 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:38:14.920148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.921861 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:38:14.922392 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:38:14.922908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.923670 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:38:14.926571 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:38:14.929100 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:38:14.929821 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:38:14.930233 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:38:14.931638 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m12:38:14.934990 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:38:14.935728 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:38:14.936137 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:38:14.937470 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:38:14.939111 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:38:14.939858 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e204ffe90>]}
[0m12:38:14.940580 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.10s]
[0m12:38:14.941655 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:38:14.942342 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:38:14.944390 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:38:14.945091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a549f7-07ff-4f76-8893-41ea8f389229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e204f0a40>]}
[0m12:38:14.945775 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.11s]
[0m12:38:14.946544 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:38:14.949957 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.950471 [debug] [MainThread]: On master: BEGIN
[0m12:38:14.951026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:14.962119 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:38:14.963429 [debug] [MainThread]: On master: COMMIT
[0m12:38:14.964405 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:14.965244 [debug] [MainThread]: On master: COMMIT
[0m12:38:14.966293 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:14.967092 [debug] [MainThread]: On master: Close
[0m12:38:14.968059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:14.968540 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:38:14.969266 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:38:14.970059 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:38:14.970956 [info ] [MainThread]: 
[0m12:38:14.972104 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m12:38:14.975279 [debug] [MainThread]: Command end result
[0m12:38:15.007116 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:38:15.009038 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:38:15.017569 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:38:15.018197 [info ] [MainThread]: 
[0m12:38:15.018868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:15.019621 [info ] [MainThread]: 
[0m12:38:15.020305 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:38:15.022162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.599216, "process_in_blocks": "0", "process_kernel_time": 0.579232, "process_mem_max_rss": "107548", "process_out_blocks": "1792", "process_user_time": 2.764338}
[0m12:38:15.022831 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:15.022688 after 1.60 seconds
[0m12:38:15.023317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e231d9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e230a0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721e23af4ad0>]}
[0m12:38:15.023819 [debug] [MainThread]: Flushing usage events
[0m12:38:16.370807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:14.465509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2deacc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2e4d0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2dfc57c0>]}


============================== 12:39:14.473149 | bd95c972-7a18-4073-807e-38c1f9e8eef1 ==============================
[0m12:39:14.473149 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:39:14.474058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:14.723216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2dde65a0>]}
[0m12:39:14.803703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f53f5c0>]}
[0m12:39:14.804719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:39:14.916822 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:39:15.093864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:15.094338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:15.139388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2c3937d0>]}
[0m12:39:15.244528 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:39:15.247927 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:39:15.279935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2c3c0fe0>]}
[0m12:39:15.280815 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:39:15.281552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2e1c4530>]}
[0m12:39:15.284767 [info ] [MainThread]: 
[0m12:39:15.285558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:15.286190 [info ] [MainThread]: 
[0m12:39:15.287225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:15.296463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:39:15.369455 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:39:15.369924 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:39:15.370317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:15.387680 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m12:39:15.389296 [debug] [ThreadPool]: On list_db: Close
[0m12:39:15.391278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:39:15.397772 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:39:15.398211 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:39:15.398540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:15.409360 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:39:15.410022 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:39:15.410753 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:15.414757 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:39:15.416383 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:39:15.417162 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:39:15.428401 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.429105 [debug] [MainThread]: On master: BEGIN
[0m12:39:15.429650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:15.439962 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:39:15.440527 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.441272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:15.445547 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:39:15.447231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2c2c5d30>]}
[0m12:39:15.447919 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:15.448781 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.449545 [debug] [MainThread]: On master: BEGIN
[0m12:39:15.450871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:15.451824 [debug] [MainThread]: On master: COMMIT
[0m12:39:15.453227 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.453699 [debug] [MainThread]: On master: COMMIT
[0m12:39:15.454504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:15.454948 [debug] [MainThread]: On master: Close
[0m12:39:15.459842 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:39:15.461517 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:39:15.462540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:39:15.463324 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:39:15.473498 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:39:15.474644 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:39:15.522017 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:39:15.522775 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.523191 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:39:15.523602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:15.533029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:39:15.533858 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.534389 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:39:15.541160 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:39:15.549013 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.549499 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:39:15.550639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:15.554544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.555041 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:39:15.556268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:15.581179 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:39:15.581683 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.582054 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:39:15.585594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:39:15.592759 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:39:15.599215 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:39:15.599698 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:39:15.604642 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:39:15.607524 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:39:15.609627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2fb3e600>]}
[0m12:39:15.610444 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.15s]
[0m12:39:15.611511 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:39:15.612997 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:39:15.613830 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:39:15.614457 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:39:15.616466 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:39:15.617198 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:39:15.615305 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:39:15.624128 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:39:15.625018 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:39:15.626037 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:39:15.633171 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:39:15.633971 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:39:15.634455 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:39:15.641570 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:39:15.646304 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:39:15.647426 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.648039 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.648837 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:39:15.649486 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:39:15.650019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:39:15.650525 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:15.661651 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:39:15.662728 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.663429 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m12:39:15.664231 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:39:15.664839 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.665495 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:39:15.669081 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:39:15.675268 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.010 seconds
[0m12:39:15.674792 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.680080 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.681032 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:39:15.681828 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:39:15.682938 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:15.683423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:15.687129 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.690963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.691596 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:39:15.692160 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:39:15.693295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:15.693827 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:15.695721 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:39:15.697612 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:39:15.698211 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.698768 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.699301 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:39:15.699815 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:39:15.702983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:39:15.705627 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:39:15.706106 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:39:15.706959 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:39:15.709491 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:39:15.710078 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:39:15.710879 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:39:15.711572 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:39:15.714580 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:39:15.716389 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:39:15.716946 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:39:15.717950 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2815fb00>]}
[0m12:39:15.719749 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:39:15.720779 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.09s]
[0m12:39:15.722207 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:39:15.723049 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd95c972-7a18-4073-807e-38c1f9e8eef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2b2d4740>]}
[0m12:39:15.724327 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.11s]
[0m12:39:15.725275 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:39:15.728114 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.728635 [debug] [MainThread]: On master: BEGIN
[0m12:39:15.729016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:15.739944 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:39:15.741137 [debug] [MainThread]: On master: COMMIT
[0m12:39:15.742462 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:15.743382 [debug] [MainThread]: On master: COMMIT
[0m12:39:15.744391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:15.744883 [debug] [MainThread]: On master: Close
[0m12:39:15.745601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:15.746072 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:39:15.746431 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:39:15.746770 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:39:15.747479 [info ] [MainThread]: 
[0m12:39:15.748421 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:39:15.750379 [debug] [MainThread]: Command end result
[0m12:39:15.786731 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:39:15.789524 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:39:15.796986 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:39:15.797442 [info ] [MainThread]: 
[0m12:39:15.798006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:15.798635 [info ] [MainThread]: 
[0m12:39:15.799418 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:39:15.800994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4148594, "process_in_blocks": "0", "process_kernel_time": 0.480345, "process_mem_max_rss": "108380", "process_out_blocks": "3392", "process_user_time": 2.790008}
[0m12:39:15.801744 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:15.801549 after 1.42 seconds
[0m12:39:15.802570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2e31eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2f9f44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2e739040>]}
[0m12:39:15.803270 [debug] [MainThread]: Flushing usage events
[0m12:39:15.863588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:17.685047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19444b0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1944a6d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19444b26f0>]}


============================== 12:40:17.692724 | 5366405e-79cb-46a0-ab62-40df65b0b48a ==============================
[0m12:40:17.692724 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:40:17.693423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:40:17.942978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943f96720>]}
[0m12:40:18.040249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19447b4bf0>]}
[0m12:40:18.041353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:40:18.152186 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:40:18.297236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:18.297694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:18.344407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943ee3e30>]}
[0m12:40:18.447818 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:40:18.452254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:40:18.486458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19422e4e30>]}
[0m12:40:18.487292 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:40:18.487931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1942370bf0>]}
[0m12:40:18.490153 [info ] [MainThread]: 
[0m12:40:18.490776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:18.492137 [info ] [MainThread]: 
[0m12:40:18.493252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:18.499978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:40:18.564590 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:40:18.565053 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:40:18.565398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:18.580295 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:40:18.581863 [debug] [ThreadPool]: On list_db: Close
[0m12:40:18.585110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:40:18.591787 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:40:18.592221 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:40:18.592530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:18.603766 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:40:18.604222 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:40:18.604584 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:40:18.609206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:40:18.610816 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:40:18.611594 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:40:18.619902 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:18.620413 [debug] [MainThread]: On master: BEGIN
[0m12:40:18.620746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:18.630272 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:40:18.631281 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:18.632342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:18.638964 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:40:18.641596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19423529c0>]}
[0m12:40:18.642236 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:18.643087 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:18.643549 [debug] [MainThread]: On master: BEGIN
[0m12:40:18.644526 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:40:18.644976 [debug] [MainThread]: On master: COMMIT
[0m12:40:18.645781 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:18.646352 [debug] [MainThread]: On master: COMMIT
[0m12:40:18.647142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:18.647596 [debug] [MainThread]: On master: Close
[0m12:40:18.652927 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:40:18.654456 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:40:18.656091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:40:18.656671 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:40:18.665048 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:40:18.666057 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:40:18.713855 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:40:18.714666 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:18.715115 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:40:18.715476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:18.726512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:40:18.727116 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:18.727563 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:40:18.732208 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m12:40:18.741000 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:18.741487 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:40:18.742418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:40:18.745504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:18.745941 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:40:18.746796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:40:18.772475 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:40:18.772964 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:18.773328 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:40:19.691163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.922 seconds
[0m12:40:19.702950 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:40:19.710538 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:40:19.711110 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:40:20.008511 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.297 seconds
[0m12:40:20.017174 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:40:20.022050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19415a5490>]}
[0m12:40:20.024086 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 1.36s]
[0m12:40:20.026035 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:40:20.029141 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:40:20.031227 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:40:20.032802 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:40:20.035287 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:40:20.036453 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:40:20.037467 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:40:20.038259 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:40:20.039217 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:40:20.044707 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:40:20.049574 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:40:20.050703 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:40:20.054092 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:40:20.054574 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:40:20.058086 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:40:20.058967 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.059479 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:40:20.060001 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.060444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:40:20.060983 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:40:20.061918 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:40:20.072410 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:40:20.073346 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.074132 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:40:20.074825 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m12:40:20.075717 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.076245 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:40:20.078308 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:40:20.083096 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.083618 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.007 seconds
[0m12:40:20.084090 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:40:20.088265 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.089007 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:40:20.089392 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:40:20.092729 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.093176 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:40:20.093652 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:40:20.097737 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.098606 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:40:20.099235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:40:20.102256 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:40:20.102886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:40:20.103403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.105279 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:40:20.105813 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:40:20.106330 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.106947 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:40:20.983589 [debug] [Thread-3 (]: SQL status: COMMIT in 0.876 seconds
[0m12:40:20.984834 [debug] [Thread-4 (]: SQL status: COMMIT in 0.878 seconds
[0m12:40:20.989443 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:40:20.993898 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:40:20.995387 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:40:20.997849 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:40:20.998817 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:40:20.999623 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:40:22.226338 [debug] [Thread-4 (]: SQL status: DROP TABLE in 1.226 seconds
[0m12:40:22.227700 [debug] [Thread-3 (]: SQL status: DROP TABLE in 1.227 seconds
[0m12:40:22.234270 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:40:22.239532 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:40:22.241628 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941515be0>]}
[0m12:40:22.243527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5366405e-79cb-46a0-ab62-40df65b0b48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19403c1160>]}
[0m12:40:22.246314 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 2.20s]
[0m12:40:22.249205 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 2.21s]
[0m12:40:22.250907 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:40:22.252003 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:40:22.256050 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.256930 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.257662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:22.268236 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:40:22.268769 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.269279 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.269703 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.270404 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:22.270820 [debug] [MainThread]: On master: Close
[0m12:40:22.271383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:22.271758 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:40:22.272076 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:40:22.272376 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:40:22.272842 [info ] [MainThread]: 
[0m12:40:22.273881 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m12:40:22.275518 [debug] [MainThread]: Command end result
[0m12:40:22.303295 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:40:22.306044 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:40:22.315054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:40:22.315816 [info ] [MainThread]: 
[0m12:40:22.316481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:22.316957 [info ] [MainThread]: 
[0m12:40:22.317671 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:40:22.319144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7020984, "process_in_blocks": "0", "process_kernel_time": 0.576078, "process_mem_max_rss": "108100", "process_out_blocks": "3392", "process_user_time": 3.156428}
[0m12:40:22.319834 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:22.319676 after 4.70 seconds
[0m12:40:22.320285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19441f0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943ee3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1944410350>]}
[0m12:40:22.320705 [debug] [MainThread]: Flushing usage events
[0m12:40:22.404770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:57.681914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2e9f2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2e9f1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2e9f2ed0>]}


============================== 12:44:57.692610 | 2e010a0b-7182-497c-b6c7-64072cde1590 ==============================
[0m12:44:57.692610 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:44:57.693821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:57.937261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a303576b0>]}
[0m12:44:58.015107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2e8760c0>]}
[0m12:44:58.016063 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:44:58.119916 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:44:58.303411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:58.303874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:58.353795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2cbd5910>]}
[0m12:44:58.458907 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:44:58.462622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:44:58.492035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2c8c8b30>]}
[0m12:44:58.492643 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:44:58.493203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2cbf8aa0>]}
[0m12:44:58.496298 [info ] [MainThread]: 
[0m12:44:58.496893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:44:58.497445 [info ] [MainThread]: 
[0m12:44:58.498287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:44:58.503189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:44:58.566159 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:44:58.566757 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:44:58.567086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:58.579165 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m12:44:58.580827 [debug] [ThreadPool]: On list_db: Close
[0m12:44:58.582688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:44:58.588866 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:44:58.589286 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:44:58.589613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:58.599598 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:44:58.600029 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:44:58.600505 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:44:58.604227 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:44:58.605764 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:44:58.606420 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:44:58.616571 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:58.617240 [debug] [MainThread]: On master: BEGIN
[0m12:44:58.617894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:58.627734 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:44:58.628525 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:58.629729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:44:58.633930 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:44:58.635607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2c8aa3c0>]}
[0m12:44:58.636222 [debug] [MainThread]: On master: ROLLBACK
[0m12:44:58.636975 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:58.637429 [debug] [MainThread]: On master: BEGIN
[0m12:44:58.638525 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:44:58.639214 [debug] [MainThread]: On master: COMMIT
[0m12:44:58.640020 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:58.640428 [debug] [MainThread]: On master: COMMIT
[0m12:44:58.641205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:44:58.641725 [debug] [MainThread]: On master: Close
[0m12:44:58.648370 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:44:58.649249 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:44:58.650170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:44:58.650989 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:44:58.659386 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:44:58.660374 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:44:58.708024 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:44:58.709186 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.709765 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:44:58.710442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:58.720790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:44:58.721320 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.721861 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:44:58.726061 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m12:44:58.734626 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.735209 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:44:58.736190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:58.739547 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.740042 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:44:58.740877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:44:58.765240 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:44:58.765717 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.766089 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:44:58.769738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:44:58.776403 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:44:58.783804 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:44:58.784271 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:44:58.829509 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m12:44:58.832369 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:44:58.835958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a30356810>]}
[0m12:44:58.836974 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 4[0m in 0.18s]
[0m12:44:58.838092 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:44:58.839661 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:44:58.841026 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:44:58.841756 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:44:58.842711 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:44:58.843554 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:44:58.844914 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:44:58.846162 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:44:58.851204 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:44:58.851861 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:44:58.855510 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:44:58.856011 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:44:58.859685 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:44:58.860561 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:44:58.865282 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:44:58.866037 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:58.866776 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:44:58.867306 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:44:58.867815 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.868660 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:44:58.869225 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:44:58.877452 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m12:44:58.878764 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:58.880075 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:44:58.880887 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:44:58.881513 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.882165 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:44:58.885115 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:44:58.885827 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:44:58.890140 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:58.895421 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.896476 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:44:58.897291 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:44:58.898493 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:58.899023 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:58.902093 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.905296 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:58.905889 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:44:58.906478 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:44:58.907440 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:44:58.907862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:58.909657 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:44:58.912611 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:44:58.913283 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.913797 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:58.914359 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:44:58.914863 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:44:58.949345 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m12:44:58.952045 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:44:58.952791 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:44:58.953232 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:44:59.021462 [debug] [Thread-3 (]: SQL status: COMMIT in 0.106 seconds
[0m12:44:59.024113 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:44:59.024842 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:44:59.025255 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:44:59.073951 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.120 seconds
[0m12:44:59.075727 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:44:59.076468 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2ba614f0>]}
[0m12:44:59.077785 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 4[0m in 0.23s]
[0m12:44:59.079401 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:44:59.140556 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.115 seconds
[0m12:44:59.142631 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:44:59.143743 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e010a0b-7182-497c-b6c7-64072cde1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2ba61a30>]}
[0m12:44:59.145260 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.30s]
[0m12:44:59.146649 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:44:59.149054 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:59.149485 [debug] [MainThread]: On master: BEGIN
[0m12:44:59.149832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:59.161281 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:44:59.162519 [debug] [MainThread]: On master: COMMIT
[0m12:44:59.163403 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:59.164150 [debug] [MainThread]: On master: COMMIT
[0m12:44:59.165062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:44:59.165730 [debug] [MainThread]: On master: Close
[0m12:44:59.166400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:59.166867 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:44:59.167351 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:44:59.167912 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:44:59.168728 [info ] [MainThread]: 
[0m12:44:59.169683 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m12:44:59.173086 [debug] [MainThread]: Command end result
[0m12:44:59.208490 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:44:59.212219 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:44:59.220393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:44:59.220884 [info ] [MainThread]: 
[0m12:44:59.221398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:59.221984 [info ] [MainThread]: 
[0m12:44:59.222900 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:44:59.224725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6101525, "process_in_blocks": "0", "process_kernel_time": 0.587681, "process_mem_max_rss": "108228", "process_out_blocks": "3400", "process_user_time": 2.706534}
[0m12:44:59.225402 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:59.225252 after 1.61 seconds
[0m12:44:59.225896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2efd66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2cb53440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a2e9136e0>]}
[0m12:44:59.226427 [debug] [MainThread]: Flushing usage events
[0m12:44:59.292493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:34.041435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920ae8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920ae8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920ae8f50>]}


============================== 12:45:34.048815 | 89aecbc4-af59-4320-9c98-ef65aafb80fa ==============================
[0m12:45:34.048815 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:45:34.049452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:34.293653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920f309e0>]}
[0m12:45:34.369890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920e88380>]}
[0m12:45:34.370839 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:34.479503 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:45:34.612505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:34.619941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:34.663672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791f223740>]}
[0m12:45:34.753761 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:34.756942 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:34.786725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791ef48830>]}
[0m12:45:34.787273 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:45:34.787820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791f242ba0>]}
[0m12:45:34.790033 [info ] [MainThread]: 
[0m12:45:34.790548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:34.791040 [info ] [MainThread]: 
[0m12:45:34.792017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:34.797833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:45:34.857448 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:45:34.857886 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:45:34.858205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:34.869946 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m12:45:34.871585 [debug] [ThreadPool]: On list_db: Close
[0m12:45:34.873705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:45:34.880065 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:34.880502 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:45:34.880808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:34.890297 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:45:34.890846 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:34.891430 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:45:34.895376 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:45:34.897162 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:45:34.897863 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:45:34.906388 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.907031 [debug] [MainThread]: On master: BEGIN
[0m12:45:34.907422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:34.917141 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:45:34.917708 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.918523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:34.923360 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:45:34.925245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791ef23080>]}
[0m12:45:34.925852 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:34.926568 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.927008 [debug] [MainThread]: On master: BEGIN
[0m12:45:34.928151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:45:34.928992 [debug] [MainThread]: On master: COMMIT
[0m12:45:34.929511 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:34.929910 [debug] [MainThread]: On master: COMMIT
[0m12:45:34.930697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:34.931163 [debug] [MainThread]: On master: Close
[0m12:45:34.934962 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:45:34.935777 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:45:34.936619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:45:34.937397 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:45:34.961842 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:45:34.963096 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:45:35.034493 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:45:35.035267 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.035755 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:45:35.036123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:35.045979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:45:35.046692 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.047402 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:45:35.054356 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:45:35.062823 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.063332 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:45:35.064406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:35.067823 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.068329 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:45:35.069200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:45:35.095688 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:45:35.096231 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.096695 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:45:35.099444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:45:35.106584 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:45:35.113449 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:45:35.113945 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:45:35.120074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:45:35.123003 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:45:35.125096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791ef28830>]}
[0m12:45:35.125949 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 4[0m in 0.19s]
[0m12:45:35.127024 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:45:35.128447 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:45:35.129715 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:45:35.130421 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:45:35.131190 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:45:35.132049 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:45:35.132807 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:45:35.133567 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:45:35.138319 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:45:35.139058 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:45:35.142529 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:45:35.143194 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:45:35.143733 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:45:35.147055 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:45:35.150439 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:45:35.151884 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.152413 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:45:35.152911 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.153405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:35.153933 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:45:35.155112 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:35.164195 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:45:35.164728 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.165408 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:45:35.166983 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m12:45:35.167728 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.168355 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:45:35.168875 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m12:45:35.174974 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.175551 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.006 seconds
[0m12:45:35.176207 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:45:35.179957 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.180919 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:45:35.181540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:35.185109 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.185712 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:45:35.186242 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:45:35.190315 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.191034 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:45:35.191480 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:35.193451 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:35.193911 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:45:35.194361 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.196130 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:35.196656 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:35.197153 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.197747 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:35.200456 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:45:35.203435 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:45:35.203992 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:45:35.204858 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:35.207399 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:45:35.207962 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:45:35.208748 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:35.209364 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:45:35.212595 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:45:35.214216 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:45:35.214677 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:45:35.215334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791e1bcb30>]}
[0m12:45:35.217026 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:45:35.217859 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 4[0m in 0.08s]
[0m12:45:35.218969 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:45:35.219738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89aecbc4-af59-4320-9c98-ef65aafb80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791e10d2e0>]}
[0m12:45:35.220951 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.09s]
[0m12:45:35.221934 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:45:35.224279 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:35.224699 [debug] [MainThread]: On master: BEGIN
[0m12:45:35.225054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:35.234853 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:45:35.235701 [debug] [MainThread]: On master: COMMIT
[0m12:45:35.236430 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:35.236794 [debug] [MainThread]: On master: COMMIT
[0m12:45:35.237527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:35.237956 [debug] [MainThread]: On master: Close
[0m12:45:35.238604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:35.238971 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:45:35.239309 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:45:35.239669 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:45:35.240186 [info ] [MainThread]: 
[0m12:45:35.240662 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:45:35.242228 [debug] [MainThread]: Command end result
[0m12:45:35.269565 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:35.271672 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:35.278859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:45:35.279323 [info ] [MainThread]: 
[0m12:45:35.279954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:35.280483 [info ] [MainThread]: 
[0m12:45:35.281024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:45:35.282409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3033904, "process_in_blocks": "0", "process_kernel_time": 0.662612, "process_mem_max_rss": "108220", "process_out_blocks": "3400", "process_user_time": 2.859271}
[0m12:45:35.283013 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:35.282888 after 1.30 seconds
[0m12:45:35.283449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7379242528d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73791f2886b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737920a27590>]}
[0m12:45:35.283934 [debug] [MainThread]: Flushing usage events
[0m12:45:35.347718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:05.771320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e590adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e43b0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e3a9bbf0>]}


============================== 13:30:05.814816 | 8cffc3fc-33fc-4075-9900-406b7f8fc8d6 ==============================
[0m13:30:05.814816 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:30:05.815748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:30:07.396878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e3757e90>]}
[0m13:30:07.482716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e37570b0>]}
[0m13:30:07.483792 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:30:07.836163 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:30:08.923233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:08.923707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:08.971634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e1f658e0>]}
[0m13:30:09.069019 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:30:09.141729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:30:09.323070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e1cdf980>]}
[0m13:30:09.324042 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:30:09.324894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e1e97b90>]}
[0m13:30:09.328223 [info ] [MainThread]: 
[0m13:30:09.329026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:09.329728 [info ] [MainThread]: 
[0m13:30:09.330837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:09.338304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:30:09.568252 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:30:09.568840 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:30:09.569309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:09.724862 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.155 seconds
[0m13:30:09.726497 [debug] [ThreadPool]: On list_db: Close
[0m13:30:09.727541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m13:30:09.728186 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m13:30:09.733952 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m13:30:09.734457 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m13:30:09.734803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:09.744913 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:30:09.745360 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m13:30:09.745698 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m13:30:09.746937 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:30:09.748034 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m13:30:09.748380 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m13:30:09.748720 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m13:30:09.751564 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m13:30:09.752038 [debug] [ThreadPool]: On create_db_dev: Close
[0m13:30:09.753841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m13:30:09.759844 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:30:09.760268 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:30:09.760573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:09.770778 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:30:09.771253 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:30:09.771590 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:30:09.776659 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:30:09.778131 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:30:09.778796 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:30:09.783898 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.784358 [debug] [MainThread]: On master: BEGIN
[0m13:30:09.784694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:09.793697 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:30:09.794212 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.794654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:09.799100 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:30:09.800787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e1cdef30>]}
[0m13:30:09.801307 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:09.801992 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.802375 [debug] [MainThread]: On master: BEGIN
[0m13:30:09.803307 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:30:09.803699 [debug] [MainThread]: On master: COMMIT
[0m13:30:09.804037 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.804367 [debug] [MainThread]: On master: COMMIT
[0m13:30:09.804984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:09.805355 [debug] [MainThread]: On master: Close
[0m13:30:09.809438 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m13:30:09.810183 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m13:30:09.810804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m13:30:09.811246 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m13:30:09.819861 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m13:30:09.820740 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m13:30:09.864501 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m13:30:09.865322 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:30:09.865746 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m13:30:09.866165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:09.875878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:30:09.876490 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:30:09.876935 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m13:30:09.904853 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m13:30:09.905456 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m13:30:09.906325 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m13:30:09.963921 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:30:09.968459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cffc3fc-33fc-4075-9900-406b7f8fc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e4306390>]}
[0m13:30:09.969494 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.15s]
[0m13:30:09.970296 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m13:30:09.970990 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m13:30:09.972528 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:30:09.973121 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:30:09.974102 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m13:30:09.975006 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m13:30:09.975785 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:30:09.976534 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:30:09.979517 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.979989 [debug] [MainThread]: On master: BEGIN
[0m13:30:09.980362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:09.990846 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:30:09.991343 [debug] [MainThread]: On master: COMMIT
[0m13:30:09.991698 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:09.992038 [debug] [MainThread]: On master: COMMIT
[0m13:30:09.992701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:09.993090 [debug] [MainThread]: On master: Close
[0m13:30:09.993652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:09.994110 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m13:30:09.994591 [info ] [MainThread]: 
[0m13:30:09.995059 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m13:30:09.996083 [debug] [MainThread]: Command end result
[0m13:30:10.020846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:30:10.022808 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:30:10.029631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:30:10.030096 [info ] [MainThread]: 
[0m13:30:10.030572 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:30:10.031025 [info ] [MainThread]: 
[0m13:30:10.031627 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:30:10.032052 [info ] [MainThread]: 
[0m13:30:10.032616 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m13:30:10.077017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5080295, "process_in_blocks": "84016", "process_kernel_time": 0.887818, "process_mem_max_rss": "106900", "process_out_blocks": "3336", "process_user_time": 3.379439}
[0m13:30:10.077678 [debug] [MainThread]: Command `dbt run` failed at 13:30:10.077551 after 4.51 seconds
[0m13:30:10.078156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e6f668a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e4324f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80e4b187a0>]}
[0m13:30:10.078602 [debug] [MainThread]: Flushing usage events
[0m13:30:11.432350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:48.337661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdd832840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdcba4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdc446e70>]}


============================== 13:32:48.359137 | 9cd5e7db-f043-4fa4-94dc-17eadff89399 ==============================
[0m13:32:48.359137 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:48.361202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:48.770273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdbf92660>]}
[0m13:32:48.870593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdbeacf50>]}
[0m13:32:48.871558 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:49.031489 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:49.225992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:49.226459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:49.273867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cda642ea0>]}
[0m13:32:49.388849 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:49.391719 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:49.423678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cda368ad0>]}
[0m13:32:49.424280 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:32:49.424822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cda6625d0>]}
[0m13:32:49.427020 [info ] [MainThread]: 
[0m13:32:49.427552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:49.428078 [info ] [MainThread]: 
[0m13:32:49.429118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:49.435326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:32:49.495258 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:32:49.495705 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:32:49.496042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:49.511876 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m13:32:49.513539 [debug] [ThreadPool]: On list_db: Close
[0m13:32:49.515641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:32:49.522878 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:32:49.523419 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:32:49.523857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:49.533681 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:49.534385 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:32:49.535314 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:32:49.540798 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:32:49.542637 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:32:49.543384 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:32:49.549218 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.549731 [debug] [MainThread]: On master: BEGIN
[0m13:32:49.550103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:49.560800 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:32:49.561640 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.562360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:49.567626 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:32:49.570321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdf6468a0>]}
[0m13:32:49.571162 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:49.571985 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.572453 [debug] [MainThread]: On master: BEGIN
[0m13:32:49.573540 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:32:49.574035 [debug] [MainThread]: On master: COMMIT
[0m13:32:49.574424 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.574812 [debug] [MainThread]: On master: COMMIT
[0m13:32:49.575521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:49.575932 [debug] [MainThread]: On master: Close
[0m13:32:49.580040 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m13:32:49.580743 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m13:32:49.581443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m13:32:49.581940 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m13:32:49.590982 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m13:32:49.591918 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m13:32:49.644238 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m13:32:49.645115 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:32:49.645548 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m13:32:49.645946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:49.656318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:32:49.657211 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:32:49.657974 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m13:32:49.659303 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m13:32:49.660057 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m13:32:49.661095 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m13:32:49.667332 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:32:49.670507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd5e7db-f043-4fa4-94dc-17eadff89399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cd95aa540>]}
[0m13:32:49.671639 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.09s]
[0m13:32:49.672767 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m13:32:49.673678 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m13:32:49.675347 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:32:49.676171 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:32:49.676717 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m13:32:49.678162 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m13:32:49.679168 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:32:49.679970 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:32:49.683646 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.684144 [debug] [MainThread]: On master: BEGIN
[0m13:32:49.684508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:49.694214 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:32:49.695117 [debug] [MainThread]: On master: COMMIT
[0m13:32:49.696059 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:49.697001 [debug] [MainThread]: On master: COMMIT
[0m13:32:49.698753 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:32:49.699366 [debug] [MainThread]: On master: Close
[0m13:32:49.700099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:49.700506 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m13:32:49.701030 [info ] [MainThread]: 
[0m13:32:49.701574 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:32:49.702826 [debug] [MainThread]: Command end result
[0m13:32:49.828841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:49.831420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:49.844918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:32:49.845528 [info ] [MainThread]: 
[0m13:32:49.846147 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:49.846713 [info ] [MainThread]: 
[0m13:32:49.847367 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:32:49.847816 [info ] [MainThread]: 
[0m13:32:49.848371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m13:32:49.849775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6900414, "process_in_blocks": "0", "process_kernel_time": 0.74764, "process_mem_max_rss": "107380", "process_out_blocks": "3336", "process_user_time": 4.62251}
[0m13:32:49.850384 [debug] [MainThread]: Command `dbt run` failed at 13:32:49.850256 after 1.69 seconds
[0m13:32:49.850815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdde7c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdbedbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cdbfc1250>]}
[0m13:32:49.851268 [debug] [MainThread]: Flushing usage events
[0m13:32:49.907244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:01.068286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346c71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346ecf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346c71250>]}


============================== 13:34:01.116134 | 04339b05-84d0-4b30-8c84-aabf45a935c6 ==============================
[0m13:34:01.116134 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:34:01.118640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:02.163343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346bb3440>]}
[0m13:34:02.398591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763347468770>]}
[0m13:34:02.400876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:02.781219 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:34:03.149614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:03.150939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:03.290046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346bb3740>]}
[0m13:34:03.544010 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:34:03.550138 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:34:03.620112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76334511a6c0>]}
[0m13:34:03.621109 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:34:03.622235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7633450c6540>]}
[0m13:34:03.632593 [info ] [MainThread]: 
[0m13:34:03.634262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:03.635451 [info ] [MainThread]: 
[0m13:34:03.637327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:03.655190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:34:03.801084 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:34:03.802093 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:03.802916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:03.838893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m13:34:03.842764 [debug] [ThreadPool]: On list_db: Close
[0m13:34:03.846709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:34:03.864951 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:34:03.866335 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:34:03.867798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:03.890718 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:34:03.892292 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:34:03.894016 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:34:03.912415 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m13:34:03.915559 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:34:03.916829 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:34:03.934918 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:03.936291 [debug] [MainThread]: On master: BEGIN
[0m13:34:03.937512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:03.962932 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m13:34:03.964759 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:03.967157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:03.979555 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:34:03.985519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763346bffa40>]}
[0m13:34:03.987416 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:03.988852 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:03.990118 [debug] [MainThread]: On master: BEGIN
[0m13:34:03.995611 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:03.997108 [debug] [MainThread]: On master: COMMIT
[0m13:34:03.998154 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:03.999013 [debug] [MainThread]: On master: COMMIT
[0m13:34:04.000299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:04.001115 [debug] [MainThread]: On master: Close
[0m13:34:04.012132 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m13:34:04.014202 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m13:34:04.016202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m13:34:04.019420 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m13:34:04.043151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m13:34:04.045770 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m13:34:04.179501 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m13:34:04.183148 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:34:04.184507 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m13:34:04.185903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:04.206895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:34:04.209651 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m13:34:04.211712 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m13:34:04.216186 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m13:34:04.218408 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m13:34:04.221389 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m13:34:04.252387 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:34:04.260458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04339b05-84d0-4b30-8c84-aabf45a935c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763347736960>]}
[0m13:34:04.264155 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.24s]
[0m13:34:04.274754 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m13:34:04.277581 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m13:34:04.294617 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:34:04.297154 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:34:04.302876 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m13:34:04.299701 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m13:34:04.305626 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:34:04.311234 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:34:04.322728 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:04.324274 [debug] [MainThread]: On master: BEGIN
[0m13:34:04.325724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:04.361514 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:34:04.363845 [debug] [MainThread]: On master: COMMIT
[0m13:34:04.366107 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:04.367719 [debug] [MainThread]: On master: COMMIT
[0m13:34:04.369968 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:34:04.371579 [debug] [MainThread]: On master: Close
[0m13:34:04.373395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:04.374952 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m13:34:04.376930 [info ] [MainThread]: 
[0m13:34:04.380485 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m13:34:04.385219 [debug] [MainThread]: Command end result
[0m13:34:08.504848 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:34:08.509983 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:34:08.543114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:34:08.544218 [info ] [MainThread]: 
[0m13:34:08.546602 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:08.548510 [info ] [MainThread]: 
[0m13:34:08.550412 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m13:34:08.552348 [info ] [MainThread]: 
[0m13:34:08.554166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m13:34:08.558261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.7340746, "process_in_blocks": "0", "process_kernel_time": 1.332117, "process_mem_max_rss": "107488", "process_out_blocks": "3336", "process_user_time": 8.331863}
[0m13:34:08.560228 [debug] [MainThread]: Command `dbt run` failed at 13:34:08.559775 after 7.74 seconds
[0m13:34:08.561661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763347757f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763347736960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763347f90290>]}
[0m13:34:08.563372 [debug] [MainThread]: Flushing usage events
[0m13:34:08.710467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:45.502582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b98542930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b983bfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b99374a70>]}


============================== 13:48:45.512312 | 3464d1a5-d62c-4b99-9e74-14075ab89ae1 ==============================
[0m13:48:45.512312 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:48:45.513222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:48:45.868680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3464d1a5-d62c-4b99-9e74-14075ab89ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b97dd2630>]}
[0m13:48:45.945749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3464d1a5-d62c-4b99-9e74-14075ab89ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b97fc7ec0>]}
[0m13:48:45.946708 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:46.059202 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:48:46.191724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:46.192193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:46.237913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3464d1a5-d62c-4b99-9e74-14075ab89ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b965ca810>]}
[0m13:48:46.326288 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:48:46.329157 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:48:46.357457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3464d1a5-d62c-4b99-9e74-14075ab89ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b962c8860>]}
[0m13:48:46.358081 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:48:46.358634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3464d1a5-d62c-4b99-9e74-14075ab89ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b962c6570>]}
[0m13:48:46.361317 [info ] [MainThread]: 
[0m13:48:46.361958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:48:46.362930 [info ] [MainThread]: 
[0m13:48:46.364400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:48:46.372372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:48:46.436606 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:48:46.437048 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:48:46.437374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:46.439502 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m13:48:46.440811 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:48:46.441185 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:48:46.441570 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:48:46.441890 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:48:46.442313 [debug] [ThreadPool]: On list_db: No close available on handle
[0m13:48:46.443168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:46.443515 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:48:46.443855 [info ] [MainThread]: 
[0m13:48:46.444310 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m13:48:46.445159 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m13:48:46.447150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0201317, "process_in_blocks": "0", "process_kernel_time": 0.456386, "process_mem_max_rss": "103636", "process_out_blocks": "2472", "process_user_time": 2.406036}
[0m13:48:46.447989 [debug] [MainThread]: Command `dbt run` failed at 13:48:46.447777 after 1.02 seconds
[0m13:48:46.448609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b9815c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b96391c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2b962c7cb0>]}
[0m13:48:46.449358 [debug] [MainThread]: Flushing usage events
[0m13:48:47.796285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:32.995905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb2543320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb25fc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb25437a0>]}


============================== 13:57:33.006943 | 1cfdea46-4339-4e62-a4a6-5652188344fc ==============================
[0m13:57:33.006943 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:57:33.007934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:57:33.314925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cfdea46-4339-4e62-a4a6-5652188344fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb20ac140>]}
[0m13:57:33.403919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cfdea46-4339-4e62-a4a6-5652188344fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb27410d0>]}
[0m13:57:33.404942 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:33.524107 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:57:33.691469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:33.692193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:33.755886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cfdea46-4339-4e62-a4a6-5652188344fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb0759b20>]}
[0m13:57:33.885814 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:57:33.891435 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:57:33.935125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cfdea46-4339-4e62-a4a6-5652188344fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb043f290>]}
[0m13:57:33.935944 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:57:33.936526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfdea46-4339-4e62-a4a6-5652188344fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb2ba4ef0>]}
[0m13:57:33.939438 [info ] [MainThread]: 
[0m13:57:33.940347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:33.941145 [info ] [MainThread]: 
[0m13:57:33.942414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:33.953218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:57:34.029440 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:57:34.030011 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:57:34.030557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:34.033354 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.18.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m13:57:34.034820 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:57:34.035271 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:57:34.035931 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:57:34.036352 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:57:34.036793 [debug] [ThreadPool]: On list_db: No close available on handle
[0m13:57:34.037753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:34.038230 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:57:34.038703 [info ] [MainThread]: 
[0m13:57:34.039349 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m13:57:34.040648 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.18.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m13:57:34.042776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1283246, "process_in_blocks": "0", "process_kernel_time": 0.637365, "process_mem_max_rss": "103676", "process_out_blocks": "2464", "process_user_time": 3.038511}
[0m13:57:34.044066 [debug] [MainThread]: Command `dbt run` failed at 13:57:34.043736 after 1.13 seconds
[0m13:57:34.045100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb2376c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3baf8c14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bb0780cb0>]}
[0m13:57:34.046340 [debug] [MainThread]: Flushing usage events
[0m13:57:34.181605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:32.885599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b73ee180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b73eda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b72d4bc0>]}


============================== 16:47:32.906285 | ea7d9563-8bd0-449f-8027-e5e4273cda05 ==============================
[0m16:47:32.906285 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:47:32.907217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:33.679384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b6f2e630>]}
[0m16:47:33.757089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b74ca3c0>]}
[0m16:47:33.761860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:47:33.912722 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:47:34.391513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:34.392177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:34.438748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b713f710>]}
[0m16:47:34.530143 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:47:34.534253 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:47:34.624888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b555edb0>]}
[0m16:47:34.625464 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:47:34.626052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b554c0e0>]}
[0m16:47:34.628339 [info ] [MainThread]: 
[0m16:47:34.629006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:34.629775 [info ] [MainThread]: 
[0m16:47:34.631067 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:34.636815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:47:34.849135 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:47:34.849711 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:47:34.850173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:35.039300 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.189 seconds
[0m16:47:35.042939 [debug] [ThreadPool]: On list_db: Close
[0m16:47:35.045164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m16:47:35.046613 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m16:47:35.055832 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m16:47:35.056446 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m16:47:35.057103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:35.069248 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:47:35.069687 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m16:47:35.070014 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m16:47:35.071195 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:47:35.072265 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m16:47:35.072600 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m16:47:35.072928 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m16:47:35.076460 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m16:47:35.077028 [debug] [ThreadPool]: On create_db_dev: Close
[0m16:47:35.079077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m16:47:35.085058 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:47:35.085482 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:47:35.085790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:35.094885 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:47:35.095310 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:47:35.095652 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:47:35.099758 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:47:35.101148 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:47:35.101832 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:47:35.106993 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.107464 [debug] [MainThread]: On master: BEGIN
[0m16:47:35.107824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:35.117220 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:47:35.117699 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.118133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:35.122280 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:47:35.123971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b79c7e60>]}
[0m16:47:35.124534 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:35.125275 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.125661 [debug] [MainThread]: On master: BEGIN
[0m16:47:35.126546 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:47:35.126980 [debug] [MainThread]: On master: COMMIT
[0m16:47:35.127327 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.127657 [debug] [MainThread]: On master: COMMIT
[0m16:47:35.128255 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:35.128629 [debug] [MainThread]: On master: Close
[0m16:47:35.132372 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m16:47:35.133041 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m16:47:35.133568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m16:47:35.134044 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m16:47:35.142868 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m16:47:35.144231 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m16:47:35.190742 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m16:47:35.191558 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m16:47:35.191965 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m16:47:35.192322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:35.202353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:47:35.202876 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m16:47:35.203281 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m16:47:35.210879 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m16:47:35.211529 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m16:47:35.212289 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m16:47:35.258103 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m16:47:35.263651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7d9563-8bd0-449f-8027-e5e4273cda05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b79a60f0>]}
[0m16:47:35.264755 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.13s]
[0m16:47:35.265732 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m16:47:35.266572 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m16:47:35.268534 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:47:35.269073 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:47:35.269751 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m16:47:35.270409 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m16:47:35.271252 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:47:35.271920 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:47:35.275076 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.275595 [debug] [MainThread]: On master: BEGIN
[0m16:47:35.276371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:35.287573 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:47:35.288262 [debug] [MainThread]: On master: COMMIT
[0m16:47:35.289156 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:35.289655 [debug] [MainThread]: On master: COMMIT
[0m16:47:35.290462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:35.291179 [debug] [MainThread]: On master: Close
[0m16:47:35.292099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:35.292840 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m16:47:35.293830 [info ] [MainThread]: 
[0m16:47:35.295133 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m16:47:35.297954 [debug] [MainThread]: Command end result
[0m16:47:35.330981 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:47:35.333089 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:47:35.340070 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:47:35.340511 [info ] [MainThread]: 
[0m16:47:35.341036 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:47:35.341669 [info ] [MainThread]: 
[0m16:47:35.342420 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m16:47:35.342965 [info ] [MainThread]: 
[0m16:47:35.344084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m16:47:35.347516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6245844, "process_in_blocks": "22336", "process_kernel_time": 0.513945, "process_mem_max_rss": "107208", "process_out_blocks": "3344", "process_user_time": 2.690428}
[0m16:47:35.348250 [debug] [MainThread]: Command `dbt run` failed at 16:47:35.348104 after 2.63 seconds
[0m16:47:35.348723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1ba61e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b74554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1b7456ea0>]}
[0m16:47:35.349169 [debug] [MainThread]: Flushing usage events
[0m16:47:36.144345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:46.922863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a0c66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518bb2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a05f0e0>]}


============================== 16:51:46.930549 | eca3b7da-1018-45b7-b45f-9f413e67f2da ==============================
[0m16:51:46.930549 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:51:46.931145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:51:47.174040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a4e2660>]}
[0m16:51:47.246867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5189ba4b60>]}
[0m16:51:47.247750 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:51:47.353415 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:51:47.484019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:51:47.484495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:51:47.527982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51882914c0>]}
[0m16:51:47.616838 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:51:47.619673 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:51:47.648845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5187f5f5f0>]}
[0m16:51:47.649476 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:51:47.649938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51880a90a0>]}
[0m16:51:47.651959 [info ] [MainThread]: 
[0m16:51:47.652424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:51:47.652928 [info ] [MainThread]: 
[0m16:51:47.653722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:47.660725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:51:47.722781 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:51:47.723285 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:51:47.723656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:47.736667 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m16:51:47.738184 [debug] [ThreadPool]: On list_db: Close
[0m16:51:47.740030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:51:47.746862 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:51:47.747281 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:51:47.747621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:47.756688 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:51:47.757142 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:51:47.757480 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:51:47.761114 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m16:51:47.762493 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:51:47.763141 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:51:47.768509 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.769041 [debug] [MainThread]: On master: BEGIN
[0m16:51:47.769460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:47.779527 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:51:47.780036 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.780514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:47.784948 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:51:47.786964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518b8d05c0>]}
[0m16:51:47.787588 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:47.788387 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.788797 [debug] [MainThread]: On master: BEGIN
[0m16:51:47.790015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:51:47.790555 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.790973 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.791387 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.792326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:47.792922 [debug] [MainThread]: On master: Close
[0m16:51:47.797123 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m16:51:47.797997 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m16:51:47.798583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m16:51:47.799048 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m16:51:47.807971 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m16:51:47.809027 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m16:51:47.860350 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m16:51:47.861152 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m16:51:47.861706 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m16:51:47.862131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:47.873524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:51:47.874042 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m16:51:47.874506 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m16:51:47.875663 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m16:51:47.876122 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m16:51:47.876891 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m16:51:47.881228 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m16:51:47.883166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca3b7da-1018-45b7-b45f-9f413e67f2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51882b41a0>]}
[0m16:51:47.883900 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.08s]
[0m16:51:47.884630 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m16:51:47.885422 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m16:51:47.887355 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:51:47.887994 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:51:47.888536 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m16:51:47.889386 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m16:51:47.890250 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:51:47.891079 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:51:47.894284 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.894846 [debug] [MainThread]: On master: BEGIN
[0m16:51:47.895352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:47.908652 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:51:47.909386 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.909811 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:47.910205 [debug] [MainThread]: On master: COMMIT
[0m16:51:47.910896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:47.911373 [debug] [MainThread]: On master: Close
[0m16:51:47.912057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:47.912465 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m16:51:47.913059 [info ] [MainThread]: 
[0m16:51:47.913836 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m16:51:47.915706 [debug] [MainThread]: Command end result
[0m16:51:47.949654 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:51:47.951598 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:51:47.959961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:51:47.960418 [info ] [MainThread]: 
[0m16:51:47.960968 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:51:47.961766 [info ] [MainThread]: 
[0m16:51:47.962499 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m16:51:47.963086 [info ] [MainThread]: 
[0m16:51:47.963776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m16:51:47.965216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.100172, "process_in_blocks": "0", "process_kernel_time": 0.468428, "process_mem_max_rss": "107532", "process_out_blocks": "3336", "process_user_time": 2.318322}
[0m16:51:47.965960 [debug] [MainThread]: Command `dbt run` failed at 16:51:47.965821 after 1.10 seconds
[0m16:51:47.966419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a116e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a6a8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518a0c6ff0>]}
[0m16:51:47.966871 [debug] [MainThread]: Flushing usage events
[0m16:51:48.984387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:59.829958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516ddff980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516dc69d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516dc0ec60>]}


============================== 17:13:59.839552 | 079f3793-0bfb-42d9-903d-9b73681876de ==============================
[0m17:13:59.839552 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:13:59.840839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:14:00.156609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '079f3793-0bfb-42d9-903d-9b73681876de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516d29b050>]}
[0m17:13:59.908419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '079f3793-0bfb-42d9-903d-9b73681876de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516d153860>]}
[0m17:13:59.909379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:00.028539 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:13:59.539625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:59.540110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:59.587358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '079f3793-0bfb-42d9-903d-9b73681876de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516b969b80>]}
[0m17:14:00.406791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:14:00.409736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:14:00.439376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '079f3793-0bfb-42d9-903d-9b73681876de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516b715280>]}
[0m17:14:00.440020 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:14:00.440529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079f3793-0bfb-42d9-903d-9b73681876de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516b666660>]}
[0m17:14:00.443158 [info ] [MainThread]: 
[0m17:14:00.443734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:00.444263 [info ] [MainThread]: 
[0m17:14:00.445390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:00.451762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:14:00.514307 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:14:00.514760 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:14:00.515094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:00.517476 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:14:00.519236 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:14:00.519742 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:14:00.520194 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:14:00.520536 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:14:00.520905 [debug] [ThreadPool]: On list_db: No close available on handle
[0m17:14:00.521951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:00.522503 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m17:14:00.523152 [info ] [MainThread]: 
[0m17:14:00.523684 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m17:14:00.524584 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m17:14:00.526377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7536366, "process_in_blocks": "0", "process_kernel_time": 0.475078, "process_mem_max_rss": "103220", "process_out_blocks": "2464", "process_user_time": 2.641898}
[0m17:14:00.527241 [debug] [MainThread]: Command `dbt run` failed at 17:14:00.527060 after 1.75 seconds
[0m17:14:00.527881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5170976870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516d7598e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d516b685b50>]}
[0m17:14:00.528568 [debug] [MainThread]: Flushing usage events
[0m17:14:02.875281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:43.798271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b720eebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b72293470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b72290980>]}


============================== 17:19:43.808148 | e27744c7-5942-4e2f-b407-7d261e0a64d3 ==============================
[0m17:19:43.808148 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:19:43.808788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:19:44.120132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b71c06450>]}
[0m17:19:44.225571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b6fca30b0>]}
[0m17:19:44.226575 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:19:44.347993 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:19:44.530114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:44.530607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:44.591693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b6fca22d0>]}
[0m17:19:44.699057 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:19:44.702142 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:19:44.740010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b6fba69c0>]}
[0m17:19:44.740728 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:19:44.741338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b716733b0>]}
[0m17:19:44.744343 [info ] [MainThread]: 
[0m17:19:44.745054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:44.747236 [info ] [MainThread]: 
[0m17:19:44.749626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:44.758624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:19:44.814621 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:19:44.815080 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:19:44.815446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:44.832990 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m17:19:44.834758 [debug] [ThreadPool]: On list_db: Close
[0m17:19:44.835901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m17:19:44.837097 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m17:19:44.843963 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:19:44.844397 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m17:19:44.844722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:44.855146 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:19:44.855792 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:19:44.856196 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m17:19:44.857519 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m17:19:44.858661 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m17:19:44.859036 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:19:44.859445 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m17:19:44.862641 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m17:19:44.863217 [debug] [ThreadPool]: On create_db_dev: Close
[0m17:19:44.865747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m17:19:44.877169 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:19:44.877828 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:19:44.878352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:44.888764 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:19:44.889854 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:19:44.891086 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:19:44.896692 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m17:19:44.898498 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:19:44.899558 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:19:44.905439 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:44.906234 [debug] [MainThread]: On master: BEGIN
[0m17:19:44.906655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:44.918137 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:19:44.918720 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:44.919586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:44.924216 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m17:19:44.926062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b7152d640>]}
[0m17:19:44.926837 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:44.927796 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:44.928320 [debug] [MainThread]: On master: BEGIN
[0m17:19:44.929710 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:19:44.930611 [debug] [MainThread]: On master: COMMIT
[0m17:19:44.931552 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:44.932241 [debug] [MainThread]: On master: COMMIT
[0m17:19:44.933271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:44.934034 [debug] [MainThread]: On master: Close
[0m17:19:44.938732 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m17:19:44.939869 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m17:19:44.940894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m17:19:44.941667 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m17:19:44.952772 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m17:19:44.953772 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m17:19:45.005715 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m17:19:45.007020 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:19:45.007657 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m17:19:45.008069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:45.017764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:19:45.018723 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:19:45.019254 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m17:19:45.020815 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m17:19:45.021630 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m17:19:45.022794 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m17:19:45.032225 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m17:19:45.036469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27744c7-5942-4e2f-b407-7d261e0a64d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b6ec926c0>]}
[0m17:19:45.037776 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.09s]
[0m17:19:45.039138 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m17:19:45.040973 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m17:19:45.044395 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:19:45.046726 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m17:19:45.047983 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:19:45.045446 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:19:45.049435 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m17:19:45.050541 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:19:45.056934 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:45.058069 [debug] [MainThread]: On master: BEGIN
[0m17:19:45.059532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:45.074188 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m17:19:45.074981 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.075800 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:45.076674 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.077867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:45.078553 [debug] [MainThread]: On master: Close
[0m17:19:45.079361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:45.080038 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m17:19:45.081627 [info ] [MainThread]: 
[0m17:19:45.084056 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:19:45.086993 [debug] [MainThread]: Command end result
[0m17:19:45.119555 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:19:45.121484 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:19:45.128810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:19:45.129281 [info ] [MainThread]: 
[0m17:19:45.130109 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:19:45.131412 [info ] [MainThread]: 
[0m17:19:45.132385 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m17:19:45.133204 [info ] [MainThread]: 
[0m17:19:45.133912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:19:45.136166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4258767, "process_in_blocks": "0", "process_kernel_time": 0.550566, "process_mem_max_rss": "107412", "process_out_blocks": "3336", "process_user_time": 3.172497}
[0m17:19:45.137703 [debug] [MainThread]: Command `dbt run` failed at 17:19:45.137291 after 1.43 seconds
[0m17:19:45.139015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b71ee8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b720ec0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773b6fa2f560>]}
[0m17:19:45.139882 [debug] [MainThread]: Flushing usage events
[0m17:19:46.488845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:06.399248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96ee57e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96ee57da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96ee57860>]}


============================== 17:25:06.407255 | dc6ec679-73a3-4493-852d-c6aec79e4572 ==============================
[0m17:25:06.407255 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:25:06.407985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:06.695375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96ef00ad0>]}
[0m17:25:06.775381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96f0ca7e0>]}
[0m17:25:06.776364 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:25:06.897511 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:25:07.051367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:07.051828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:07.099437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96d5bfb90>]}
[0m17:25:07.199073 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:25:07.202022 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:25:07.232699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96d32f2c0>]}
[0m17:25:07.233414 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:25:07.233998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96d3e33e0>]}
[0m17:25:07.236352 [info ] [MainThread]: 
[0m17:25:07.237018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:07.237640 [info ] [MainThread]: 
[0m17:25:07.238692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:07.244235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:25:07.302103 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:25:07.302580 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:25:07.302931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:07.314806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m17:25:07.316601 [debug] [ThreadPool]: On list_db: Close
[0m17:25:07.318650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m17:25:07.324895 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:25:07.325375 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:25:07.325695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:07.335328 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:25:07.335816 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:25:07.336285 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:25:07.340098 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m17:25:07.341664 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:25:07.342352 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:25:07.348021 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.348499 [debug] [MainThread]: On master: BEGIN
[0m17:25:07.348925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:07.358805 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:25:07.359283 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.359759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:07.363638 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:25:07.365347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc970c14650>]}
[0m17:25:07.365871 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:07.366733 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.367216 [debug] [MainThread]: On master: BEGIN
[0m17:25:07.368326 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:25:07.368772 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.369229 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.369575 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.370211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:07.370597 [debug] [MainThread]: On master: Close
[0m17:25:07.374602 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m17:25:07.375376 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m17:25:07.376234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m17:25:07.376876 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m17:25:07.386711 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m17:25:07.387648 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m17:25:07.454799 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m17:25:07.455773 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:07.456255 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m17:25:07.456667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:07.467305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:25:07.467888 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:07.468532 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m17:25:07.473576 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:25:07.481264 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:07.481858 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m17:25:07.482971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:07.524027 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m17:25:07.525302 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:07.525878 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m17:25:07.576657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m17:25:07.586913 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m17:25:07.594826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:07.595425 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m17:25:07.596758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:25:07.601517 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m17:25:07.606834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc970d5e5a0>]}
[0m17:25:07.608354 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 1[0m in 0.23s]
[0m17:25:07.610232 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m17:25:07.613113 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:25:07.614447 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:25:07.615784 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m17:25:07.617139 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m17:25:07.618592 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m17:25:07.619887 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m17:25:07.621029 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m17:25:07.621945 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m17:25:07.628547 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m17:25:07.636630 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m17:25:07.638372 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m17:25:07.639150 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m17:25:07.645794 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m17:25:07.650717 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m17:25:07.652133 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:07.653269 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:07.653929 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m17:25:07.655109 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m17:25:07.656413 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:07.658009 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:25:07.671410 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m17:25:07.672273 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:07.673317 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m17:25:07.674829 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m17:25:07.675405 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:07.676019 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m17:25:07.679806 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:25:07.680612 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:25:07.686823 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:07.690658 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:07.691446 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m17:25:07.692119 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m17:25:07.693643 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:07.694384 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:07.696811 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:25:07.699135 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:25:07.699805 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:07.700342 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:07.700928 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:25:07.701514 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:25:07.759362 [debug] [Thread-4 (]: SQL status: COMMIT in 0.057 seconds
[0m17:25:07.764299 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m17:25:07.765094 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m17:25:07.766193 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:07.770111 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m17:25:07.771181 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m17:25:07.772960 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:07.774798 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m17:25:07.775781 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:25:07.777865 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m17:25:07.778331 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:25:07.781245 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m17:25:07.782362 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96c375a30>]}
[0m17:25:07.783534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6ec679-73a3-4493-852d-c6aec79e4572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96c390830>]}
[0m17:25:07.784973 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m17:25:07.786571 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.17s]
[0m17:25:07.787892 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:25:07.789265 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:25:07.792437 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.793081 [debug] [MainThread]: On master: BEGIN
[0m17:25:07.793467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:07.803188 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:25:07.803722 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.804128 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:07.804499 [debug] [MainThread]: On master: COMMIT
[0m17:25:07.805253 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:07.805758 [debug] [MainThread]: On master: Close
[0m17:25:07.806410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:07.806838 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m17:25:07.807190 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m17:25:07.807534 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m17:25:07.808026 [info ] [MainThread]: 
[0m17:25:07.808616 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m17:25:07.810392 [debug] [MainThread]: Command end result
[0m17:25:07.839496 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:25:07.841590 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:25:07.849116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:25:07.849627 [info ] [MainThread]: 
[0m17:25:07.850530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:07.851387 [info ] [MainThread]: 
[0m17:25:07.852169 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:25:07.853853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5193001, "process_in_blocks": "0", "process_kernel_time": 0.525183, "process_mem_max_rss": "107912", "process_out_blocks": "3392", "process_user_time": 2.772659}
[0m17:25:07.854575 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:07.854400 after 1.52 seconds
[0m17:25:07.855030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96f755b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96f95e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc96d5bd880>]}
[0m17:25:07.855476 [debug] [MainThread]: Flushing usage events
[0m17:25:09.175272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:50.101078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7590925c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758f2043b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758ed649b0>]}


============================== 17:25:50.109134 | 86145b1d-30f9-413c-93c6-731eb50bc9a4 ==============================
[0m17:25:50.109134 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:25:50.110002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:50.396030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758ed6b740>]}
[0m17:25:50.488513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7590888140>]}
[0m17:25:50.489636 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:25:50.603631 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:25:50.766185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:50.766664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:50.817629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758d22d9d0>]}
[0m17:25:50.919720 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:25:50.922852 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:25:50.955270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758ea7ef30>]}
[0m17:25:50.955860 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:25:50.956431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758d22e870>]}
[0m17:25:50.960030 [info ] [MainThread]: 
[0m17:25:50.960739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:50.961421 [info ] [MainThread]: 
[0m17:25:50.962461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:50.967830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:25:51.028931 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:25:51.029434 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:25:51.029791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:51.043980 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m17:25:51.046515 [debug] [ThreadPool]: On list_db: Close
[0m17:25:51.049072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m17:25:51.057640 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:25:51.058322 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:25:51.058736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:51.070936 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:25:51.071527 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:25:51.072306 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:25:51.077078 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:25:51.081401 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:25:51.082441 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:25:51.092504 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.093383 [debug] [MainThread]: On master: BEGIN
[0m17:25:51.094067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:51.107937 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:25:51.108591 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.109241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:51.114084 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m17:25:51.116762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758cf2f4a0>]}
[0m17:25:51.117843 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:51.118720 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.119183 [debug] [MainThread]: On master: BEGIN
[0m17:25:51.120134 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:25:51.120677 [debug] [MainThread]: On master: COMMIT
[0m17:25:51.121040 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.121389 [debug] [MainThread]: On master: COMMIT
[0m17:25:51.122022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:51.122481 [debug] [MainThread]: On master: Close
[0m17:25:51.126564 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m17:25:51.127307 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m17:25:51.127951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m17:25:51.128864 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m17:25:51.141429 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m17:25:51.142242 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m17:25:51.203469 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m17:25:51.204381 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.204823 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m17:25:51.205221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:51.214581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:25:51.215065 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.215533 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m17:25:51.221159 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:25:51.228117 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.228729 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m17:25:51.229781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:51.233409 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.234270 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m17:25:51.235880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:51.259469 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m17:25:51.260013 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.260545 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m17:25:51.262916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:25:51.270734 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m17:25:51.278749 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:25:51.279254 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m17:25:51.285375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:25:51.288193 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m17:25:51.290238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d75909da450>]}
[0m17:25:51.290991 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 1[0m in 0.16s]
[0m17:25:51.291791 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m17:25:51.293217 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:25:51.293738 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:25:51.294274 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m17:25:51.295138 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m17:25:51.296002 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m17:25:51.296701 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m17:25:51.297209 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m17:25:51.297722 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m17:25:51.302484 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m17:25:51.305806 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m17:25:51.306730 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m17:25:51.307153 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m17:25:51.310580 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m17:25:51.313852 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m17:25:51.314908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.315438 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.315932 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m17:25:51.316496 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m17:25:51.317040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:25:51.317991 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:25:51.327779 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:25:51.328331 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m17:25:51.328894 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.329445 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.330001 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m17:25:51.330570 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m17:25:51.333589 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:25:51.336992 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.337526 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:25:51.338005 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m17:25:51.341195 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.341887 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m17:25:51.342346 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:51.345540 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.345985 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:25:51.346447 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m17:25:51.349502 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.350210 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m17:25:51.350664 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:51.352620 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:25:51.353096 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:51.353570 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.355551 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:25:51.356206 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:25:51.356776 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.357441 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:25:51.813096 [debug] [Thread-4 (]: SQL status: COMMIT in 0.456 seconds
[0m17:25:51.818053 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m17:25:51.819097 [debug] [Thread-3 (]: SQL status: COMMIT in 0.461 seconds
[0m17:25:51.821459 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:25:51.827017 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m17:25:51.828271 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m17:25:51.830060 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:25:51.831468 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m17:25:51.836146 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:25:51.839268 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m17:25:51.840364 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m17:25:51.841809 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758c1a7c50>]}
[0m17:25:51.844043 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m17:25:51.845330 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.54s]
[0m17:25:51.846628 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86145b1d-30f9-413c-93c6-731eb50bc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758c0f9b20>]}
[0m17:25:51.847471 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:25:51.848552 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.55s]
[0m17:25:51.850442 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:25:51.853242 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.853787 [debug] [MainThread]: On master: BEGIN
[0m17:25:51.854221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:51.864867 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:25:51.865361 [debug] [MainThread]: On master: COMMIT
[0m17:25:51.865725 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:51.866082 [debug] [MainThread]: On master: COMMIT
[0m17:25:51.866780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:51.867244 [debug] [MainThread]: On master: Close
[0m17:25:51.868171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:51.868736 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m17:25:51.869110 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m17:25:51.869632 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m17:25:51.870472 [info ] [MainThread]: 
[0m17:25:51.871068 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m17:25:51.873054 [debug] [MainThread]: Command end result
[0m17:25:51.899828 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:25:51.901756 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:25:51.909775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:25:51.910213 [info ] [MainThread]: 
[0m17:25:51.910803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:51.911349 [info ] [MainThread]: 
[0m17:25:51.911965 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:25:51.913476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8789822, "process_in_blocks": "0", "process_kernel_time": 0.433567, "process_mem_max_rss": "108024", "process_out_blocks": "3392", "process_user_time": 2.914969}
[0m17:25:51.914174 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:51.914012 after 1.88 seconds
[0m17:25:51.914682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758eaabb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758ea2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d758ecacbc0>]}
[0m17:25:51.915272 [debug] [MainThread]: Flushing usage events
[0m17:25:59.490971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:47.892500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db05871f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db05819cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db0584ad2b0>]}


============================== 17:32:47.900600 | a6472350-eb94-4887-a20c-240d34956640 ==============================
[0m17:32:47.900600 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:32:47.901525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:48.188334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6472350-eb94-4887-a20c-240d34956640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db0565deea0>]}
[0m17:32:48.274030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6472350-eb94-4887-a20c-240d34956640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db057dcbad0>]}
[0m17:32:48.275146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:32:48.394943 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:32:48.555100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:48.555576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:48.620851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6472350-eb94-4887-a20c-240d34956640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db0582b5b80>]}
[0m17:32:48.752094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:32:48.755418 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:32:48.788044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6472350-eb94-4887-a20c-240d34956640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db0563848c0>]}
[0m17:32:48.788618 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:32:48.789164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6472350-eb94-4887-a20c-240d34956640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db057e93470>]}
[0m17:32:48.792268 [info ] [MainThread]: 
[0m17:32:48.792990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:48.793531 [info ] [MainThread]: 
[0m17:32:48.794683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:48.801782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:32:48.864671 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:32:48.865185 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:32:48.865645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:48.868267 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.18.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:32:48.869968 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:32:48.871139 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:32:48.872300 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:32:48.873088 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:32:48.873869 [debug] [ThreadPool]: On list_db: No close available on handle
[0m17:32:48.875668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:48.876224 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m17:32:48.876691 [info ] [MainThread]: 
[0m17:32:48.877217 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m17:32:48.878480 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.18.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m17:32:48.880428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.112509, "process_in_blocks": "0", "process_kernel_time": 0.54435, "process_mem_max_rss": "103496", "process_out_blocks": "2464", "process_user_time": 2.980414}
[0m17:32:48.881407 [debug] [MainThread]: Command `dbt run` failed at 17:32:48.881177 after 1.11 seconds
[0m17:32:48.881920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db057edfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db056362cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db05667ccb0>]}
[0m17:32:48.882691 [debug] [MainThread]: Flushing usage events
[0m17:32:49.207377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:38.325285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0fa56390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e6fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e6fdbb0>]}


============================== 17:36:38.343213 | fc55ca25-ddf3-41a3-8864-52f5893391b0 ==============================
[0m17:36:38.343213 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:36:38.345143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:36:38.860013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e0c5af0>]}
[0m17:36:39.024723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0f4bb1a0>]}
[0m17:36:39.026515 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:36:39.215972 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:36:39.461799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:39.462476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:39.521019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e1d0650>]}
[0m17:36:39.656214 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:36:39.659970 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:36:39.708963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0c5942c0>]}
[0m17:36:39.709993 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:36:39.710834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e0c6b70>]}
[0m17:36:39.713972 [info ] [MainThread]: 
[0m17:36:39.714815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:36:39.715859 [info ] [MainThread]: 
[0m17:36:39.717457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:36:39.728049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:36:39.828829 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:36:39.829433 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:36:39.829956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:39.849863 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m17:36:39.851842 [debug] [ThreadPool]: On list_db: Close
[0m17:36:39.853111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m17:36:39.853926 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m17:36:39.863920 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:36:39.864644 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m17:36:39.865151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:39.877413 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:36:39.878144 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:36:39.879027 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m17:36:39.880764 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m17:36:39.882477 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m17:36:39.883205 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m17:36:39.883769 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m17:36:39.900924 [debug] [ThreadPool]: SQL status: COMMIT in 0.017 seconds
[0m17:36:39.902000 [debug] [ThreadPool]: On create_db_dev: Close
[0m17:36:39.906343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m17:36:39.922268 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:36:39.923697 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:36:39.924527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:39.937294 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:36:39.938138 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:36:39.939123 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:36:39.947949 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m17:36:39.951160 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:36:39.952723 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:36:39.964657 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:39.965937 [debug] [MainThread]: On master: BEGIN
[0m17:36:39.966996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:39.982085 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m17:36:39.983668 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:39.984702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:39.994623 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:36:39.996802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0c592540>]}
[0m17:36:39.997601 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:39.998512 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:39.999545 [debug] [MainThread]: On master: BEGIN
[0m17:36:40.001343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:36:40.002461 [debug] [MainThread]: On master: COMMIT
[0m17:36:40.003698 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:40.004395 [debug] [MainThread]: On master: COMMIT
[0m17:36:40.006352 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:36:40.007555 [debug] [MainThread]: On master: Close
[0m17:36:40.014241 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m17:36:40.015627 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m17:36:40.020389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m17:36:40.021343 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m17:36:40.040744 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m17:36:40.041861 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m17:36:40.117582 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m17:36:40.118680 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:36:40.119416 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m17:36:40.120198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:40.134435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:36:40.135607 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m17:36:40.136393 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m17:36:40.138011 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m17:36:40.139160 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m17:36:40.140899 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m17:36:40.155981 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m17:36:40.161030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55ca25-ddf3-41a3-8864-52f5893391b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0ec4e7e0>]}
[0m17:36:40.162973 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.14s]
[0m17:36:40.165279 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m17:36:40.173043 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m17:36:40.180904 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:36:40.181993 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:36:40.185664 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m17:36:40.191433 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:36:40.189347 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m17:36:40.194398 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:36:40.199927 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:40.201070 [debug] [MainThread]: On master: BEGIN
[0m17:36:40.202188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:40.219860 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m17:36:40.221257 [debug] [MainThread]: On master: COMMIT
[0m17:36:40.222380 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:40.223546 [debug] [MainThread]: On master: COMMIT
[0m17:36:40.225091 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:40.226177 [debug] [MainThread]: On master: Close
[0m17:36:40.227829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:40.232701 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m17:36:40.238428 [info ] [MainThread]: 
[0m17:36:40.239613 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m17:36:40.242332 [debug] [MainThread]: Command end result
[0m17:36:40.348333 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:36:40.350893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:36:40.366706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:36:40.367587 [info ] [MainThread]: 
[0m17:36:40.368481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:36:40.369491 [info ] [MainThread]: 
[0m17:36:40.370675 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m17:36:40.371813 [info ] [MainThread]: 
[0m17:36:40.373025 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:36:40.382367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2460654, "process_in_blocks": "0", "process_kernel_time": 0.736776, "process_mem_max_rss": "107460", "process_out_blocks": "3336", "process_user_time": 5.090808}
[0m17:36:40.383948 [debug] [MainThread]: Command `dbt run` failed at 17:36:40.383644 after 2.25 seconds
[0m17:36:40.384801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e118ae8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0e6fc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702e0b807e60>]}
[0m17:36:40.385966 [debug] [MainThread]: Flushing usage events
[0m17:36:40.770423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:55.671886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac4c1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac46c4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac46c4860>]}


============================== 10:45:55.726387 | 0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2 ==============================
[0m10:45:55.726387 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:45:55.727795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:45:57.157575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac27f42f0>]}
[0m10:45:57.285192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac4138290>]}
[0m10:45:57.287276 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:45:57.578079 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:45:59.844113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:59.844918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:59.901926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac4c1ba40>]}
[0m10:46:00.024675 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:46:00.088898 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:46:00.304695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac262bbc0>]}
[0m10:46:00.305575 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m10:46:00.306336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac2598b00>]}
[0m10:46:00.309905 [info ] [MainThread]: 
[0m10:46:00.310683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:46:00.311721 [info ] [MainThread]: 
[0m10:46:00.313657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:46:00.322166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:46:00.604392 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:46:00.605083 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:46:00.606153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:01.018146 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.412 seconds
[0m10:46:01.020791 [debug] [ThreadPool]: On list_db: Close
[0m10:46:01.022477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m10:46:01.023574 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m10:46:01.032610 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:46:01.033050 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m10:46:01.033379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:01.042990 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:46:01.043569 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:46:01.044273 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m10:46:01.045436 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:46:01.046535 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:46:01.046902 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:46:01.047246 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:46:01.052714 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m10:46:01.053596 [debug] [ThreadPool]: On create_db_dev: Close
[0m10:46:01.056347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m10:46:01.064552 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:46:01.065015 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:46:01.065320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:01.074809 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:46:01.075292 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:46:01.075938 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:46:01.079732 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:46:01.081247 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:46:01.081980 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:46:01.088748 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.089444 [debug] [MainThread]: On master: BEGIN
[0m10:46:01.090022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:01.101977 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:46:01.103012 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.103938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:46:01.110398 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m10:46:01.112225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac44c81a0>]}
[0m10:46:01.112838 [debug] [MainThread]: On master: ROLLBACK
[0m10:46:01.113496 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.113874 [debug] [MainThread]: On master: BEGIN
[0m10:46:01.114651 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:46:01.115138 [debug] [MainThread]: On master: COMMIT
[0m10:46:01.115680 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.116290 [debug] [MainThread]: On master: COMMIT
[0m10:46:01.117114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:46:01.117900 [debug] [MainThread]: On master: Close
[0m10:46:01.123786 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m10:46:01.124826 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m10:46:01.125629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m10:46:01.126404 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m10:46:01.135524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m10:46:01.137070 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m10:46:01.187616 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m10:46:01.188710 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:46:01.189339 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m10:46:01.189853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:01.198426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:46:01.199157 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:46:01.200144 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m10:46:01.221687 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m10:46:01.222780 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m10:46:01.224257 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m10:46:01.402554 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:46:01.414356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb2d3fb-274d-47d8-8cd6-6a63fb9713d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac28cc920>]}
[0m10:46:01.415224 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.28s]
[0m10:46:01.416064 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m10:46:01.417039 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m10:46:01.418877 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m10:46:01.419378 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m10:46:01.419921 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m10:46:01.420652 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m10:46:01.421752 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m10:46:01.422625 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m10:46:01.426356 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.427093 [debug] [MainThread]: On master: BEGIN
[0m10:46:01.427768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:01.441168 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:46:01.441869 [debug] [MainThread]: On master: COMMIT
[0m10:46:01.442599 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:01.442995 [debug] [MainThread]: On master: COMMIT
[0m10:46:01.443664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:46:01.444246 [debug] [MainThread]: On master: Close
[0m10:46:01.444854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:01.445237 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m10:46:01.445827 [info ] [MainThread]: 
[0m10:46:01.446967 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:46:01.449803 [debug] [MainThread]: Command end result
[0m10:46:01.486285 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:46:01.488730 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:46:01.495512 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:46:01.495995 [info ] [MainThread]: 
[0m10:46:01.496441 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:46:01.497029 [info ] [MainThread]: 
[0m10:46:01.498014 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:46:01.498635 [info ] [MainThread]: 
[0m10:46:01.499548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m10:46:01.545708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.258779, "process_in_blocks": "56768", "process_kernel_time": 0.774456, "process_mem_max_rss": "106668", "process_out_blocks": "3304", "process_user_time": 4.343341}
[0m10:46:01.546993 [debug] [MainThread]: Command `dbt run` failed at 10:46:01.546688 after 6.26 seconds
[0m10:46:01.547957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac4c1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac4c18680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731ac45482f0>]}
[0m10:46:01.548990 [debug] [MainThread]: Flushing usage events
[0m10:46:01.617026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:12.229867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db89b87fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db89c51a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db87ebb980>]}


============================== 10:28:12.256179 | 247861da-ee50-4952-a79f-d1de78e89d19 ==============================
[0m10:28:12.256179 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:28:12.257825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:28:13.306691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db8632c800>]}
[0m10:28:13.471328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db883a91c0>]}
[0m10:28:13.473710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:28:13.704068 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:28:14.135724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:28:14.136970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:28:14.226105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db863b5910>]}
[0m10:28:14.472048 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:28:14.490488 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:28:14.577939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db862ea900>]}
[0m10:28:14.578752 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m10:28:14.579859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db863b4800>]}
[0m10:28:14.583902 [info ] [MainThread]: 
[0m10:28:14.584782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:14.585648 [info ] [MainThread]: 
[0m10:28:14.586950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:14.597345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:28:14.719664 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:28:14.720335 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:28:14.721285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:14.768549 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m10:28:14.770573 [debug] [ThreadPool]: On list_db: Close
[0m10:28:14.772114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m10:28:14.773327 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m10:28:14.784506 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:28:14.785195 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m10:28:14.785816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:14.800170 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:28:14.800845 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:28:14.801632 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m10:28:14.803123 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:28:14.804412 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:28:14.805073 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:28:14.805564 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:28:14.808146 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m10:28:14.808790 [debug] [ThreadPool]: On create_db_dev: Close
[0m10:28:14.811875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m10:28:14.819504 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:28:14.819970 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:28:14.820362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:14.831027 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:28:14.831581 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:28:14.832011 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:28:14.837795 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m10:28:14.839553 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:28:14.840354 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:28:14.846889 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:14.847506 [debug] [MainThread]: On master: BEGIN
[0m10:28:14.848267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:14.860624 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:28:14.861175 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:14.861789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:14.868167 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m10:28:14.870457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db899f4350>]}
[0m10:28:14.871282 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:14.872171 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:14.872660 [debug] [MainThread]: On master: BEGIN
[0m10:28:14.873813 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:28:14.874670 [debug] [MainThread]: On master: COMMIT
[0m10:28:14.875446 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:14.876159 [debug] [MainThread]: On master: COMMIT
[0m10:28:14.877331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:14.877807 [debug] [MainThread]: On master: Close
[0m10:28:14.882667 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m10:28:14.884453 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m10:28:14.885857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m10:28:14.886752 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m10:28:14.903020 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m10:28:14.904469 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m10:28:14.965033 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m10:28:14.965941 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:28:14.966393 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m10:28:14.966803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:14.984099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:28:14.985042 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:28:14.986291 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m10:28:14.989476 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m10:28:14.990617 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m10:28:14.992000 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m10:28:15.009084 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:28:15.011974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247861da-ee50-4952-a79f-d1de78e89d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db863a09b0>]}
[0m10:28:15.012921 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.12s]
[0m10:28:15.013876 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m10:28:15.014929 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m10:28:15.017587 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m10:28:15.018231 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m10:28:15.018895 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m10:28:15.019826 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m10:28:15.020850 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m10:28:15.021506 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m10:28:15.024650 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:15.025219 [debug] [MainThread]: On master: BEGIN
[0m10:28:15.025736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:15.039088 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:28:15.039808 [debug] [MainThread]: On master: COMMIT
[0m10:28:15.040475 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:15.041126 [debug] [MainThread]: On master: COMMIT
[0m10:28:15.041946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:15.042403 [debug] [MainThread]: On master: Close
[0m10:28:15.043086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:15.043498 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m10:28:15.044056 [info ] [MainThread]: 
[0m10:28:15.044683 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m10:28:15.046132 [debug] [MainThread]: Command end result
[0m10:28:15.077503 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:28:15.079673 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:28:15.090940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:28:15.091846 [info ] [MainThread]: 
[0m10:28:15.092774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:28:15.093875 [info ] [MainThread]: 
[0m10:28:15.095190 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:28:15.096255 [info ] [MainThread]: 
[0m10:28:15.097740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m10:28:15.101912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.054852, "process_in_blocks": "111784", "process_kernel_time": 1.761728, "process_mem_max_rss": "106852", "process_out_blocks": "3336", "process_user_time": 6.369667}
[0m10:28:15.103356 [debug] [MainThread]: Command `dbt run` failed at 10:28:15.103131 after 3.06 seconds
[0m10:28:15.103977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db87f59d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db87ed85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78db88313770>]}
[0m10:28:15.104529 [debug] [MainThread]: Flushing usage events
[0m10:28:15.638631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:52.124261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1659cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab184d4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab16e2a9f0>]}


============================== 10:29:52.128292 | 3aade243-6aaf-4e79-95b1-11f7d9355c5e ==============================
[0m10:29:52.128292 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:29:52.128994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:29:52.392771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab164ae210>]}
[0m10:29:52.507722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1659d010>]}
[0m10:29:52.508725 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:29:52.643886 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:29:52.802954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:52.803394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:52.850093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab16b55370>]}
[0m10:29:52.956177 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:29:52.959383 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:29:52.989877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab14930d40>]}
[0m10:29:52.990477 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m10:29:52.990958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab14c1bf50>]}
[0m10:29:52.993433 [info ] [MainThread]: 
[0m10:29:52.994005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:52.994574 [info ] [MainThread]: 
[0m10:29:52.995596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:53.001556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:29:53.072025 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:29:53.072476 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:53.072892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:53.086897 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m10:29:53.089788 [debug] [ThreadPool]: On list_db: Close
[0m10:29:53.093917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:29:53.102258 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:29:53.102854 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:29:53.103464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:53.114314 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:29:53.114884 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:29:53.115461 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:53.119084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:29:53.121068 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:29:53.122046 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:29:53.129637 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.130269 [debug] [MainThread]: On master: BEGIN
[0m10:29:53.130711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:53.144948 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:29:53.145666 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.146479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:53.152233 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:29:53.155112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1499bbf0>]}
[0m10:29:53.156146 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:53.157243 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.157823 [debug] [MainThread]: On master: BEGIN
[0m10:29:53.158966 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:29:53.159662 [debug] [MainThread]: On master: COMMIT
[0m10:29:53.160325 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.160830 [debug] [MainThread]: On master: COMMIT
[0m10:29:53.161700 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:53.162236 [debug] [MainThread]: On master: Close
[0m10:29:53.167020 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m10:29:53.168077 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m10:29:53.169263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m10:29:53.170541 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m10:29:53.186707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m10:29:53.188006 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m10:29:53.253850 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m10:29:53.255275 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:29:53.255923 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m10:29:53.256463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:53.266877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:29:53.267545 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:29:53.268126 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m10:29:53.269975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m10:29:53.271369 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m10:29:53.273001 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m10:29:53.285313 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:29:53.289765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aade243-6aaf-4e79-95b1-11f7d9355c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1715a120>]}
[0m10:29:53.294093 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.12s]
[0m10:29:53.295866 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m10:29:53.297741 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m10:29:53.305487 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m10:29:53.306472 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m10:29:53.307807 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m10:29:53.311782 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m10:29:53.315230 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m10:29:53.314024 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m10:29:53.319318 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.319887 [debug] [MainThread]: On master: BEGIN
[0m10:29:53.320485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:53.333543 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:29:53.334308 [debug] [MainThread]: On master: COMMIT
[0m10:29:53.335262 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:53.335773 [debug] [MainThread]: On master: COMMIT
[0m10:29:53.336473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:53.337061 [debug] [MainThread]: On master: Close
[0m10:29:53.337792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:53.338206 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m10:29:53.338670 [info ] [MainThread]: 
[0m10:29:53.339251 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:29:53.342082 [debug] [MainThread]: Command end result
[0m10:29:53.378988 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:29:53.380884 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:29:53.390805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:29:53.391452 [info ] [MainThread]: 
[0m10:29:53.392180 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:29:53.392907 [info ] [MainThread]: 
[0m10:29:53.393871 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:29:53.394596 [info ] [MainThread]: 
[0m10:29:53.395368 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m10:29:53.397225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3845501, "process_in_blocks": "0", "process_kernel_time": 0.513693, "process_mem_max_rss": "106668", "process_out_blocks": "1736", "process_user_time": 3.038014}
[0m10:29:53.398401 [debug] [MainThread]: Command `dbt run` failed at 10:29:53.398095 after 1.39 seconds
[0m10:29:53.399220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab14d12e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab16e28980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab14d65ee0>]}
[0m10:29:53.400093 [debug] [MainThread]: Flushing usage events
[0m10:29:53.889188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:28.594822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b04122810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b04060a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b0480eff0>]}


============================== 10:56:28.620734 | 0f9c4098-577f-4e5d-8f8b-87cdff3b98fd ==============================
[0m10:56:28.620734 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:56:28.622392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:56:32.789159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b03f1a7e0>]}
[0m10:56:32.874367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b059b24b0>]}
[0m10:56:32.875605 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:56:33.140420 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:56:33.812593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:33.813049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:33.859101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b04123710>]}
[0m10:56:33.950307 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:56:34.743278 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:56:35.878320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b022caff0>]}
[0m10:56:35.879236 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m10:56:35.879776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b0237eb70>]}
[0m10:56:35.882857 [info ] [MainThread]: 
[0m10:56:35.883522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:56:35.884247 [info ] [MainThread]: 
[0m10:56:35.885398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:56:35.893228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:56:36.254854 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:56:36.255436 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:56:36.255798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:36.363933 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.108 seconds
[0m10:56:36.365535 [debug] [ThreadPool]: On list_db: Close
[0m10:56:36.366562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m10:56:36.367265 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m10:56:36.372872 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:56:36.373331 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m10:56:36.373680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:36.383552 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:56:36.384113 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:56:36.384775 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m10:56:36.385968 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:56:36.387265 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:56:36.387732 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m10:56:36.388046 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m10:56:36.392956 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m10:56:36.393703 [debug] [ThreadPool]: On create_db_dev: Close
[0m10:56:36.396976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m10:56:36.406361 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:56:36.406859 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:56:36.407201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:36.418712 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:56:36.419250 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:56:36.419777 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:56:36.424261 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m10:56:36.425836 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:56:36.426708 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:56:36.436124 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.436736 [debug] [MainThread]: On master: BEGIN
[0m10:56:36.437208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:36.448524 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:56:36.449326 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.450328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:56:36.456408 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:56:36.459244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b05c206e0>]}
[0m10:56:36.460160 [debug] [MainThread]: On master: ROLLBACK
[0m10:56:36.461117 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.461548 [debug] [MainThread]: On master: BEGIN
[0m10:56:36.462634 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:56:36.463303 [debug] [MainThread]: On master: COMMIT
[0m10:56:36.464083 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.464562 [debug] [MainThread]: On master: COMMIT
[0m10:56:36.465449 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:56:36.466398 [debug] [MainThread]: On master: Close
[0m10:56:36.472558 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m10:56:36.473380 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m10:56:36.474198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m10:56:36.474801 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m10:56:36.486818 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m10:56:36.487667 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m10:56:36.543028 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m10:56:36.544905 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:56:36.545407 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m10:56:36.545767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:36.556249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:56:36.556788 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m10:56:36.557276 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m10:56:36.572420 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m10:56:36.573337 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m10:56:36.574554 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m10:56:36.624934 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:56:36.634501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9c4098-577f-4e5d-8f8b-87cdff3b98fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b025e8ef0>]}
[0m10:56:36.636184 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.15s]
[0m10:56:36.637852 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m10:56:36.639591 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m10:56:36.644761 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m10:56:36.645659 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m10:56:36.646984 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m10:56:36.648877 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m10:56:36.651709 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m10:56:36.652894 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m10:56:36.657459 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.658666 [debug] [MainThread]: On master: BEGIN
[0m10:56:36.659867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:36.675262 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:56:36.676058 [debug] [MainThread]: On master: COMMIT
[0m10:56:36.676709 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:36.677140 [debug] [MainThread]: On master: COMMIT
[0m10:56:36.677796 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:56:36.678227 [debug] [MainThread]: On master: Close
[0m10:56:36.678902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:36.679303 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m10:56:36.679784 [info ] [MainThread]: 
[0m10:56:36.680359 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m10:56:36.682454 [debug] [MainThread]: Command end result
[0m10:56:36.716056 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:56:36.718152 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:56:36.725271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:56:36.725693 [info ] [MainThread]: 
[0m10:56:36.726145 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:56:36.726666 [info ] [MainThread]: 
[0m10:56:36.727506 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m10:56:36.728051 [info ] [MainThread]: 
[0m10:56:36.728884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m10:56:36.740686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.369402, "process_in_blocks": "101968", "process_kernel_time": 0.842461, "process_mem_max_rss": "106812", "process_out_blocks": "3336", "process_user_time": 3.302606}
[0m10:56:36.741969 [debug] [MainThread]: Command `dbt run` failed at 10:56:36.741758 after 8.37 seconds
[0m10:56:36.742515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b04adf860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b043ceea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b075ba8d0>]}
[0m10:56:36.743150 [debug] [MainThread]: Flushing usage events
[0m10:56:36.800242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:29.313247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70642150e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706421f9c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70642063b5f0>]}


============================== 11:07:29.326624 | 3f311b16-f1ed-480d-9e73-7d0cdceeb599 ==============================
[0m11:07:29.326624 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:07:29.328187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:29.728617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7064200e3bc0>]}
[0m11:07:29.837395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706420c438c0>]}
[0m11:07:29.838606 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:07:29.987732 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:07:30.169642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:30.170167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:30.224882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70641e780290>]}
[0m11:07:30.379769 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:07:30.385185 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:07:30.429173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70641e488cb0>]}
[0m11:07:30.430188 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:07:30.431028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70641e468860>]}
[0m11:07:30.435304 [info ] [MainThread]: 
[0m11:07:30.436727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:30.438007 [info ] [MainThread]: 
[0m11:07:30.439679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:30.447873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:07:30.527834 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:07:30.528526 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:07:30.529092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:30.545655 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m11:07:30.547257 [debug] [ThreadPool]: On list_db: Close
[0m11:07:30.548391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m11:07:30.549065 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m11:07:30.555026 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:07:30.555462 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m11:07:30.555912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:30.567181 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:07:30.567913 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:07:30.568788 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m11:07:30.570227 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m11:07:30.571463 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m11:07:30.572024 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:07:30.572389 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m11:07:30.588226 [debug] [ThreadPool]: SQL status: COMMIT in 0.015 seconds
[0m11:07:30.588872 [debug] [ThreadPool]: On create_db_dev: Close
[0m11:07:30.591956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m11:07:30.600911 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:07:30.601398 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:07:30.601762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:30.612570 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:07:30.613438 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:07:30.614329 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:07:30.620368 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m11:07:30.622375 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:07:30.623445 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:07:30.634855 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.635644 [debug] [MainThread]: On master: BEGIN
[0m11:07:30.636287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:30.646986 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:07:30.647690 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.648558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:07:30.654090 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:07:30.656631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70641e6df950>]}
[0m11:07:30.657470 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:30.658424 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.659572 [debug] [MainThread]: On master: BEGIN
[0m11:07:30.663187 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:07:30.664551 [debug] [MainThread]: On master: COMMIT
[0m11:07:30.665427 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.666056 [debug] [MainThread]: On master: COMMIT
[0m11:07:30.667011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:30.667677 [debug] [MainThread]: On master: Close
[0m11:07:30.673169 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:07:30.674031 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:07:30.675022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:07:30.675828 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:07:30.689572 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:07:30.690514 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:07:30.763221 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:07:30.764541 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:07:30.765320 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:07:30.766069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:30.776944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:07:30.777797 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:07:30.778557 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:07:30.780146 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m11:07:30.781025 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m11:07:30.782292 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:07:30.794983 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m11:07:30.800432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f311b16-f1ed-480d-9e73-7d0cdceeb599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70641e7809b0>]}
[0m11:07:30.804139 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.12s]
[0m11:07:30.806176 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:07:30.808686 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m11:07:30.813662 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:07:30.817073 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m11:07:30.818527 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:07:30.815215 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:07:30.819993 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m11:07:30.820961 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:07:30.825309 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.826528 [debug] [MainThread]: On master: BEGIN
[0m11:07:30.828285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:30.844463 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:07:30.845249 [debug] [MainThread]: On master: COMMIT
[0m11:07:30.845994 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:30.847489 [debug] [MainThread]: On master: COMMIT
[0m11:07:30.849697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:30.850910 [debug] [MainThread]: On master: Close
[0m11:07:30.853312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:30.857354 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:07:30.858682 [info ] [MainThread]: 
[0m11:07:30.859663 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m11:07:30.861620 [debug] [MainThread]: Command end result
[0m11:07:30.906718 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:07:30.909758 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:07:30.923950 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:07:30.924680 [info ] [MainThread]: 
[0m11:07:30.925556 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:07:30.926446 [info ] [MainThread]: 
[0m11:07:30.927725 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m11:07:30.928817 [info ] [MainThread]: 
[0m11:07:30.930150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m11:07:30.934134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7723963, "process_in_blocks": "0", "process_kernel_time": 0.656657, "process_mem_max_rss": "107432", "process_out_blocks": "3336", "process_user_time": 4.463659}
[0m11:07:30.935400 [debug] [MainThread]: Command `dbt run` failed at 11:07:30.935197 after 1.78 seconds
[0m11:07:30.936087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70642056ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706420bacf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7064200b6fc0>]}
[0m11:07:30.936706 [debug] [MainThread]: Flushing usage events
[0m11:07:32.219454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:20.752632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4d587830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4cb9de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4cc1f980>]}


============================== 11:11:20.762752 | e94450b9-66aa-4ac8-b755-825099b3677a ==============================
[0m11:11:20.762752 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:11:20.763938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:11:21.140455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4c8acc20>]}
[0m11:11:21.329120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4c98ede0>]}
[0m11:11:21.330271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:11:21.477990 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:11:21.642026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:21.642552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:21.720056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4b07c7d0>]}
[0m11:11:21.880176 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:21.883662 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:21.931899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4afc1760>]}
[0m11:11:21.932922 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:11:21.933760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4dc3bc50>]}
[0m11:11:21.937482 [info ] [MainThread]: 
[0m11:11:21.938398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:21.939283 [info ] [MainThread]: 
[0m11:11:21.940503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:21.951034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:11:22.024514 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:11:22.025031 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:11:22.025519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:22.038686 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m11:11:22.041574 [debug] [ThreadPool]: On list_db: Close
[0m11:11:22.043464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m11:11:22.044470 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m11:11:22.054608 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:11:22.055385 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m11:11:22.056042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:22.066728 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:11:22.067469 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:11:22.068111 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m11:11:22.069595 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m11:11:22.072632 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m11:11:22.073160 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m11:11:22.073556 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m11:11:22.091621 [debug] [ThreadPool]: SQL status: COMMIT in 0.018 seconds
[0m11:11:22.092401 [debug] [ThreadPool]: On create_db_dev: Close
[0m11:11:22.096013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m11:11:22.103499 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:11:22.104051 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:11:22.104491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:22.115483 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:11:22.116387 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:11:22.117238 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:11:22.121760 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m11:11:22.123869 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:11:22.125048 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:11:22.133416 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.134246 [debug] [MainThread]: On master: BEGIN
[0m11:11:22.135040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:22.151604 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:11:22.152539 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.153672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:11:22.162326 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m11:11:22.165420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4ae7e330>]}
[0m11:11:22.166863 [debug] [MainThread]: On master: ROLLBACK
[0m11:11:22.168319 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.168897 [debug] [MainThread]: On master: BEGIN
[0m11:11:22.170352 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:11:22.171365 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.172269 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.173158 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.174300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:22.175484 [debug] [MainThread]: On master: Close
[0m11:11:22.186551 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:11:22.188001 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:11:22.189249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:11:22.190280 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:11:22.217618 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:11:22.219091 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:11:22.306334 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:11:22.307418 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:11:22.308108 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:11:22.308545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:22.322910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:11:22.323928 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:11:22.324909 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:11:22.327291 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.weather" does not exist
LINE 16:     FROM "db"."dev"."weather"
                  ^

[0m11:11:22.328681 [debug] [Thread-1 (]: On model.my_project.stg_weather: ROLLBACK
[0m11:11:22.331091 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:11:22.352744 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m11:11:22.357040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94450b9-66aa-4ac8-b755-825099b3677a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4cac2300>]}
[0m11:11:22.359549 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather .......................... [[31mERROR[0m in 0.16s]
[0m11:11:22.361600 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:11:22.364253 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql.
[0m11:11:22.369329 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:11:22.370548 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:11:22.372165 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m11:11:22.374061 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m11:11:22.379151 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:11:22.381512 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:11:22.389757 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.390864 [debug] [MainThread]: On master: BEGIN
[0m11:11:22.391826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:22.416513 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m11:11:22.417405 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.418194 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.418968 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.420147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:22.421028 [debug] [MainThread]: On master: Close
[0m11:11:22.422364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:22.423830 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:11:22.425545 [info ] [MainThread]: 
[0m11:11:22.427749 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m11:11:22.430453 [debug] [MainThread]: Command end result
[0m11:11:22.497187 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:22.500360 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:22.511469 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:11:22.512506 [info ] [MainThread]: 
[0m11:11:22.513532 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:11:22.514566 [info ] [MainThread]: 
[0m11:11:22.515782 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  relation "dev.weather" does not exist
  LINE 16:     FROM "db"."dev"."weather"
                    ^
  compiled code at target/run/my_project/models/staging/stg_weather.sql
[0m11:11:22.516732 [info ] [MainThread]: 
[0m11:11:22.517751 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m11:11:22.520515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9158924, "process_in_blocks": "0", "process_kernel_time": 0.60474, "process_mem_max_rss": "107568", "process_out_blocks": "3336", "process_user_time": 4.133058}
[0m11:11:22.521858 [debug] [MainThread]: Command `dbt run` failed at 11:11:22.521544 after 1.92 seconds
[0m11:11:22.522967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4d587830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4cc1dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d4cc1f980>]}
[0m11:11:22.524136 [debug] [MainThread]: Flushing usage events
[0m11:11:22.620686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:47.710871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415fa17b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41617c80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415fc296d0>]}


============================== 11:22:47.719927 | 510eccc8-e0a0-4bd2-b687-14e8ef90c0df ==============================
[0m11:22:47.719927 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:22:47.721684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:22:48.110551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4162f9a8d0>]}
[0m11:22:48.302262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415fad4800>]}
[0m11:22:48.305125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:22:48.503098 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:22:48.713490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:48.714082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:48.800252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415dfec080>]}
[0m11:22:48.992515 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:22:48.997137 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:22:49.044463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415dd09f40>]}
[0m11:22:49.045129 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:22:49.045718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415ddb9370>]}
[0m11:22:49.048314 [info ] [MainThread]: 
[0m11:22:49.048923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:22:49.049676 [info ] [MainThread]: 
[0m11:22:49.050726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:22:49.059265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:22:49.128665 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:22:49.129365 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:22:49.129932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:49.142018 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m11:22:49.143648 [debug] [ThreadPool]: On list_db: Close
[0m11:22:49.145867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:22:49.155097 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:22:49.155629 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:22:49.155992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:49.165732 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:22:49.166349 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:22:49.167007 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:22:49.171151 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m11:22:49.172910 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:22:49.173762 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:22:49.183856 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:49.184364 [debug] [MainThread]: On master: BEGIN
[0m11:22:49.184945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:49.198199 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:22:49.199138 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:49.200866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:22:49.221381 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m11:22:49.224920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415dd44410>]}
[0m11:22:49.226290 [debug] [MainThread]: On master: ROLLBACK
[0m11:22:49.227623 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:49.238411 [debug] [MainThread]: On master: BEGIN
[0m11:22:49.240205 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:22:49.241271 [debug] [MainThread]: On master: COMMIT
[0m11:22:49.242217 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:49.243082 [debug] [MainThread]: On master: COMMIT
[0m11:22:49.253922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:22:49.254922 [debug] [MainThread]: On master: Close
[0m11:22:49.277000 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:22:49.278618 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:22:49.279911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:22:49.280943 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:22:49.328742 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:22:49.330144 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:22:49.611591 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:22:49.613348 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:22:49.614499 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:22:49.615549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:49.640406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m11:22:49.641445 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:22:49.642684 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:22:49.681022 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m11:22:49.705205 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:22:49.706298 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:22:49.718355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:22:49.835464 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:22:49.845788 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:22:49.846932 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:22:49.861290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m11:22:49.885647 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:22:49.905055 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:22:49.905879 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:22:49.910290 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:22:49.924559 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:22:49.938403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c416174a5a0>]}
[0m11:22:49.940099 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 0[0m in 0.65s]
[0m11:22:49.941932 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:22:49.944572 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:22:49.945899 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:22:49.947425 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:22:49.952974 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:22:49.954665 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:22:49.956202 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:22:49.957389 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:22:49.958587 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:22:49.976350 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:22:49.986385 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:22:49.998174 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:22:49.999275 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:22:50.007284 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:22:50.024578 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:22:50.026626 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:22:50.044281 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:22:50.045342 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:22:50.046492 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:22:50.047523 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:22:50.048571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:22:50.072855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m11:22:50.073742 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:22:50.074606 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:22:50.081655 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.006 seconds
[0m11:22:50.089788 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:22:50.100345 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m11:22:50.101252 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:22:50.102507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:22:50.104316 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:22:50.105332 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:22:50.110474 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:22:50.112136 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:22:50.113094 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:22:50.117253 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.011 seconds
[0m11:22:50.125243 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:22:50.126376 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:22:50.128888 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:22:50.141078 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:22:50.142376 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:22:50.143641 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:22:50.146217 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m11:22:50.160988 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m11:22:50.162608 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:22:50.168488 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:22:50.170575 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:22:50.174244 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:22:50.172541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:22:50.176358 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:22:50.177563 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:22:50.181725 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:22:50.183835 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:22:50.188424 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:22:50.189579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415ce28140>]}
[0m11:22:50.191209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510eccc8-e0a0-4bd2-b687-14e8ef90c0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c415ce2a8d0>]}
[0m11:22:50.193369 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 0[0m in 0.24s]
[0m11:22:50.197934 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 0[0m in 0.24s]
[0m11:22:50.204205 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:22:50.205901 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:22:50.212174 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.213655 [debug] [MainThread]: On master: BEGIN
[0m11:22:50.217889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:50.246626 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m11:22:50.247840 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.248897 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.249752 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.258009 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m11:22:50.258831 [debug] [MainThread]: On master: Close
[0m11:22:50.260272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:50.261267 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:22:50.262296 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:22:50.263146 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:22:50.264523 [info ] [MainThread]: 
[0m11:22:50.265693 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m11:22:50.269356 [debug] [MainThread]: Command end result
[0m11:22:50.346856 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:22:50.353216 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:22:50.369160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:22:50.370051 [info ] [MainThread]: 
[0m11:22:50.372607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:50.374323 [info ] [MainThread]: 
[0m11:22:50.376867 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:50.379726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7551267, "process_in_blocks": "0", "process_kernel_time": 0.622592, "process_mem_max_rss": "107732", "process_out_blocks": "3392", "process_user_time": 4.968121}
[0m11:22:50.381395 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:50.381047 after 2.76 seconds
[0m11:22:50.382515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41604df350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41602beb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4160b733e0>]}
[0m11:22:50.383577 [debug] [MainThread]: Flushing usage events
[0m11:22:50.516299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:27.882654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64eee8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64eee9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64eee8410>]}


============================== 11:34:27.890381 | 433ff881-2b49-4601-aa78-247a6a7c6822 ==============================
[0m11:34:27.890381 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:34:27.891130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:28.248379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64ef5ef30>]}
[0m11:34:28.357247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64ef5cd40>]}
[0m11:34:28.358884 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:34:28.504412 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:34:28.652878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:28.653645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:28.702813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64d635970>]}
[0m11:34:28.804957 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:34:28.808099 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:34:28.838740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64d34ccb0>]}
[0m11:34:28.839499 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:34:28.840096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64eea77d0>]}
[0m11:34:28.842815 [info ] [MainThread]: 
[0m11:34:28.843868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:34:28.845477 [info ] [MainThread]: 
[0m11:34:28.848823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:34:28.856405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:34:28.917726 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:34:28.918313 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:34:28.919053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:28.931221 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m11:34:28.932919 [debug] [ThreadPool]: On list_db: Close
[0m11:34:28.935303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:34:28.947212 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:34:28.947934 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:34:28.948565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:28.958305 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:34:28.959079 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:34:28.959772 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:34:28.964168 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m11:34:28.965998 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:34:28.966881 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:34:28.974571 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:28.975096 [debug] [MainThread]: On master: BEGIN
[0m11:34:28.975495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:28.987663 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:34:28.988576 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:28.989558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:34:28.994655 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:34:28.997261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64d640230>]}
[0m11:34:28.998171 [debug] [MainThread]: On master: ROLLBACK
[0m11:34:28.999252 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:29.000308 [debug] [MainThread]: On master: BEGIN
[0m11:34:29.001924 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:34:29.003555 [debug] [MainThread]: On master: COMMIT
[0m11:34:29.004432 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:29.005148 [debug] [MainThread]: On master: COMMIT
[0m11:34:29.006155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:34:29.006740 [debug] [MainThread]: On master: Close
[0m11:34:29.011955 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:34:29.013077 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:34:29.014072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:34:29.014834 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:34:29.027500 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:34:29.028293 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:34:29.095396 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:34:29.096749 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:34:29.097669 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:34:29.098651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:29.109418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:34:29.110338 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:34:29.111109 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:34:29.117508 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m11:34:29.130922 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:34:29.131812 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:34:29.133537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:34:29.172218 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:34:29.172779 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:34:29.173264 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:34:29.179443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:34:29.189253 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:34:29.196430 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:34:29.197000 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:34:29.198126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:34:29.201427 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:34:29.205123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f650dd2480>]}
[0m11:34:29.206220 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 0[0m in 0.19s]
[0m11:34:29.207338 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:34:29.209183 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:34:29.209740 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:34:29.210510 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:34:29.212749 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:34:29.213747 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:34:29.220684 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:34:29.211712 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:34:29.223204 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:34:29.224413 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:34:29.230532 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:34:29.231281 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:34:29.235986 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:34:29.237697 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:34:29.238386 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:34:29.238945 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:34:29.244940 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:34:29.245794 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:34:29.247373 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:34:29.254206 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:34:29.255489 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:34:29.261046 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m11:34:29.261819 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:34:29.262622 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:34:29.268720 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.005 seconds
[0m11:34:29.275422 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m11:34:29.276406 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:34:29.277364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:34:29.278341 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:34:29.279916 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:34:29.281467 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:34:29.285542 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:34:29.286207 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m11:34:29.287051 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:34:29.291123 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:34:29.291755 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:34:29.292466 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:34:29.293641 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:34:29.295560 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:34:29.296148 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:34:29.296630 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:34:29.300630 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:34:29.301801 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:34:29.303467 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:34:29.304551 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:34:29.305834 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:34:29.306501 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:34:29.309274 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:34:29.312519 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:34:29.313743 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64c598b90>]}
[0m11:34:29.314975 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:34:29.317457 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:34:29.316587 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 0[0m in 0.10s]
[0m11:34:29.318640 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:34:29.319280 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:34:29.321432 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:34:29.322289 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '433ff881-2b49-4601-aa78-247a6a7c6822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64c3c3f80>]}
[0m11:34:29.323458 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 0[0m in 0.10s]
[0m11:34:29.324806 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:34:29.328668 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:29.329650 [debug] [MainThread]: On master: BEGIN
[0m11:34:29.330591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:29.349760 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m11:34:29.350556 [debug] [MainThread]: On master: COMMIT
[0m11:34:29.351419 [debug] [MainThread]: Using postgres connection "master"
[0m11:34:29.352703 [debug] [MainThread]: On master: COMMIT
[0m11:34:29.353854 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:34:29.354612 [debug] [MainThread]: On master: Close
[0m11:34:29.355888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:29.356676 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:34:29.357510 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:34:29.358609 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:34:29.359828 [info ] [MainThread]: 
[0m11:34:29.360733 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:34:29.363315 [debug] [MainThread]: Command end result
[0m11:34:29.404460 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:34:29.406495 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:34:29.414251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:34:29.414898 [info ] [MainThread]: 
[0m11:34:29.416397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:29.417302 [info ] [MainThread]: 
[0m11:34:29.418052 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:34:29.420055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6013366, "process_in_blocks": "0", "process_kernel_time": 0.574493, "process_mem_max_rss": "107880", "process_out_blocks": "3392", "process_user_time": 3.861875}
[0m11:34:29.421281 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:29.421028 after 1.60 seconds
[0m11:34:29.421855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64f167950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64d4987d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f64f4439e0>]}
[0m11:34:29.422438 [debug] [MainThread]: Flushing usage events
[0m11:34:29.527377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:25.375015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9ae5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9ae5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a969b8c0>]}


============================== 11:36:25.385259 | 1518eb5a-b352-4585-a614-0156b09cf154 ==============================
[0m11:36:25.385259 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:36:25.386241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:36:25.798737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9334f50>]}
[0m11:36:25.951654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a980cb60>]}
[0m11:36:25.953717 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:36:26.176812 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:36:26.421558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:36:26.422923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:36:26.565058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a7a77d40>]}
[0m11:36:26.785373 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:36:26.789118 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:36:26.825354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a77e9f10>]}
[0m11:36:26.826077 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:36:26.826723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9ea5190>]}
[0m11:36:26.829901 [info ] [MainThread]: 
[0m11:36:26.830590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:26.831404 [info ] [MainThread]: 
[0m11:36:26.832732 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:26.843027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:36:26.948252 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:36:26.949492 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:36:26.950257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:26.985324 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m11:36:26.989523 [debug] [ThreadPool]: On list_db: Close
[0m11:36:26.994321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:36:27.009844 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:36:27.010711 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:36:27.011578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:27.029890 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:36:27.030848 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:36:27.032185 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:36:27.049110 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m11:36:27.052534 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:36:27.054439 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:36:27.066055 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.066964 [debug] [MainThread]: On master: BEGIN
[0m11:36:27.068231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:27.089703 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:36:27.090814 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.092054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:27.107194 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m11:36:27.110057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a92a0f20>]}
[0m11:36:27.110831 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:27.111816 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.112375 [debug] [MainThread]: On master: BEGIN
[0m11:36:27.114118 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:36:27.115433 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.116331 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.117447 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.118912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:27.119966 [debug] [MainThread]: On master: Close
[0m11:36:27.126875 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:36:27.127995 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:36:27.129223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:36:27.130554 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:36:27.152407 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:36:27.154069 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:36:27.246903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:36:27.250417 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:36:27.251441 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:36:27.252308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:27.270305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:36:27.271872 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:36:27.273072 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:36:27.280515 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m11:36:27.295526 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:36:27.296173 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:36:27.298513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:36:27.338594 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:36:27.339215 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:36:27.339713 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:36:27.342569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:36:27.352125 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:36:27.360711 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:36:27.361449 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:36:27.363284 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:36:27.367299 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:36:27.369885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a69d0b90>]}
[0m11:36:27.371071 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 0[0m in 0.24s]
[0m11:36:27.372561 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:36:27.374613 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:36:27.375257 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:36:27.376225 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:36:27.377771 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:36:27.379562 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:36:27.381157 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:36:27.382348 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:36:27.383183 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:36:27.388030 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:36:27.401674 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:36:27.414627 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:36:27.415681 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:36:27.434502 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:36:27.453774 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:36:27.455541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:36:27.456674 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:36:27.457515 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:36:27.458382 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:36:27.459237 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:36:27.459960 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:36:27.474017 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m11:36:27.475336 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:36:27.479515 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:36:27.480941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m11:36:27.482400 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:36:27.483786 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:36:27.494995 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.013 seconds
[0m11:36:27.503070 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.013 seconds
[0m11:36:27.502552 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:36:27.508775 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:36:27.509869 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:36:27.510974 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:36:27.512644 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:36:27.513796 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:36:27.517334 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:36:27.521209 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:36:27.522116 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:36:27.522780 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:36:27.523403 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:36:27.524011 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:36:27.527118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:36:27.531083 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:36:27.532084 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m11:36:27.533820 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:36:27.537098 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:36:27.537808 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:36:27.538774 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:36:27.539681 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:36:27.540316 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:36:27.542507 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:36:27.543036 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:36:27.545301 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:36:27.546074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72248f717560>]}
[0m11:36:27.547341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1518eb5a-b352-4585-a614-0156b09cf154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72248f7415b0>]}
[0m11:36:27.548350 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 0[0m in 0.17s]
[0m11:36:27.550173 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 0[0m in 0.17s]
[0m11:36:27.552046 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:36:27.553315 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:36:27.557478 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.558138 [debug] [MainThread]: On master: BEGIN
[0m11:36:27.558910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:27.572687 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:36:27.573653 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.574402 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:27.574877 [debug] [MainThread]: On master: COMMIT
[0m11:36:27.575628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:27.576122 [debug] [MainThread]: On master: Close
[0m11:36:27.576836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:27.577408 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:36:27.577850 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:36:27.578243 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:36:27.578808 [info ] [MainThread]: 
[0m11:36:27.579673 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:36:27.583456 [debug] [MainThread]: Command end result
[0m11:36:27.628171 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:36:27.630833 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:36:27.645318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:36:27.646044 [info ] [MainThread]: 
[0m11:36:27.647132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:27.648103 [info ] [MainThread]: 
[0m11:36:27.649119 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:36:27.650980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3869538, "process_in_blocks": "0", "process_kernel_time": 0.722155, "process_mem_max_rss": "107800", "process_out_blocks": "3384", "process_user_time": 4.417658}
[0m11:36:27.651757 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:27.651593 after 2.39 seconds
[0m11:36:27.652283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9334380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9335160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224a9705ee0>]}
[0m11:36:27.652845 [debug] [MainThread]: Flushing usage events
[0m11:36:28.531387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:16.976859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9b41c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9a19f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9b8138c0>]}


============================== 11:43:16.985222 | 755726ac-287a-4f77-9e16-8f68cbb07bd9 ==============================
[0m11:43:16.985222 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:43:16.985984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:16.988591 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m11:43:16.989958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08092067, "process_in_blocks": "0", "process_kernel_time": 0.412788, "process_mem_max_rss": "86844", "process_out_blocks": "1480", "process_user_time": 1.839512}
[0m11:43:16.990576 [debug] [MainThread]: Command `dbt run` failed at 11:43:16.990445 after 0.08 seconds
[0m11:43:16.991002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9b41c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9a4a80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7a9ae926f0>]}
[0m11:43:16.991484 [debug] [MainThread]: Flushing usage events
[0m11:43:18.486069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:52.749467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858a853290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858c166180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858a851b80>]}


============================== 11:43:52.756182 | 1f18ddff-aaec-4102-8d90-85ae68f5c660 ==============================
[0m11:43:52.756182 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:43:52.756913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:52.759541 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m11:43:52.760815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06900096, "process_in_blocks": "0", "process_kernel_time": 0.362066, "process_mem_max_rss": "86372", "process_out_blocks": "1488", "process_user_time": 1.95918}
[0m11:43:52.761469 [debug] [MainThread]: Command `dbt run` failed at 11:43:52.761346 after 0.07 seconds
[0m11:43:52.761847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858a55ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858aa9ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77858a737980>]}
[0m11:43:52.762241 [debug] [MainThread]: Flushing usage events
[0m11:43:52.887331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:29.475099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901043067b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790103c8c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901037353a0>]}


============================== 11:44:29.482329 | 9ec26157-b2cf-4057-b394-6aef437b887b ==============================
[0m11:44:29.482329 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:44:29.483061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:29.752958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901039b5970>]}
[0m11:44:29.856477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79010365b650>]}
[0m11:44:29.859269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:44:30.179277 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:44:30.365996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:30.366426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:30.425489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790101ec50a0>]}
[0m11:44:30.522012 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:44:30.525151 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:44:30.552570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790101cf2cc0>]}
[0m11:44:30.553124 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:44:30.553608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790101c1c8c0>]}
[0m11:44:30.555790 [info ] [MainThread]: 
[0m11:44:30.556325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:44:30.557055 [info ] [MainThread]: 
[0m11:44:30.558227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:44:30.563261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:44:30.617928 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:44:30.618399 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:44:30.618935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:30.631566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:44:30.633183 [debug] [ThreadPool]: On list_db: Close
[0m11:44:30.635382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:44:30.643121 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:44:30.643618 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:44:30.643945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:30.654010 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:44:30.654762 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:44:30.655482 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:44:30.659953 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m11:44:30.661605 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:44:30.662357 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:44:30.671674 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.672141 [debug] [MainThread]: On master: BEGIN
[0m11:44:30.672502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:30.684472 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:44:30.684937 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.685598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:44:30.689887 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:44:30.691871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790101defbf0>]}
[0m11:44:30.692542 [debug] [MainThread]: On master: ROLLBACK
[0m11:44:30.693302 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.693752 [debug] [MainThread]: On master: BEGIN
[0m11:44:30.695032 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:44:30.695860 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.697063 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.697785 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.699195 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:44:30.699765 [debug] [MainThread]: On master: Close
[0m11:44:30.704201 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:44:30.704929 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:44:30.705653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:44:30.706196 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:44:30.715069 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:44:30.715797 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:44:30.760238 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:44:30.761028 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.761484 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:44:30.761890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:30.771279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:44:30.771841 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.772635 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:44:30.777239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:44:30.784979 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.785499 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m11:44:30.786622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:30.789624 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.790185 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:44:30.792034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:30.814229 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:44:30.814716 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.815118 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:44:30.818168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:44:30.825549 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:44:30.831724 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:44:30.832164 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:44:30.836772 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:44:30.839609 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:44:30.842338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79010561e150>]}
[0m11:44:30.843248 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 1[0m in 0.13s]
[0m11:44:30.844136 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:44:30.845366 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:44:30.846135 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:44:30.847617 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:44:30.848365 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:44:30.849050 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:44:30.849800 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:44:30.850714 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:44:30.855452 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:44:30.856051 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:44:30.859463 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:44:30.860240 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:44:30.863879 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:44:30.864690 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:44:30.865181 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.868461 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:44:30.869011 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:44:30.869663 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:44:30.870461 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.870995 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:44:30.871461 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:44:30.879249 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m11:44:30.879836 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.880526 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:44:30.881779 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m11:44:30.882374 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.883094 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:44:30.885233 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:44:30.888667 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.889229 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:44:30.889958 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:44:30.894254 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.895009 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:44:30.895512 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:30.895904 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:44:30.898973 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.901899 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.902430 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:44:30.903022 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:44:30.904000 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:44:30.906252 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:44:30.907066 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:44:30.908154 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.910901 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:44:30.911561 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:44:30.912082 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.912711 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:44:30.915545 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:44:30.918317 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:44:30.918889 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m11:44:30.919594 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:44:30.921940 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:44:30.922476 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:44:30.923412 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:44:30.924649 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:44:30.928433 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:44:30.930157 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:44:30.930645 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:44:30.931390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901037370b0>]}
[0m11:44:30.932944 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:44:30.933857 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.08s]
[0m11:44:30.934961 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:44:30.935589 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec26157-b2cf-4057-b394-6aef437b887b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790100dbd1f0>]}
[0m11:44:30.936799 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m11:44:30.937693 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:44:30.940850 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.941370 [debug] [MainThread]: On master: BEGIN
[0m11:44:30.941744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:30.950951 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:44:30.951475 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.951960 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:30.952308 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.952931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:44:30.953307 [debug] [MainThread]: On master: Close
[0m11:44:30.953855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:30.954192 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:44:30.954503 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:44:30.954873 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:44:30.955298 [info ] [MainThread]: 
[0m11:44:30.955812 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:44:30.957696 [debug] [MainThread]: Command end result
[0m11:44:30.983968 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:44:30.985806 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:44:30.994217 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:44:30.994703 [info ] [MainThread]: 
[0m11:44:30.995219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:30.995706 [info ] [MainThread]: 
[0m11:44:30.996307 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:44:30.997743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.583643, "process_in_blocks": "0", "process_kernel_time": 0.522056, "process_mem_max_rss": "108160", "process_out_blocks": "3392", "process_user_time": 2.991782}
[0m11:44:30.998368 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:30.998242 after 1.58 seconds
[0m11:44:30.998863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901039346e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901037353a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7901047167b0>]}
[0m11:44:30.999337 [debug] [MainThread]: Flushing usage events
[0m11:44:31.650469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:26.949562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b062ccaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b07c063f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b062cc350>]}


============================== 11:46:26.963041 | 2e1876f5-3dd8-4d1c-9e21-537a853c10bf ==============================
[0m11:46:26.963041 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:26.964775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:46:27.371817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b05ccff20>]}
[0m11:46:27.491996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b05c83b30>]}
[0m11:46:27.493261 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:27.664119 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:27.885332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:27.885955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:27.967011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b043e32c0>]}
[0m11:46:28.126802 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:28.130976 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:28.180652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b0421bdd0>]}
[0m11:46:28.181783 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:46:28.182787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b0449bb30>]}
[0m11:46:28.186329 [info ] [MainThread]: 
[0m11:46:28.187134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:28.188060 [info ] [MainThread]: 
[0m11:46:28.189563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:28.203913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:46:28.297104 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:46:28.297709 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:28.298203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:28.317213 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m11:46:28.320225 [debug] [ThreadPool]: On list_db: Close
[0m11:46:28.323327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:46:28.336606 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:28.337397 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:46:28.338147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:28.353176 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m11:46:28.354032 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:28.354987 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:46:28.361146 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m11:46:28.364541 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:46:28.365815 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:46:28.379201 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.380205 [debug] [MainThread]: On master: BEGIN
[0m11:46:28.381122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:28.393368 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:46:28.394301 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.395382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:28.403176 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m11:46:28.405848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b0428e9f0>]}
[0m11:46:28.406869 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:28.408238 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.409720 [debug] [MainThread]: On master: BEGIN
[0m11:46:28.411930 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:46:28.413141 [debug] [MainThread]: On master: COMMIT
[0m11:46:28.414264 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.414971 [debug] [MainThread]: On master: COMMIT
[0m11:46:28.415858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:28.416483 [debug] [MainThread]: On master: Close
[0m11:46:28.422536 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:46:28.423665 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:46:28.425075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:46:28.426303 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:46:28.444703 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:46:28.446546 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:46:28.531228 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:46:28.532839 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.533809 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:46:28.534786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:28.549248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:46:28.550332 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.551131 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:46:28.559216 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:46:28.572934 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.573701 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m11:46:28.575472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:28.584076 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.585272 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:46:28.586726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:28.638931 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:46:28.639886 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.640929 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:46:28.656387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m11:46:28.667034 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:46:28.680546 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:46:28.681513 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:46:28.685788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:46:28.691987 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:46:28.695397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b07c06930>]}
[0m11:46:28.696642 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 1[0m in 0.27s]
[0m11:46:28.698325 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:46:28.700844 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:46:28.702096 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:46:28.703058 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:46:28.706543 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:46:28.707665 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:46:28.704729 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:46:28.716490 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:46:28.723212 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:46:28.724930 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:46:28.731708 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:46:28.733208 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:46:28.741160 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:46:28.742842 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:46:28.748696 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:46:28.750061 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.751265 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.752108 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:46:28.753090 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:46:28.753899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:46:28.754760 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:46:28.772893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m11:46:28.776809 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.779223 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:46:28.781178 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m11:46:28.782730 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.784685 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:46:28.787273 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:46:28.794341 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.795455 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m11:46:28.796738 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:46:28.803523 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.805158 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:46:28.806130 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:46:28.813486 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:46:28.816368 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.822029 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.823269 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:46:28.824580 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:46:28.826593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:28.830511 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:28.831439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:46:28.832234 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.835819 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:46:28.836992 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:28.838028 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.839351 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:46:28.853968 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m11:46:28.859838 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:46:28.861099 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m11:46:28.863078 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:28.870246 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:46:28.871529 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:46:28.873784 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:28.875543 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:46:28.884082 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m11:46:28.888272 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:46:28.889628 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:46:28.891313 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b034154c0>]}
[0m11:46:28.895031 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:46:28.896877 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m11:46:28.899452 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e1876f5-3dd8-4d1c-9e21-537a853c10bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b0024bfe0>]}
[0m11:46:28.904024 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:46:28.906026 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.19s]
[0m11:46:28.909016 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:46:28.913871 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.915112 [debug] [MainThread]: On master: BEGIN
[0m11:46:28.916704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:28.943519 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m11:46:28.944842 [debug] [MainThread]: On master: COMMIT
[0m11:46:28.946154 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:28.947348 [debug] [MainThread]: On master: COMMIT
[0m11:46:28.949032 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:46:28.950302 [debug] [MainThread]: On master: Close
[0m11:46:28.953892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:28.955515 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:46:28.956955 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:46:28.961559 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:46:28.962827 [info ] [MainThread]: 
[0m11:46:28.964666 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m11:46:28.978346 [debug] [MainThread]: Command end result
[0m11:46:29.129574 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:29.135134 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:29.162650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:29.163758 [info ] [MainThread]: 
[0m11:46:29.165069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:29.166094 [info ] [MainThread]: 
[0m11:46:29.167086 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:46:29.169642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2977576, "process_in_blocks": "0", "process_kernel_time": 0.611896, "process_mem_max_rss": "107456", "process_out_blocks": "3392", "process_user_time": 4.271199}
[0m11:46:29.171189 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:29.170840 after 2.30 seconds
[0m11:46:29.176685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b062f7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b07c84860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b00263d40>]}
[0m11:46:29.178474 [debug] [MainThread]: Flushing usage events
[0m11:46:30.494235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:35.480898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c92fa9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c92bd8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c92f28bc0>]}


============================== 11:48:35.487178 | cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d ==============================
[0m11:48:35.487178 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:48:35.488521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:35.954785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c911dcd70>]}
[0m11:48:36.093544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c92e17440>]}
[0m11:48:36.094997 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:48:36.314088 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:48:36.588685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:36.589288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:36.700866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c91052bd0>]}
[0m11:48:36.942067 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:36.948817 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:36.992085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c9106d0d0>]}
[0m11:48:36.993350 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:48:36.994331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c91047ef0>]}
[0m11:48:36.998954 [info ] [MainThread]: 
[0m11:48:37.000031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:37.001000 [info ] [MainThread]: 
[0m11:48:37.002542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:37.016830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:48:37.138171 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:48:37.139410 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:48:37.140255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.166737 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m11:48:37.168808 [debug] [ThreadPool]: On list_db: Close
[0m11:48:37.171951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:48:37.181315 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:37.181933 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:48:37.182709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.200478 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:48:37.201454 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:37.202320 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:48:37.212434 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m11:48:37.216507 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:48:37.219780 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:48:37.245732 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.247177 [debug] [MainThread]: On master: BEGIN
[0m11:48:37.248485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:37.265303 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:48:37.266457 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.267897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:37.278315 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m11:48:37.281114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c911b69c0>]}
[0m11:48:37.282827 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:37.286097 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.287600 [debug] [MainThread]: On master: BEGIN
[0m11:48:37.288880 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:48:37.289941 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.291573 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.292672 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.294387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:48:37.295403 [debug] [MainThread]: On master: Close
[0m11:48:37.305068 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:48:37.306868 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:48:37.309158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:48:37.310475 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:48:37.331853 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:48:37.333303 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:48:37.425443 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:48:37.427136 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.428216 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:48:37.429123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:37.445512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:48:37.446522 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.447646 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:48:37.458934 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m11:48:37.479991 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.481169 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m11:48:37.482845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:37.487248 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.488015 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:48:37.489404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:37.532896 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:48:37.533850 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.534764 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:48:37.540222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:48:37.554727 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:48:37.563510 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:48:37.564297 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:48:37.569671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:48:37.573718 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:48:37.576665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c946324b0>]}
[0m11:48:37.578065 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 1[0m in 0.27s]
[0m11:48:37.579689 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:48:37.581829 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:48:37.582731 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:48:37.583747 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:48:37.586917 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:48:37.588016 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:48:37.585146 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:48:37.597566 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:48:37.599155 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:48:37.600874 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:48:37.609740 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:48:37.610719 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:48:37.621116 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:48:37.622393 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:48:37.629579 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.630806 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:48:37.631669 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:48:37.632787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:48:37.634235 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.635231 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:48:37.636245 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:48:37.651685 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m11:48:37.652870 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.653499 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:48:37.658870 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m11:48:37.660126 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:48:37.661498 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.667222 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.668217 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:48:37.669113 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:48:37.671236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:37.680425 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.681630 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m11:48:37.682708 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:48:37.690768 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.692600 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:48:37.693831 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:48:37.697078 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:48:37.697917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:48:37.698675 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.705206 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.706820 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:48:37.707755 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:48:37.709565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:37.714319 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:48:37.715788 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.716951 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:48:37.718614 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m11:48:37.728336 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m11:48:37.734673 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:48:37.736626 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:48:37.737644 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:48:37.727560 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:48:37.741063 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:48:37.742100 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:48:37.744281 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:48:37.748132 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:48:37.749217 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:48:37.750725 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c8bfe8e30>]}
[0m11:48:37.754144 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:48:37.755967 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m11:48:37.757898 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:48:37.759198 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc5a570b-a56b-40a7-8f33-e7a9ddc71c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c88e03560>]}
[0m11:48:37.763058 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m11:48:37.764964 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:48:37.771003 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.772454 [debug] [MainThread]: On master: BEGIN
[0m11:48:37.773594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:37.812336 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m11:48:37.813918 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.815154 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.816042 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.817558 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:37.818664 [debug] [MainThread]: On master: Close
[0m11:48:37.820141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:37.821162 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m11:48:37.822243 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:48:37.824208 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:48:37.825142 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:48:37.826258 [info ] [MainThread]: 
[0m11:48:37.827282 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m11:48:37.831494 [debug] [MainThread]: Command end result
[0m11:48:37.894690 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:37.898635 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:37.917329 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:48:37.918328 [info ] [MainThread]: 
[0m11:48:37.919471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:37.920543 [info ] [MainThread]: 
[0m11:48:37.921806 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:48:37.924360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6222436, "process_in_blocks": "0", "process_kernel_time": 0.73452, "process_mem_max_rss": "107588", "process_out_blocks": "1792", "process_user_time": 4.981963}
[0m11:48:37.925593 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:37.925363 after 2.62 seconds
[0m11:48:37.926447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c92db2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c948b46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792c91052f90>]}
[0m11:48:37.928251 [debug] [MainThread]: Flushing usage events
[0m11:48:38.033969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:57.234778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade98e6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade98e7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade8b208c0>]}


============================== 11:59:57.243001 | a59dbb2c-7331-450d-970f-53df9bf96bc8 ==============================
[0m11:59:57.243001 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:59:57.243671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:57.538880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade814ab70>]}
[0m11:59:57.626188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade7f675c0>]}
[0m11:59:57.627186 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:59:57.729741 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:59:57.867517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:57.868008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:57.913419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade6731700>]}
[0m11:59:58.008215 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:59:58.011300 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:59:58.042732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade6403e00>]}
[0m11:59:58.043615 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:59:58.044185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade6406900>]}
[0m11:59:58.046744 [info ] [MainThread]: 
[0m11:59:58.047295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:58.047868 [info ] [MainThread]: 
[0m11:59:58.048883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:58.054087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:59:58.109337 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:59:58.109830 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:59:58.110411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:58.123785 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:59:58.125589 [debug] [ThreadPool]: On list_db: Close
[0m11:59:58.128399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:59:58.138405 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:59:58.139304 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:59:58.140003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:58.152459 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:59:58.153142 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:59:58.153918 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:59:58.157620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m11:59:58.159464 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:59:58.160337 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:59:58.168894 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.169516 [debug] [MainThread]: On master: BEGIN
[0m11:59:58.170211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:58.183835 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:59:58.184797 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.185781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:58.191250 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:59:58.194068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade9d54620>]}
[0m11:59:58.194687 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:58.195432 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.195863 [debug] [MainThread]: On master: BEGIN
[0m11:59:58.196890 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:59:58.197569 [debug] [MainThread]: On master: COMMIT
[0m11:59:58.198468 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.199201 [debug] [MainThread]: On master: COMMIT
[0m11:59:58.200212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:59:58.200605 [debug] [MainThread]: On master: Close
[0m11:59:58.204783 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m11:59:58.206120 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m11:59:58.207477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m11:59:58.208415 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m11:59:58.218410 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m11:59:58.219646 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m11:59:58.272306 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m11:59:58.273443 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.274161 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m11:59:58.274692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:58.285629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:59:58.286233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.286842 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m11:59:58.292178 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m11:59:58.299748 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.300266 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m11:59:58.301234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:58.304403 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.304877 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:59:58.305729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:59:58.333375 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:59:58.333952 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.334379 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m11:59:58.337148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:59:58.345232 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m11:59:58.353753 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m11:59:58.354602 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m11:59:58.358671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:59:58.361359 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m11:59:58.364089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade9e9e720>]}
[0m11:59:58.364966 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 2[0m in 0.15s]
[0m11:59:58.365913 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m11:59:58.367770 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:59:58.368366 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:59:58.369037 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:59:58.370052 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:59:58.371048 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:59:58.371738 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:59:58.372335 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:59:58.373056 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:59:58.378325 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:59:58.381721 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:59:58.383070 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:59:58.383574 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:59:58.387375 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:59:58.393524 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:59:58.395302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.396171 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.396909 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:59:58.397552 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:59:58.398388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:59:58.399285 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:59:58.411101 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m11:59:58.412209 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.413008 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m11:59:58.413809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m11:59:58.415121 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.415746 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m11:59:58.419179 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:59:58.419934 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.003 seconds
[0m11:59:58.426619 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.430479 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.431240 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:59:58.431906 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:59:58.433220 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:58.433812 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:58.438569 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.442733 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.443406 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:59:58.443893 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:59:58.444923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:59:58.445363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:58.447262 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:59:58.449249 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:59:58.449908 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.450559 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.451325 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:59:58.452149 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:59:58.454933 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:59:58.458821 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:59:58.459381 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m11:59:58.460154 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:59:58.462810 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:59:58.463386 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:59:58.464219 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:59:58.464832 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:59:58.467534 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:59:58.469400 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:59:58.469993 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:59:58.470818 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade55c9d90>]}
[0m11:59:58.472537 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:59:58.473599 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 2[0m in 0.10s]
[0m11:59:58.474990 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:59:58.475678 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59dbb2c-7331-450d-970f-53df9bf96bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade44d7da0>]}
[0m11:59:58.477236 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.10s]
[0m11:59:58.478422 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:59:58.481244 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.482028 [debug] [MainThread]: On master: BEGIN
[0m11:59:58.482387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:58.493170 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:59:58.498279 [debug] [MainThread]: On master: COMMIT
[0m11:59:58.498746 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:58.499126 [debug] [MainThread]: On master: COMMIT
[0m11:59:58.500026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:59:58.500573 [debug] [MainThread]: On master: Close
[0m11:59:58.501718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:58.502542 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m11:59:58.503298 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:59:58.504151 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:59:58.505175 [info ] [MainThread]: 
[0m11:59:58.505974 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:59:58.507959 [debug] [MainThread]: Command end result
[0m11:59:58.535437 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:59:58.537470 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:59:58.545345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:59:58.545934 [info ] [MainThread]: 
[0m11:59:58.546603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:58.547398 [info ] [MainThread]: 
[0m11:59:58.548116 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:59:58.549693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3817654, "process_in_blocks": "0", "process_kernel_time": 0.456596, "process_mem_max_rss": "108000", "process_out_blocks": "3392", "process_user_time": 2.787638}
[0m11:59:58.550377 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:58.550247 after 1.38 seconds
[0m11:59:58.550789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade82fe300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade8531d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade62a7e90>]}
[0m11:59:58.551229 [debug] [MainThread]: Flushing usage events
[0m11:59:58.614552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:04:37.700529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724516bde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77245051bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77245051bb90>]}


============================== 12:04:37.708897 | debf08c7-d0df-4fa7-95cb-96517d7599b5 ==============================
[0m12:04:37.708897 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:04:37.709560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:04:37.984103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244f8daf30>]}
[0m12:04:38.073725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244fc7b320>]}
[0m12:04:38.074679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:04:38.195914 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:04:38.341187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:38.341630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:38.398384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244dff0dd0>]}
[0m12:04:38.494730 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:04:38.497513 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:04:38.528280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244df06660>]}
[0m12:04:38.528846 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:04:38.529304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244dcc07d0>]}
[0m12:04:38.531339 [info ] [MainThread]: 
[0m12:04:38.531824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:38.532298 [info ] [MainThread]: 
[0m12:04:38.533257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:04:38.538896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:04:38.592659 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:04:38.593119 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:04:38.593447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:38.605473 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m12:04:38.607008 [debug] [ThreadPool]: On list_db: Close
[0m12:04:38.608825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:04:38.614885 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:04:38.615311 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:04:38.615614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:38.625788 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:04:38.626222 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:04:38.626733 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:04:38.630679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:04:38.632222 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:04:38.632938 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:04:38.641074 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:38.641557 [debug] [MainThread]: On master: BEGIN
[0m12:04:38.641928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:38.651377 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:04:38.652129 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:38.652897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:04:38.657528 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:04:38.659210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772450bb0320>]}
[0m12:04:38.659778 [debug] [MainThread]: On master: ROLLBACK
[0m12:04:38.660554 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:38.661058 [debug] [MainThread]: On master: BEGIN
[0m12:04:38.662170 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:04:38.662827 [debug] [MainThread]: On master: COMMIT
[0m12:04:38.663487 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:38.664133 [debug] [MainThread]: On master: COMMIT
[0m12:04:38.665272 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:04:38.665997 [debug] [MainThread]: On master: Close
[0m12:04:38.670968 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:04:38.672205 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:04:38.673408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:04:38.674050 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:04:38.682686 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:04:38.683369 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:04:38.726989 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:04:38.727765 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:38.728159 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:04:38.728514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:38.738244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:04:38.739208 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:38.739874 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:04:38.743570 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:04:38.750661 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:38.751242 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:04:38.752484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:04:38.757016 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:38.757518 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:04:38.758614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:04:38.781081 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:04:38.781550 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:38.781913 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:04:40.662339 [debug] [Thread-1 (]: SQL status: COMMIT in 1.880 seconds
[0m12:04:40.689753 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:04:40.702603 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:04:40.704587 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:04:40.811943 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.106 seconds
[0m12:04:40.818938 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:04:40.825983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77245177a7b0>]}
[0m12:04:40.827676 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 2[0m in 2.15s]
[0m12:04:40.829394 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:04:40.831734 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:04:40.832715 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:04:40.834656 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:04:40.836474 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:04:40.839482 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:04:40.841849 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:04:40.842735 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:04:40.843685 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:04:40.862882 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:04:40.867530 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:04:40.869059 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:04:40.869540 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:04:40.874097 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:04:40.877771 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:04:40.878837 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:40.879286 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:40.879805 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:04:40.880365 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:04:40.880918 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:04:40.881376 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:04:40.893609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:04:40.894561 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:40.895234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:04:40.895874 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:04:40.896380 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:40.897111 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:04:40.899978 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:04:40.904599 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:40.905351 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:04:40.906233 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:04:40.910354 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:40.911078 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:04:40.911584 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:04:40.914806 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:40.915272 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:04:40.915741 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:04:40.918909 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:40.919567 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:04:40.920404 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:04:40.923237 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:04:40.923851 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:04:40.924461 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:40.926446 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:04:40.927010 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:04:40.927470 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:40.927992 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:04:40.965717 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m12:04:40.977732 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m12:04:40.994974 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:04:41.003301 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:04:41.001976 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:04:41.006160 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:04:41.008640 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:04:41.009998 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:04:41.015552 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:04:41.018056 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:04:41.019128 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244cf438f0>]}
[0m12:04:41.020231 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 2[0m in 0.18s]
[0m12:04:41.021913 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:04:41.151776 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.140 seconds
[0m12:04:41.168367 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:04:41.172475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'debf08c7-d0df-4fa7-95cb-96517d7599b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244dca2ae0>]}
[0m12:04:41.176458 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.33s]
[0m12:04:41.179810 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:04:41.185331 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:41.186339 [debug] [MainThread]: On master: BEGIN
[0m12:04:41.187822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:41.203265 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:04:41.204344 [debug] [MainThread]: On master: COMMIT
[0m12:04:41.205358 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:41.206087 [debug] [MainThread]: On master: COMMIT
[0m12:04:41.206968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:04:41.207452 [debug] [MainThread]: On master: Close
[0m12:04:41.208113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:41.208549 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:04:41.209062 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:04:41.209495 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:04:41.210331 [info ] [MainThread]: 
[0m12:04:41.211279 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m12:04:41.213533 [debug] [MainThread]: Command end result
[0m12:04:41.244785 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:04:41.246791 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:04:41.256296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:04:41.256931 [info ] [MainThread]: 
[0m12:04:41.257698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:41.258369 [info ] [MainThread]: 
[0m12:04:41.259105 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:04:41.260664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6213136, "process_in_blocks": "0", "process_kernel_time": 0.405703, "process_mem_max_rss": "107968", "process_out_blocks": "3392", "process_user_time": 2.860011}
[0m12:04:41.261450 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:41.261302 after 3.62 seconds
[0m12:04:41.261891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244fa68bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244dfcf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77244fa1fbf0>]}
[0m12:04:41.262325 [debug] [MainThread]: Flushing usage events
[0m12:04:41.319599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:05.233481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780601e8c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780602668da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780601e8cbc0>]}


============================== 12:09:05.242040 | 0aab43b5-4123-4915-b29f-a44c632ce3d7 ==============================
[0m12:09:05.242040 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:09:05.242844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:05.541250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7806012afce0>]}
[0m12:09:05.624736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780602537cb0>]}
[0m12:09:05.625739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:09:05.757986 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:09:05.928438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:05.928953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:05.981901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805ff94e390>]}
[0m12:09:06.080894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:09:06.084073 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:09:06.123689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805ff654770>]}
[0m12:09:06.124340 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:09:06.124859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805ff6e2660>]}
[0m12:09:06.127029 [info ] [MainThread]: 
[0m12:09:06.127623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:06.128270 [info ] [MainThread]: 
[0m12:09:06.129172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:06.134255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:09:06.192897 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:09:06.193469 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:09:06.193906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:06.206307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m12:09:06.207822 [debug] [ThreadPool]: On list_db: Close
[0m12:09:06.210023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:09:06.216846 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:09:06.217291 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:09:06.217691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:06.226965 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:09:06.227431 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:09:06.227935 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:09:06.231310 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:09:06.232856 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:09:06.233556 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:09:06.241230 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.242046 [debug] [MainThread]: On master: BEGIN
[0m12:09:06.242420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:06.252288 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:09:06.253817 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.254384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:06.259247 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:09:06.261964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805ff963680>]}
[0m12:09:06.263127 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:06.264115 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.264946 [debug] [MainThread]: On master: BEGIN
[0m12:09:06.266905 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:09:06.269281 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.270027 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.270641 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.271909 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:09:06.272790 [debug] [MainThread]: On master: Close
[0m12:09:06.278854 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:09:06.280139 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:09:06.281555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:09:06.282465 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:09:06.294545 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:09:06.295512 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:09:06.340357 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:09:06.341150 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.341688 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:09:06.342119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.351569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:09:06.352425 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.353486 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:09:06.357283 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:09:06.366750 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.367437 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:09:06.368717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.372664 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.373180 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:09:06.374236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.397109 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:09:06.397668 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.398083 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:09:06.400968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:09:06.408032 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:09:06.415039 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:09:06.415532 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:09:06.419287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:09:06.422702 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:09:06.424922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7806030e6360>]}
[0m12:09:06.425913 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.14s]
[0m12:09:06.427053 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:09:06.428892 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:09:06.429858 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:09:06.430604 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:09:06.431616 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:09:06.432762 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:09:06.433740 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:09:06.434400 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:09:06.435005 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:09:06.440918 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:09:06.444629 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:09:06.446036 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:09:06.446633 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:09:06.450712 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:09:06.455366 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:09:06.456725 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.457515 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.458171 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:09:06.458748 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:09:06.459290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:09:06.459929 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:09:06.471873 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m12:09:06.472724 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m12:09:06.473427 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.474230 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.475128 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:09:06.475701 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:09:06.479480 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:09:06.484155 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.484845 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:09:06.486188 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:09:06.490386 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.491310 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:09:06.492126 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.492747 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.496030 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.499340 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.500011 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:09:06.500528 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:09:06.501644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.502457 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:06.504577 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:09:06.506670 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:09:06.507241 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.507793 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.508406 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:09:06.509003 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:09:06.511738 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m12:09:06.514471 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:09:06.515010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:09:06.515810 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:09:06.518392 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:09:06.519226 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:09:06.520362 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:09:06.521109 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:09:06.524137 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:09:06.525958 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:09:06.526453 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:09:06.528309 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:09:06.529421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805fe89cad0>]}
[0m12:09:06.530247 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aab43b5-4123-4915-b29f-a44c632ce3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805fe89d1f0>]}
[0m12:09:06.531164 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.10s]
[0m12:09:06.532318 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.10s]
[0m12:09:06.533703 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:09:06.534475 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:09:06.537751 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.538283 [debug] [MainThread]: On master: BEGIN
[0m12:09:06.538680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:06.548298 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:09:06.548887 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.549445 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.549988 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.550628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:09:06.551083 [debug] [MainThread]: On master: Close
[0m12:09:06.551671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:06.552160 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:09:06.552638 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:09:06.553019 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:09:06.553576 [info ] [MainThread]: 
[0m12:09:06.554404 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:09:06.556917 [debug] [MainThread]: Command end result
[0m12:09:06.586093 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:09:06.588706 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:09:06.597039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:09:06.597773 [info ] [MainThread]: 
[0m12:09:06.598465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:06.599584 [info ] [MainThread]: 
[0m12:09:06.600332 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:09:06.602337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4392016, "process_in_blocks": "0", "process_kernel_time": 0.507624, "process_mem_max_rss": "107964", "process_out_blocks": "3384", "process_user_time": 3.025764}
[0m12:09:06.603482 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:06.603243 after 1.44 seconds
[0m12:09:06.604156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7806018b0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7806018b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7806012ac140>]}
[0m12:09:06.604801 [debug] [MainThread]: Flushing usage events
[0m12:09:08.341219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:05.061467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aac12e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aab9ace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aab8f75c0>]}


============================== 12:14:05.074022 | 51366ec4-a518-4717-843d-bf9c20ad308f ==============================
[0m12:14:05.074022 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:14:05.076583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:14:05.340989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aae9828d0>]}
[0m12:14:05.450413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aab0e8140>]}
[0m12:14:05.451332 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:14:05.561186 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:14:05.726866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:05.727439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:05.788047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa99a54f0>]}
[0m12:14:05.876261 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:14:05.879084 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:14:05.907790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa96a4c20>]}
[0m12:14:05.908363 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:14:05.908801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa97fe570>]}
[0m12:14:05.910921 [info ] [MainThread]: 
[0m12:14:05.911416 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:05.911924 [info ] [MainThread]: 
[0m12:14:05.912870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:05.917959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:14:05.974174 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:14:05.974656 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:14:05.974985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:05.987845 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:14:05.989515 [debug] [ThreadPool]: On list_db: Close
[0m12:14:05.991426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:14:05.997556 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:14:05.998022 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:14:05.998353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:06.007694 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:14:06.008321 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:14:06.009054 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:14:06.012500 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:14:06.014022 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:14:06.014820 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:14:06.034545 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.035715 [debug] [MainThread]: On master: BEGIN
[0m12:14:06.036221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:06.048527 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:14:06.050494 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.051114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:06.056422 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:14:06.058906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa9682990>]}
[0m12:14:06.059556 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:06.060409 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.060869 [debug] [MainThread]: On master: BEGIN
[0m12:14:06.061917 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:14:06.062626 [debug] [MainThread]: On master: COMMIT
[0m12:14:06.063282 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.063752 [debug] [MainThread]: On master: COMMIT
[0m12:14:06.064474 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:06.065060 [debug] [MainThread]: On master: Close
[0m12:14:06.071566 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:14:06.072522 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:14:06.073574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:14:06.074101 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:14:06.083978 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:14:06.085570 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:14:06.140111 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:14:06.141154 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.141914 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:14:06.142496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:06.152666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:14:06.153388 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.154023 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:14:06.161207 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:14:06.171280 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.171882 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:14:06.173738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:06.180190 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.180901 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:14:06.182271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:06.208859 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:14:06.209379 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.209940 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:14:06.213849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:14:06.221693 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:14:06.228067 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:14:06.228555 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:14:06.232316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:14:06.235052 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:14:06.236940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aad132960>]}
[0m12:14:06.237678 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 3[0m in 0.16s]
[0m12:14:06.238486 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:14:06.239925 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:14:06.240459 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:14:06.241150 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:14:06.241721 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:14:06.242875 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:14:06.243566 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:14:06.244084 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:14:06.244581 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:14:06.249240 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:14:06.252505 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:14:06.253521 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:14:06.253945 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:14:06.257418 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:14:06.260685 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:14:06.261744 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.262199 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.262745 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:14:06.263209 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:14:06.263728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:14:06.264165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:14:06.274490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:14:06.275348 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:14:06.276042 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.276609 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.277192 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:14:06.277769 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:14:06.281241 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:14:06.287391 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:14:06.288757 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.293522 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.294169 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:14:06.294829 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:14:06.296121 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:06.296770 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:06.302268 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.306254 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.307056 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:14:06.307691 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:14:06.308796 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:14:06.309377 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:14:06.311358 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:14:06.313658 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:14:06.314324 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.315098 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.316078 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:14:06.316930 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:14:06.324720 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m12:14:06.327820 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:14:06.328461 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m12:14:06.329334 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:14:06.332349 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:14:06.333216 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:14:06.334274 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:14:06.335362 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:14:06.338367 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:14:06.340515 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:14:06.340969 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:14:06.341763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa8841a00>]}
[0m12:14:06.343668 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:14:06.344811 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.10s]
[0m12:14:06.346246 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:14:06.347237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51366ec4-a518-4717-843d-bf9c20ad308f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa8841b50>]}
[0m12:14:06.348875 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 3[0m in 0.10s]
[0m12:14:06.350119 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:14:06.352857 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.353304 [debug] [MainThread]: On master: BEGIN
[0m12:14:06.353642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:06.362869 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:14:06.363486 [debug] [MainThread]: On master: COMMIT
[0m12:14:06.363940 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:06.364317 [debug] [MainThread]: On master: COMMIT
[0m12:14:06.365189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:06.365675 [debug] [MainThread]: On master: Close
[0m12:14:06.366301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:06.366656 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:14:06.367000 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:14:06.367341 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:14:06.367800 [info ] [MainThread]: 
[0m12:14:06.368386 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:14:06.370045 [debug] [MainThread]: Command end result
[0m12:14:06.397495 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:14:06.400258 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:14:06.407884 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:14:06.408360 [info ] [MainThread]: 
[0m12:14:06.408944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:06.409436 [info ] [MainThread]: 
[0m12:14:06.410170 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:14:06.411616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4477466, "process_in_blocks": "0", "process_kernel_time": 0.558523, "process_mem_max_rss": "107496", "process_out_blocks": "3392", "process_user_time": 3.059913}
[0m12:14:06.412442 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:06.412226 after 1.45 seconds
[0m12:14:06.412942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aad1b08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aab3de5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7aa997fce0>]}
[0m12:14:06.413371 [debug] [MainThread]: Flushing usage events
[0m12:14:06.468826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:08.323718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f10160680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f101903b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f10162330>]}


============================== 12:19:08.332115 | f61eb06e-5d1b-4128-8780-fdd690ea7b10 ==============================
[0m12:19:08.332115 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:19:08.333056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:19:08.590437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0dbc8dd0>]}
[0m12:19:08.667314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0f83dbe0>]}
[0m12:19:08.668210 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:19:08.779289 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:19:08.998473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:08.998945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:09.044561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0dc38c80>]}
[0m12:19:09.135365 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:19:09.138214 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:19:09.166759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0db92b70>]}
[0m12:19:09.167362 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:19:09.167843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0d920a70>]}
[0m12:19:09.170169 [info ] [MainThread]: 
[0m12:19:09.170791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:09.171365 [info ] [MainThread]: 
[0m12:19:09.172318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:09.178742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:19:09.250348 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:19:09.251090 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:09.251874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:09.266270 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:19:09.267973 [debug] [ThreadPool]: On list_db: Close
[0m12:19:09.269944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:19:09.276606 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:19:09.277101 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:19:09.277424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:09.286583 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:19:09.287179 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:19:09.287791 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:19:09.291796 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:19:09.293499 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:19:09.294366 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:19:09.301863 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.302487 [debug] [MainThread]: On master: BEGIN
[0m12:19:09.303248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:09.316214 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:19:09.317208 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.318350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:09.330957 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:19:09.334137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0f8a08c0>]}
[0m12:19:09.335240 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:09.336454 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.341721 [debug] [MainThread]: On master: BEGIN
[0m12:19:09.343169 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:19:09.343957 [debug] [MainThread]: On master: COMMIT
[0m12:19:09.344787 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.345670 [debug] [MainThread]: On master: COMMIT
[0m12:19:09.347148 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:19:09.357738 [debug] [MainThread]: On master: Close
[0m12:19:09.362721 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:19:09.364344 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:19:09.366034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:19:09.367146 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:19:09.380182 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:19:09.381535 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:19:09.428285 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:19:09.429102 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.429568 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:19:09.429969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:09.439675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:19:09.440495 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.441294 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:19:09.446757 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:19:09.454862 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.455356 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:19:09.456591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:09.466691 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.467917 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:19:09.468889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:19:09.489901 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:19:09.490410 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.490834 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:19:09.494340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:09.501685 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:19:09.509482 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:19:09.510167 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:19:09.514219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:19:09.517164 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:19:09.519118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0dc754f0>]}
[0m12:19:09.519871 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 4[0m in 0.15s]
[0m12:19:09.520842 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:19:09.521923 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:19:09.522626 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:19:09.523360 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:19:09.524443 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:19:09.525519 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:19:09.526205 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:19:09.526759 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:19:09.527218 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:19:09.531697 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:19:09.534684 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:19:09.535683 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:19:09.536174 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:19:09.539455 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:19:09.542839 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:19:09.544052 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.544569 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.545085 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:19:09.545607 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:19:09.546056 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:09.546549 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:19:09.555770 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m12:19:09.556472 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m12:19:09.556998 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.557635 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.558202 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:19:09.558764 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:19:09.561976 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m12:19:09.562568 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:19:09.566272 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.570002 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.570646 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:19:09.571181 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:19:09.572315 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:09.575367 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.575935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:19:09.576460 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:19:09.579846 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.580593 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:19:09.581148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:19:09.583016 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:19:09.583456 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:19:09.583935 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.585831 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:19:09.586436 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:19:09.586980 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.587823 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:19:09.590367 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:19:09.593198 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:19:09.593756 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:19:09.594504 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:19:09.597039 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:19:09.597611 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:19:09.598407 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:19:09.599128 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:19:09.602359 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:19:09.604054 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:19:09.604903 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0cae5ca0>]}
[0m12:19:09.605490 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:19:09.606395 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 4[0m in 0.08s]
[0m12:19:09.609683 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:19:09.610585 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:19:09.611756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61eb06e-5d1b-4128-8780-fdd690ea7b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0cae53d0>]}
[0m12:19:09.613121 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.09s]
[0m12:19:09.614361 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:19:09.616823 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.617259 [debug] [MainThread]: On master: BEGIN
[0m12:19:09.617617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:09.626734 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:19:09.627346 [debug] [MainThread]: On master: COMMIT
[0m12:19:09.627839 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:09.628188 [debug] [MainThread]: On master: COMMIT
[0m12:19:09.628858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:09.629252 [debug] [MainThread]: On master: Close
[0m12:19:09.629803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:09.630138 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:19:09.630896 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:19:09.631463 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:19:09.632108 [info ] [MainThread]: 
[0m12:19:09.632894 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:19:09.635737 [debug] [MainThread]: Command end result
[0m12:19:09.666639 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:19:09.668546 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:19:09.676127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:19:09.677027 [info ] [MainThread]: 
[0m12:19:09.678054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:09.679235 [info ] [MainThread]: 
[0m12:19:09.680479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:19:09.682835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4186085, "process_in_blocks": "0", "process_kernel_time": 0.536168, "process_mem_max_rss": "107680", "process_out_blocks": "3392", "process_user_time": 2.668657}
[0m12:19:09.683984 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:09.683681 after 1.42 seconds
[0m12:19:09.684694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f1013ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f101903b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2f0f7cd3d0>]}
[0m12:19:09.685328 [debug] [MainThread]: Flushing usage events
[0m12:19:10.979946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:06.867711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc34daf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc367fc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc34dad940>]}


============================== 12:24:06.875623 | 08f0a492-6a47-4bb0-b0f7-0a229ff503be ==============================
[0m12:24:06.875623 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:24:06.876488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:24:07.121389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc34b07440>]}
[0m12:24:07.197313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc35035280>]}
[0m12:24:07.198288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:24:07.300718 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:24:07.432372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:07.432822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:07.478550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc33018320>]}
[0m12:24:07.577651 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:24:07.580508 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:24:07.610296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc32cdcb90>]}
[0m12:24:07.610950 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:24:07.611506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc32cbaa20>]}
[0m12:24:07.613889 [info ] [MainThread]: 
[0m12:24:07.614450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:24:07.614922 [info ] [MainThread]: 
[0m12:24:07.615891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:07.620895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:24:07.675769 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:24:07.676275 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:24:07.676746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:07.691225 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:24:07.692871 [debug] [ThreadPool]: On list_db: Close
[0m12:24:07.695081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:24:07.701887 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:24:07.702382 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:24:07.702804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:07.713020 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:24:07.713600 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:24:07.714306 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:24:07.718020 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:24:07.719700 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:24:07.720403 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:24:07.727842 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:07.728385 [debug] [MainThread]: On master: BEGIN
[0m12:24:07.728909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:07.738502 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:24:07.739078 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:07.739837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:24:07.744857 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:24:07.748284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc33018bf0>]}
[0m12:24:07.750188 [debug] [MainThread]: On master: ROLLBACK
[0m12:24:07.752398 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:07.754077 [debug] [MainThread]: On master: BEGIN
[0m12:24:07.756919 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:24:07.758518 [debug] [MainThread]: On master: COMMIT
[0m12:24:07.759723 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:07.761138 [debug] [MainThread]: On master: COMMIT
[0m12:24:07.762932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:24:07.763708 [debug] [MainThread]: On master: Close
[0m12:24:07.767954 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:24:07.768616 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:24:07.769264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:24:07.769898 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:24:07.779710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:24:07.780503 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:24:07.838933 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:24:07.840372 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.841397 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:24:07.842352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:07.852335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:24:07.853334 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.853856 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:24:07.858830 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m12:24:07.866768 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.867307 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:24:07.868487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:07.872086 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.872610 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:24:07.873797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:07.896692 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:24:07.897207 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.897594 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:24:07.902408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:24:07.909262 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:24:07.916963 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:24:07.917649 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:24:07.921607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:24:07.924418 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:24:07.926432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc36782870>]}
[0m12:24:07.927273 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 5[0m in 0.16s]
[0m12:24:07.928401 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:24:07.930014 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:24:07.930689 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:24:07.931406 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:24:07.932502 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:24:07.933578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:24:07.934475 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:24:07.934986 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:24:07.935455 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:24:07.940157 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:24:07.943549 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:24:07.944571 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:24:07.945144 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:24:07.948772 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:24:07.952342 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:24:07.953346 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:07.953917 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:24:07.954474 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:07.954997 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:24:07.955562 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:24:07.956360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:24:07.965632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:24:07.966497 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:07.967466 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:24:07.968185 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:24:07.969172 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:07.969772 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:24:07.972287 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:24:07.976237 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:07.976952 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.007 seconds
[0m12:24:07.977978 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:24:07.983203 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:07.984031 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:24:07.984565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:07.988287 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:07.988762 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:24:07.989260 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:24:07.992795 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:07.993529 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:24:07.994081 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:24:07.996144 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:24:07.996740 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:24:08.000650 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:08.004212 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:24:08.005114 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:24:08.005866 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:08.007016 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:24:08.009069 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m12:24:08.012964 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:24:08.013561 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:24:08.014403 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:24:08.017264 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:24:08.017894 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:24:08.018828 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:24:08.019550 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:24:08.022909 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:24:08.024663 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:24:08.025258 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:24:08.027088 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:24:08.027708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc31f0d4c0>]}
[0m12:24:08.029702 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f0a492-6a47-4bb0-b0f7-0a229ff503be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc31f27a10>]}
[0m12:24:08.028763 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.09s]
[0m12:24:08.030890 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.10s]
[0m12:24:08.032103 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:24:08.032901 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:24:08.035876 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:08.036340 [debug] [MainThread]: On master: BEGIN
[0m12:24:08.036697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:08.047214 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:24:08.048117 [debug] [MainThread]: On master: COMMIT
[0m12:24:08.048759 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:08.049127 [debug] [MainThread]: On master: COMMIT
[0m12:24:08.049802 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:24:08.050327 [debug] [MainThread]: On master: Close
[0m12:24:08.050962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:08.051333 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:24:08.051709 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:24:08.052134 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:24:08.052653 [info ] [MainThread]: 
[0m12:24:08.053280 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:24:08.056030 [debug] [MainThread]: Command end result
[0m12:24:08.086743 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:24:08.089278 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:24:08.100239 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:24:08.100860 [info ] [MainThread]: 
[0m12:24:08.102075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:08.103268 [info ] [MainThread]: 
[0m12:24:08.104179 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:24:08.106485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.298541, "process_in_blocks": "0", "process_kernel_time": 0.477074, "process_mem_max_rss": "107980", "process_out_blocks": "3392", "process_user_time": 2.52168}
[0m12:24:08.107543 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:08.107267 after 1.30 seconds
[0m12:24:08.108380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc3548b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc361c75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc37fce8a0>]}
[0m12:24:08.109297 [debug] [MainThread]: Flushing usage events
[0m12:24:08.196419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:07.058890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e29fa270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e11c17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e0e47410>]}


============================== 12:29:07.066718 | b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9 ==============================
[0m12:29:07.066718 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:29:07.067442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:29:07.322309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e0e47140>]}
[0m12:29:07.401795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e0c6ba70>]}
[0m12:29:07.402818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:29:07.516466 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:29:07.661412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:07.661877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:07.737614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505df325d30>]}
[0m12:29:07.853848 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:29:07.856804 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:29:07.889226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505df02c7d0>]}
[0m12:29:07.890050 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:29:07.890864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505df325490>]}
[0m12:29:07.893364 [info ] [MainThread]: 
[0m12:29:07.893926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:07.894469 [info ] [MainThread]: 
[0m12:29:07.895484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:07.900857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:29:07.962129 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:29:07.962615 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:07.962988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:07.976253 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:29:07.977933 [debug] [ThreadPool]: On list_db: Close
[0m12:29:07.980547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:29:07.987418 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:29:07.987954 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:29:07.988333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:07.998544 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:29:07.999197 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:29:07.999922 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:29:08.004314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:29:08.005964 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:29:08.006778 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:29:08.014156 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.014692 [debug] [MainThread]: On master: BEGIN
[0m12:29:08.015251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:08.024896 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:29:08.025457 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.026170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:08.030506 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:29:08.032861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505df02a540>]}
[0m12:29:08.033704 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:08.034982 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.036385 [debug] [MainThread]: On master: BEGIN
[0m12:29:08.037985 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:29:08.038901 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.039908 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.040870 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.042146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:08.043036 [debug] [MainThread]: On master: Close
[0m12:29:08.049082 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather
[0m12:29:08.049970 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather ................................... [RUN]
[0m12:29:08.050782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather)
[0m12:29:08.051502 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather
[0m12:29:08.062340 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather"
[0m12:29:08.063105 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather
[0m12:29:08.106338 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather"
[0m12:29:08.107121 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.107595 [debug] [Thread-1 (]: On model.my_project.stg_weather: BEGIN
[0m12:29:08.108200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:08.119038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:29:08.119845 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.120480 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */

  
    

  create  table "db"."dev"."stg_weather__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    SELECT * 
    FROM "db"."dev"."weather"
),

-- REMOVE ANY DUPLICATES IN THE DATABASE
de_dup as (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY time ORDER BY inserted_at) as rn
    FROM source 
)

SELECT 
    id, 
    city, 
    temperature, 
    weather_descriptions, 
    wind_speed, 
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
FROM de_dup
WHERE rn = 1
  );
  
[0m12:29:08.125666 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:29:08.135071 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.136035 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather" rename to "stg_weather__dbt_backup"
[0m12:29:08.137207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:29:08.141981 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.142923 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
alter table "db"."dev"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m12:29:08.144431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:29:08.170690 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:29:08.171341 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.171816 [debug] [Thread-1 (]: On model.my_project.stg_weather: COMMIT
[0m12:29:08.174468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:29:08.181624 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather__dbt_backup"
[0m12:29:08.188581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather"
[0m12:29:08.189083 [debug] [Thread-1 (]: On model.my_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather"} */
drop table if exists "db"."dev"."stg_weather__dbt_backup" cascade
[0m12:29:08.193422 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:29:08.196342 [debug] [Thread-1 (]: On model.my_project.stg_weather: Close
[0m12:29:08.198284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505de261340>]}
[0m12:29:08.199101 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather .............................. [[32mSELECT 5[0m in 0.15s]
[0m12:29:08.200113 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather
[0m12:29:08.201646 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:29:08.202201 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:29:08.202942 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:29:08.203984 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:29:08.205022 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:29:08.206005 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:29:08.206600 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:29:08.207142 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:29:08.211967 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:29:08.215458 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:29:08.216592 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:29:08.217302 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:29:08.220828 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:29:08.224709 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:29:08.225915 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.226447 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.226921 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:29:08.227442 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:29:08.227979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:29:08.228514 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:29:08.238719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:29:08.239628 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.240386 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:29:08.241327 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    date(weather_time_local) as date,
    ROUND(AVG(temperature)::NUMERIC, 2) as avg_temperature,
    ROUND(AVG(wind_speed)::NUMERIC, 2) as avg_wind_speed
FROM "db"."dev"."stg_weather"
GROUP BY city, date(weather_time_local)
ORDER BY city, date(weather_time_local)
  );
  
[0m12:29:08.241944 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.242771 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    -- THIS SCRIPT IS RESPONSIBLE FOR CREATING TABLES THAT WILL BE USED FOR REPORTING


SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local
FROM "db"."dev"."stg_weather"
  );
  
[0m12:29:08.246219 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:29:08.250171 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.250980 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.007 seconds
[0m12:29:08.251975 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:29:08.257118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.258126 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:29:08.258732 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:29:08.262172 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.262772 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:29:08.263263 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:29:08.266556 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.267417 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:29:08.267997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:29:08.270407 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:29:08.271057 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:29:08.271558 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.273489 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:29:08.274133 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:29:08.274711 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.275442 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:29:08.278130 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:29:08.281241 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:29:08.281885 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:29:08.282690 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:29:08.285709 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:29:08.286371 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:29:08.287243 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:29:08.288045 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:29:08.291409 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:29:08.293287 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:29:08.293865 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:29:08.294703 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505de1d18b0>]}
[0m12:29:08.296463 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:29:08.297378 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.09s]
[0m12:29:08.298807 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:29:08.300004 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2cd5dc9-dd86-4843-83f6-2ce1f868b7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505de27f080>]}
[0m12:29:08.301522 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.09s]
[0m12:29:08.302932 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:29:08.305760 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.306272 [debug] [MainThread]: On master: BEGIN
[0m12:29:08.306690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:08.317409 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:29:08.318193 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.318924 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:08.319319 [debug] [MainThread]: On master: COMMIT
[0m12:29:08.320088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:08.320546 [debug] [MainThread]: On master: Close
[0m12:29:08.321170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:08.321556 [debug] [MainThread]: Connection 'model.my_project.stg_weather' was properly closed.
[0m12:29:08.321927 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:29:08.322247 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:29:08.322715 [info ] [MainThread]: 
[0m12:29:08.323310 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:29:08.325237 [debug] [MainThread]: Command end result
[0m12:29:08.358765 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:29:08.360958 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:29:08.368264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:29:08.368851 [info ] [MainThread]: 
[0m12:29:08.369508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:08.370182 [info ] [MainThread]: 
[0m12:29:08.371074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:29:08.372527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3836161, "process_in_blocks": "0", "process_kernel_time": 0.518886, "process_mem_max_rss": "107988", "process_out_blocks": "3392", "process_user_time": 2.86186}
[0m12:29:08.373166 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:08.373033 after 1.38 seconds
[0m12:29:08.373588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e29fa270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505df007470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505e1481940>]}
[0m12:29:08.374040 [debug] [MainThread]: Flushing usage events
[0m12:29:08.451665 [debug] [MainThread]: An error was encountered while trying to flush usage events
